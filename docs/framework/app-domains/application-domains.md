---
title: Dominios de aplicación
ms.date: 03/30/2017
helpviewer_keywords:
- process boundaries for isolation
- application isolation
- application domains, about
- common language runtime, application domains
- application domains
- runtime, application domains
- isolation between applications
- code, verification process
- verification testing code
ms.assetid: 113a8bbf-6875-4a72-a49d-ca2d92e19cc8
ms.openlocfilehash: a5c9f4248e060d231941269f39cadbc7147ce27f
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/14/2020
ms.locfileid: "79400912"
---
# <a name="application-domains"></a><span data-ttu-id="5c9c6-102">Dominios de aplicación</span><span class="sxs-lookup"><span data-stu-id="5c9c6-102">Application domains</span></span>

<span data-ttu-id="5c9c6-103">Normalmente, los sistemas operativos y los entornos de Common Language Runtime proporcionan algún tipo de aislamiento entre las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-103">Operating systems and runtime environments typically provide some form of isolation between applications.</span></span> <span data-ttu-id="5c9c6-104">Por ejemplo, Windows utiliza procesos para aislar las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-104">For example, Windows uses processes to isolate applications.</span></span> <span data-ttu-id="5c9c6-105">Este aislamiento es necesario para garantizar que el código que se ejecuta en una aplicación no afecta negativamente a otras aplicaciones no relacionadas.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-105">This isolation is necessary to ensure that code running in one application cannot adversely affect other, unrelated applications.</span></span>  
  
 <span data-ttu-id="5c9c6-106">Los dominios de aplicación proporcionan un límite de aislamiento para la seguridad, confiabilidad y control de versiones, así como para descargar los ensamblados.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-106">Application domains provide an isolation boundary for security, reliability, and versioning, and for unloading assemblies.</span></span> <span data-ttu-id="5c9c6-107">Los dominios de aplicación suelen ser creados por hosts de motor en tiempo de ejecución, que son los responsables de arrancar automáticamente Common Language Runtime antes de que se ejecute una aplicación.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-107">Application domains are typically created by runtime hosts, which are responsible for bootstrapping the common language runtime before an application is run.</span></span>  
  
## <a name="the-benefits-of-isolating-applications"></a><span data-ttu-id="5c9c6-108">Ventajas de aislar aplicaciones</span><span class="sxs-lookup"><span data-stu-id="5c9c6-108">The benefits of isolating applications</span></span>

 <span data-ttu-id="5c9c6-109">Tradicionalmente se han utilizado límites de proceso para aislar las aplicaciones que se ejecutan en un mismo equipo.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-109">Historically, process boundaries have been used to isolate applications running on the same computer.</span></span> <span data-ttu-id="5c9c6-110">Cada aplicación se carga en un proceso independiente que aísla la aplicación de las demás que se estén ejecutando en el mismo equipo.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-110">Each application is loaded into a separate process, which isolates the application from other applications running on the same computer.</span></span>  
  
 <span data-ttu-id="5c9c6-111">Las aplicaciones se aíslan porque las direcciones de memoria son específicas de cada proceso; un puntero de memoria pasado de un proceso a otro no se puede utilizar de ninguna manera coherente en el proceso de destino.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-111">The applications are isolated because memory addresses are process-relative; a memory pointer passed from one process to another cannot be used in any meaningful way in the target process.</span></span> <span data-ttu-id="5c9c6-112">Tampoco se pueden realizar llamadas directas entre dos procesos.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-112">In addition, you cannot make direct calls between two processes.</span></span> <span data-ttu-id="5c9c6-113">En su lugar, se deben utilizar servidores proxy, que proporcionan un nivel de direccionamiento indirecto.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-113">Instead, you must use proxies, which provide a level of indirection.</span></span>  
  
 <span data-ttu-id="5c9c6-114">El código administrado debe pasar por un proceso de verificación para poder ejecutarse (a menos que el administrador haya concedido permiso para omitir la comprobación).</span><span class="sxs-lookup"><span data-stu-id="5c9c6-114">Managed code must be passed through a verification process before it can be run (unless the administrator has granted permission to skip the verification).</span></span> <span data-ttu-id="5c9c6-115">El proceso de comprobación determina si el código puede intentar el acceso a direcciones de memoria no válidas o realizar alguna otra acción que pudiera hacer que el proceso en el que se ejecuta deje de funcionar correctamente.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-115">The verification process determines whether the code can attempt to access invalid memory addresses or perform some other action that could cause the process in which it is running to fail to operate properly.</span></span> <span data-ttu-id="5c9c6-116">Cuando el código pasa la prueba de comprobación, se dice que tiene seguridad de tipos.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-116">Code that passes the verification test is said to be type-safe.</span></span> <span data-ttu-id="5c9c6-117">La posibilidad de comprobar la seguridad de tipos del código permite que Common Language Runtime proporcione un gran nivel de seguridad respecto a los límites del proceso, con un costo de rendimiento mucho menor.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-117">The ability to verify code as type-safe enables the common language runtime to provide as great a level of isolation as the process boundary, at a much lower performance cost.</span></span>  
  
 <span data-ttu-id="5c9c6-118">Los dominios de aplicación constituyen una unidad de procesamiento más segura y versátil que puede utilizar Common Language Runtime para proporcionar el aislamiento entre las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-118">Application domains provide a more secure and versatile unit of processing that the common language runtime can use to provide isolation between applications.</span></span> <span data-ttu-id="5c9c6-119">En un solo proceso se pueden ejecutar varios dominios de aplicación con el mismo nivel de aislamiento que existiría en procesos independientes, sin incurrir en la sobrecarga adicional que supone realizar llamadas entre procesos o cambiar de un proceso a otro.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-119">You can run several application domains in a single process with the same level of isolation that would exist in separate processes, but without incurring the additional overhead of making cross-process calls or switching between processes.</span></span> <span data-ttu-id="5c9c6-120">La posibilidad de ejecutar múltiples aplicaciones en un solo proceso aumenta la escalabilidad del servidor de manera importante.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-120">The ability to run multiple applications within a single process dramatically increases server scalability.</span></span>  
  
 <span data-ttu-id="5c9c6-121">Aislar las aplicaciones es también importante para la seguridad de las mismas.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-121">Isolating applications is also important for application security.</span></span> <span data-ttu-id="5c9c6-122">Por ejemplo, en un solo proceso de explorador se pueden ejecutar controles de varias aplicaciones Web de tal forma que no puedan tener acceso a los datos y recursos de los demás controles.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-122">For example, you can run controls from several Web applications in a single browser process in such a way that the controls cannot access each other's data and resources.</span></span>  
  
 <span data-ttu-id="5c9c6-123">Éstas son las ventajas del aislamiento que ofrecen los dominios de aplicación:</span><span class="sxs-lookup"><span data-stu-id="5c9c6-123">The isolation provided by application domains has the following benefits:</span></span>  
  
- <span data-ttu-id="5c9c6-124">Los errores de una aplicación no pueden afectar a otras aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-124">Faults in one application cannot affect other applications.</span></span> <span data-ttu-id="5c9c6-125">Debido a que el código seguro no puede generar problemas de memoria, el uso de dominios de aplicación garantiza que el código que se ejecute en un dominio no afectará a las demás aplicaciones del proceso.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-125">Because type-safe code cannot cause memory faults, using application domains ensures that code running in one domain cannot affect other applications in the process.</span></span>  
  
- <span data-ttu-id="5c9c6-126">Es posible detener aplicaciones concretas sin detener todo el proceso.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-126">Individual applications can be stopped without stopping the entire process.</span></span> <span data-ttu-id="5c9c6-127">El uso de dominios de aplicación permite descargar el código que se ejecuta en una sola aplicación.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-127">Using application domains enables you to unload the code running in a single application.</span></span>  
  
    > [!NOTE]
    > <span data-ttu-id="5c9c6-128">No se puede descargar ensamblados o tipos por separado.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-128">You cannot unload individual assemblies or types.</span></span> <span data-ttu-id="5c9c6-129">Sólo se puede descargar un dominio completo.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-129">Only a complete domain can be unloaded.</span></span>  
  
- <span data-ttu-id="5c9c6-130">El código que se ejecuta en una aplicación no puede tener acceso directo al código o a los recursos de otra aplicación.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-130">Code running in one application cannot directly access code or resources from another application.</span></span> <span data-ttu-id="5c9c6-131">Common Language Runtime impone este aislamiento al impedir que se realicen llamadas directas entre objetos de dominios de aplicación diferentes.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-131">The common language runtime enforces this isolation by preventing direct calls between objects in different application domains.</span></span> <span data-ttu-id="5c9c6-132">Los objetos que se pasan entre dominios se copian o se obtiene acceso a ellos mediante proxy.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-132">Objects that pass between domains are either copied or accessed by proxy.</span></span> <span data-ttu-id="5c9c6-133">Si el objeto se copia, la llamada al objeto es local.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-133">If the object is copied, the call to the object is local.</span></span> <span data-ttu-id="5c9c6-134">En otras palabras, el llamador y el objeto al que se hace referencia se encuentran en el mismo dominio de aplicación.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-134">That is, both the caller and the object being referenced are in the same application domain.</span></span> <span data-ttu-id="5c9c6-135">Si se tiene acceso al objeto a través de un proxy, la llamada al objeto es remota.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-135">If the object is accessed through a proxy, the call to the object is remote.</span></span> <span data-ttu-id="5c9c6-136">En este caso, el llamador y el objeto al que se hace referencia se encuentran en dominios de aplicación diferentes.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-136">In this case, the caller and the object being referenced are in different application domains.</span></span> <span data-ttu-id="5c9c6-137">En las llamadas entre dominios se utiliza la misma infraestructura de llamada remota que en las llamadas entre dos procesos o entre dos equipos.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-137">Cross-domain calls use the same remote call infrastructure as calls between two processes or between two machines.</span></span> <span data-ttu-id="5c9c6-138">En consecuencia, los metadatos del objeto al que se hace referencia deben estar disponibles para ambos dominios de aplicación a fin de que la llamada al método no provoque un error en la compilación JIT.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-138">As such, the metadata for the object being referenced must be available to both application domains to allow the method call to be JIT-compiled properly.</span></span> <span data-ttu-id="5c9c6-139">Si el dominio que llama no tiene acceso a los metadatos del objeto al que se está llamando, se podría producir un error de compilación con una excepción del tipo <xref:System.IO.FileNotFoundException>.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-139">If the calling domain does not have access to the metadata for the object being called, the compilation might fail with an exception of type <xref:System.IO.FileNotFoundException>.</span></span> <span data-ttu-id="5c9c6-140">Para obtener más información, consulta [Remote Objects](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/72x4h507(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="5c9c6-140">For more information, see [Remote Objects](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/72x4h507(v=vs.100)).</span></span> <span data-ttu-id="5c9c6-141">El objeto es quien decide el mecanismo para determinar cómo se puede obtener acceso a los objetos entre dominios.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-141">The mechanism for determining how objects can be accessed across domains is determined by the object.</span></span> <span data-ttu-id="5c9c6-142">Para más información, consulte <xref:System.MarshalByRefObject?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-142">For more information, see <xref:System.MarshalByRefObject?displayProperty=nameWithType>.</span></span>  
  
- <span data-ttu-id="5c9c6-143">La aplicación en la que se ejecuta el código establece el comportamiento del mismo.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-143">The behavior of code is scoped by the application in which it runs.</span></span> <span data-ttu-id="5c9c6-144">En otras palabras, el dominio de aplicación proporciona valores de configuración tales como las directivas de versión de la aplicación, la ubicación de los ensamblados remotos a los que tiene acceso e información sobre dónde encontrar los ensamblados que se cargan en el dominio.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-144">In other words, the application domain provides configuration settings such as application version policies, the location of any remote assemblies it accesses, and information about where to locate assemblies that are loaded into the domain.</span></span>  
  
- <span data-ttu-id="5c9c6-145">El dominio de aplicación en el que se ejecuta el código puede controlar los permisos que se conceden al código.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-145">Permissions granted to code can be controlled by the application domain in which the code is running.</span></span>  
  
## <a name="application-domains-and-assemblies"></a><span data-ttu-id="5c9c6-146">Dominios de aplicación y ensamblados</span><span class="sxs-lookup"><span data-stu-id="5c9c6-146">Application domains and assemblies</span></span>

 <span data-ttu-id="5c9c6-147">En esta sección se describe la relación entre los dominios de aplicación y los ensamblados.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-147">This section describes the relationship between application domains and assemblies.</span></span> <span data-ttu-id="5c9c6-148">Debe cargar un ensamblado en un dominio de aplicación para poder ejecutar el código que contiene.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-148">You must load an assembly into an application domain before you can execute the code it contains.</span></span> <span data-ttu-id="5c9c6-149">Al ejecutar una aplicación típica, se cargan varios ensamblados en un dominio de aplicación.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-149">Running a typical application causes several assemblies to be loaded into an application domain.</span></span>  
  
 <span data-ttu-id="5c9c6-150">El modo en que se carga un ensamblado determina si varios dominios de aplicación pueden compartir el código compilado Just-in-time (JIT) del ensamblado en el proceso y si el ensamblado se puede descargar del proceso.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-150">The way an assembly is loaded determines whether its just-in-time (JIT) compiled code can be shared by multiple application domains in the process, and whether the assembly can be unloaded from the process.</span></span>  
  
- <span data-ttu-id="5c9c6-151">Si un ensamblado se carga con dominio neutro, todos los dominios de aplicación que comparten el mismo conjunto de permisos de seguridad pueden compartir el mismo código compilado JIT, lo que reduce la cantidad de memoria que necesita la aplicación.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-151">If an assembly is loaded domain-neutral, all application domains that share the same security grant set can share the same JIT-compiled code, which reduces the memory required by the application.</span></span> <span data-ttu-id="5c9c6-152">Sin embargo, el ensamblado nunca se puede descargar del proceso.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-152">However, the assembly can never be unloaded from the process.</span></span>  
  
- <span data-ttu-id="5c9c6-153">Si un ensamblado no se carga con dominio neutro, debe utilizarse la compilación JIT de ese ensamblado en los dominios de aplicación en que se carga.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-153">If an assembly is not loaded domain-neutral, it must be JIT-compiled in every application domain in which it is loaded.</span></span> <span data-ttu-id="5c9c6-154">Sin embargo, el ensamblado se puede descargar del proceso; para ello, tendrán que descargarse todos los dominios de aplicación en que está cargado el ensamblado.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-154">However, the assembly can be unloaded from the process by unloading all the application domains in which it is loaded.</span></span>  
  
 <span data-ttu-id="5c9c6-155">El host en tiempo de ejecución determina si los ensamblados se cargan con dominio neutro cuando se carga el motor en tiempo de ejecución en un proceso.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-155">The runtime host determines whether to load assemblies as domain-neutral when it loads the runtime into a process.</span></span> <span data-ttu-id="5c9c6-156">En las aplicaciones administradas, aplique el atributo <xref:System.LoaderOptimizationAttribute> al método de punto de entrada del proceso y especifique un valor de la enumeración <xref:System.LoaderOptimization> asociada.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-156">For managed applications, apply the <xref:System.LoaderOptimizationAttribute> attribute to the entry-point method for the process, and specify a value from the associated <xref:System.LoaderOptimization> enumeration.</span></span> <span data-ttu-id="5c9c6-157">En las aplicaciones no administradas que hospedan Common Language Runtime, especifique el marcador adecuado cuando llame al método [CorBindToRuntimeEx Function](../unmanaged-api/hosting/corbindtoruntimeex-function.md).</span><span class="sxs-lookup"><span data-stu-id="5c9c6-157">For unmanaged applications that host the common language runtime, specify the appropriate flag when you call the [CorBindToRuntimeEx Function](../unmanaged-api/hosting/corbindtoruntimeex-function.md) method.</span></span>  
  
 <span data-ttu-id="5c9c6-158">Existen tres opciones para cargar ensamblados neutrales respecto al dominio:</span><span class="sxs-lookup"><span data-stu-id="5c9c6-158">There are three options for loading domain-neutral assemblies:</span></span>  
  
- <span data-ttu-id="5c9c6-159"><xref:System.LoaderOptimization.SingleDomain?displayProperty=nameWithType> no carga ensamblados con dominio neutro, a excepción de Mscorlib que siempre se carga con dominio neutro.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-159"><xref:System.LoaderOptimization.SingleDomain?displayProperty=nameWithType> loads no assemblies as domain-neutral, except Mscorlib, which is always loaded domain-neutral.</span></span> <span data-ttu-id="5c9c6-160">Esta configuración se denomina dominio simple porque suele utilizarse cuando el host ejecuta una sola aplicación en el proceso.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-160">This setting is called single domain because it is commonly used when the host is running only a single application in the process.</span></span>

- <span data-ttu-id="5c9c6-161"><xref:System.LoaderOptimization.MultiDomain?displayProperty=nameWithType> carga todos los ensamblados con dominio neutro.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-161"><xref:System.LoaderOptimization.MultiDomain?displayProperty=nameWithType> loads all assemblies as domain-neutral.</span></span> <span data-ttu-id="5c9c6-162">Use esta configuración cuando en el proceso haya varios dominios de aplicación que ejecutan el mismo código.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-162">Use this setting when there are multiple application domains in the process, all of which run the same code.</span></span>

- <span data-ttu-id="5c9c6-163"><xref:System.LoaderOptimization.MultiDomainHost?displayProperty=nameWithType> carga con dominio neutro los ensamblados que tienen un nombre seguro si se han instalado junto con todas sus dependencias en la caché global de ensamblados.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-163"><xref:System.LoaderOptimization.MultiDomainHost?displayProperty=nameWithType> loads strong-named assemblies as domain-neutral, if they and all their dependencies have been installed in the global assembly cache.</span></span> <span data-ttu-id="5c9c6-164">La carga y la compilación JIT de los demás ensamblados se realiza de forma independiente en cada dominio de aplicación y, por tanto, estos ensamblados pueden descargarse del proceso.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-164">Other assemblies are loaded and JIT-compiled separately for each application domain in which they are loaded, and thus can be unloaded from the process.</span></span> <span data-ttu-id="5c9c6-165">Utilice esta configuración cuando ejecute más de una aplicación en el mismo proceso, o si tiene un grupo heterogéneo de ensamblados compartidos por varios dominios de aplicación y ensamblados que es necesario descargar del proceso.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-165">Use this setting when running more than one application in the same process, or if you have a mixture of assemblies that are shared by many application domains and assemblies that need to be unloaded from the process.</span></span>
  
 <span data-ttu-id="5c9c6-166">El código compilado JIT no se puede compartir en los ensamblados que se cargan en la carga de ensamblado por contexto especificado por el usuario utilizando el método <xref:System.Reflection.Assembly.LoadFrom%2A> de la clase <xref:System.Reflection.Assembly>, o que se cargan a partir de imágenes que utilizan las sobrecargas del método <xref:System.Reflection.Assembly.Load%2A> que especifican matrices de bytes.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-166">JIT-compiled code cannot be shared for assemblies loaded into the load-from context, using the <xref:System.Reflection.Assembly.LoadFrom%2A> method of the <xref:System.Reflection.Assembly> class, or loaded from images using overloads of the <xref:System.Reflection.Assembly.Load%2A> method that specify byte arrays.</span></span>  
  
 <span data-ttu-id="5c9c6-167">Los ensamblados que se han compilado en código nativo utilizando [Ngen.exe (Native Image Generator )](../tools/ngen-exe-native-image-generator.md) se pueden compartir entre dominios de aplicación si la primera vez que se cargaron en un proceso lo hicieron con dominio neutro.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-167">Assemblies that have been compiled to native code by using the [Ngen.exe (Native Image Generator)](../tools/ngen-exe-native-image-generator.md) can be shared between application domains, if they are loaded domain-neutral the first time they are loaded into a process.</span></span>  
  
 <span data-ttu-id="5c9c6-168">El código compilado JIT del ensamblado que contiene el punto de entrada de la aplicación sólo se puede compartir si pueden hacerlo todas sus dependencias.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-168">JIT-compiled code for the assembly that contains the application entry point is shared only if all its dependencies can be shared.</span></span>  
  
 <span data-ttu-id="5c9c6-169">Un ensamblado con dominio neutro puede someterse a la compilación JIT varias veces.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-169">A domain-neutral assembly can be JIT-compiled more than once.</span></span> <span data-ttu-id="5c9c6-170">Por ejemplo, cuando los conjuntos de permisos de seguridad de dos dominios de aplicación son diferentes, no pueden compartir el mismo código compilado JIT.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-170">For example, when the security grant sets of two application domains are different, they cannot share the same JIT-compiled code.</span></span> <span data-ttu-id="5c9c6-171">Sin embargo, cada copia del ensamblado objeto de compilación JIT se puede compartir con otros dominios de aplicación que tengan el mismo conjunto de permisos de seguridad.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-171">However, each copy of the JIT-compiled assembly can be shared with other application domains that have the same grant set.</span></span>  
  
 <span data-ttu-id="5c9c6-172">A la hora de determinar si va a cargar los ensamblados con dominio neutro, deberá decidir si prefiere reducir el consumo de memoria u otros factores relativos al rendimiento.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-172">When you decide whether to load assemblies as domain-neutral, you must make a tradeoff between reducing memory use and other performance factors.</span></span>  
  
- <span data-ttu-id="5c9c6-173">El acceso a los métodos y datos estáticos es más lento en los ensamblados de dominio neutro porque es necesario aislar los ensamblados.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-173">Access to static data and methods is slower for domain-neutral assemblies because of the need to isolate assemblies.</span></span> <span data-ttu-id="5c9c6-174">Cada dominio de aplicación que tiene acceso al ensamblado debe disponer de una copia independiente de los datos estáticos para impedir que las referencias a objetos en los campos estáticos atraviesen los límites del dominio.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-174">Each application domain that accesses the assembly must have a separate copy of the static data, to prevent references to objects in static fields from crossing domain boundaries.</span></span> <span data-ttu-id="5c9c6-175">Como resultado, el motor en tiempo de ejecución contiene lógica adicional para dirigir un llamador a la copia correspondiente del método o los datos estáticos.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-175">As a result, the runtime contains additional logic to direct a caller to the appropriate copy of the static data or method.</span></span> <span data-ttu-id="5c9c6-176">Esta lógica adicional retarda la llamada.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-176">This extra logic slows down the call.</span></span>  
  
- <span data-ttu-id="5c9c6-177">Todas las dependencias de un ensamblado deben estar presentes y cargarse cuando el ensamblado se carga con dominio neutro, ya que si una dependencia no se puede cargar con dominio neutro, impedirá también que el ensamblado se cargue con dominio neutro.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-177">All the dependencies of an assembly must be located and loaded when the assembly is loaded domain-neutral, because a dependency that cannot be loaded domain-neutral prevents the assembly from being loaded domain-neutral.</span></span>  
  
## <a name="application-domains-and-threads"></a><span data-ttu-id="5c9c6-178">Dominios de aplicación y subprocesos</span><span class="sxs-lookup"><span data-stu-id="5c9c6-178">Application domains and threads</span></span>

 <span data-ttu-id="5c9c6-179">Un dominio de aplicación constituye un límite de aislamiento para la seguridad, el control de versiones, la confiabilidad y la descarga de código administrado.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-179">An application domain forms an isolation boundary for security, versioning, reliability, and unloading of managed code.</span></span> <span data-ttu-id="5c9c6-180">Los subprocesos son la construcción del sistema operativo que Common Language Runtime utiliza para ejecutar código.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-180">A thread is the operating system construct used by the common language runtime to execute code.</span></span> <span data-ttu-id="5c9c6-181">En tiempo de ejecución, todo el código administrado se carga en un dominio de aplicación y se ejecuta mediante uno o varios subprocesos administrados.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-181">At run time, all managed code is loaded into an application domain and is run by one or more managed threads.</span></span>  
  
 <span data-ttu-id="5c9c6-182">No existe una correlación uno a uno entre los dominios de aplicación y los subprocesos.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-182">There is not a one-to-one correlation between application domains and threads.</span></span> <span data-ttu-id="5c9c6-183">En un momento dado haber varios subprocesos ejecutándose en un único dominio de aplicación. Además, cada subproceso concreto no está confinado a un solo dominio de aplicación.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-183">Several threads can execute in a single application domain at any given time, and a particular thread is not confined to a single application domain.</span></span> <span data-ttu-id="5c9c6-184">En otras palabras, los subprocesos pueden cruzar los límites del dominio de aplicación; no se crea un nuevo subproceso para cada dominio de aplicación.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-184">That is, threads are free to cross application domain boundaries; a new thread is not created for each application domain.</span></span>  
  
 <span data-ttu-id="5c9c6-185">En un momento dado, todos los subprocesos se ejecutan en un dominio de aplicación.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-185">At any given time, every thread executes in an application domain.</span></span> <span data-ttu-id="5c9c6-186">Por tanto, podría haber cero, uno o varios subprocesos ejecutándose en un dominio de aplicación determinado.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-186">Zero, one, or multiple threads might be executing in any given application domain.</span></span> <span data-ttu-id="5c9c6-187">El entorno de ejecución realiza un seguimiento de qué subprocesos se están ejecutando en qué dominios de aplicación.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-187">The runtime keeps track of which threads are running in which application domains.</span></span> <span data-ttu-id="5c9c6-188">Se puede localizar en cualquier momento el dominio donde se está ejecutando un subproceso llamando al método <xref:System.Threading.Thread.GetDomain%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-188">You can locate the domain in which a thread is executing at any time by calling the <xref:System.Threading.Thread.GetDomain%2A?displayProperty=nameWithType> method.</span></span>

### <a name="application-domains-and-cultures"></a><span data-ttu-id="5c9c6-189">Dominios de aplicación y referencias culturales</span><span class="sxs-lookup"><span data-stu-id="5c9c6-189">Application domains and cultures</span></span>

 <span data-ttu-id="5c9c6-190">La referencia cultural, representada por un objeto <xref:System.Globalization.CultureInfo>, se asocia con subprocesos.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-190">Culture, which is represented by a <xref:System.Globalization.CultureInfo> object, is associated with threads.</span></span> <span data-ttu-id="5c9c6-191">Puede obtener la referencia cultural asociada al subproceso que está actualmente en ejecución utilizando la propiedad <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType>, y puede utilizar la propiedad <xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=nameWithType> para obtener o establecer la referencia cultural asociada al subproceso que está actualmente en ejecución.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-191">You can get the culture that is associated with the currently executing thread by using the <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType> property, and you can get or set the culture that is associated with the currently executing thread by using the <xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="5c9c6-192">Si la referencia cultural asociada a un subproceso se ha establecido explícitamente mediante la propiedad <xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=nameWithType>, seguirá asociada a ese subproceso cuando el subproceso cruce los límites del dominio de aplicación.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-192">If the culture that is associated with a thread has been explicitly set by using the <xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=nameWithType> property, it continues to be associated with that thread when the thread crosses application domain boundaries.</span></span> <span data-ttu-id="5c9c6-193">De lo contrario, la referencia cultural que estaba asociada al subproceso en un momento concreto vendrá determinada por el valor de la propiedad <xref:System.Globalization.CultureInfo.DefaultThreadCurrentCulture%2A?displayProperty=nameWithType> en el dominio de aplicación en el que se está ejecutando el subproceso:</span><span class="sxs-lookup"><span data-stu-id="5c9c6-193">Otherwise, the culture that is associated with the thread at any given time is determined by the value of the <xref:System.Globalization.CultureInfo.DefaultThreadCurrentCulture%2A?displayProperty=nameWithType> property in the application domain in which the thread is executing:</span></span>  
  
- <span data-ttu-id="5c9c6-194">Si el valor de la propiedad no es `null`, se asociará al subproceso la referencia cultural devuelta por la propiedad (y por consiguiente devuelta por las propiedades <xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=nameWithType> y <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType>).</span><span class="sxs-lookup"><span data-stu-id="5c9c6-194">If the value of the property is not `null`, the culture that is returned by the property is associated with the thread (and therefore returned by the <xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=nameWithType> and <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType> properties).</span></span>  
  
- <span data-ttu-id="5c9c6-195">Si el valor de la propiedad es `null`, se asociará al subproceso la referencia cultural actual del sistema.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-195">If the value of the property is `null`, the current system culture is associated with the thread.</span></span>  
  
## <a name="programming-with-application-domains"></a><span data-ttu-id="5c9c6-196">Programación con dominios de aplicación</span><span class="sxs-lookup"><span data-stu-id="5c9c6-196">Programming with application domains</span></span>

 <span data-ttu-id="5c9c6-197">Normalmente, los dominios de aplicación son creados y manipulados mediante programación por los hosts de motor en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-197">Application domains are usually created and manipulated programmatically by runtime hosts.</span></span> <span data-ttu-id="5c9c6-198">Sin embargo, a veces, puede darse la circunstancia de que un programa de aplicación deba trabajar con dominios de aplicación.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-198">However, sometimes an application program might also want to work with application domains.</span></span> <span data-ttu-id="5c9c6-199">Por ejemplo, un programa de aplicación podría cargar un componente de aplicación en un dominio para poder descargar el dominio (y el componente) sin necesidad de detener toda la aplicación.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-199">For example, an application program could load an application component into a domain to be able to unload the domain (and the component) without having to stop the entire application.</span></span>  
  
 <span data-ttu-id="5c9c6-200">La <xref:System.AppDomain> es la interfaz de programación para los dominios de aplicación.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-200">The <xref:System.AppDomain> is the programmatic interface to application domains.</span></span> <span data-ttu-id="5c9c6-201">Esta clase incluye métodos para crear y descargar dominios, crear instancias de tipos en dominios y registrar diversas notificaciones, como por ejemplo cuando una aplicación descarga un dominio.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-201">This class includes methods to create and unload domains, to create instances of types in domains, and to register for various notifications such as application domain unloading.</span></span> <span data-ttu-id="5c9c6-202">En la tabla siguiente, se presentan los métodos <xref:System.AppDomain> más usados.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-202">The following table lists commonly used <xref:System.AppDomain> methods.</span></span>  
  
|<span data-ttu-id="5c9c6-203">Método de AppDomain</span><span class="sxs-lookup"><span data-stu-id="5c9c6-203">AppDomain Method</span></span>|<span data-ttu-id="5c9c6-204">Descripción</span><span class="sxs-lookup"><span data-stu-id="5c9c6-204">Description</span></span>|  
|----------------------|-----------------|  
|<xref:System.AppDomain.CreateDomain%2A>|<span data-ttu-id="5c9c6-205">Crea un nuevo dominio de aplicación.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-205">Creates a new application domain.</span></span> <span data-ttu-id="5c9c6-206">Se recomienda utilizar una sobrecarga de este método que especifique un objeto <xref:System.AppDomainSetup>.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-206">It is recommended that you use an overload of this method that specifies an <xref:System.AppDomainSetup> object.</span></span> <span data-ttu-id="5c9c6-207">Ésta es la forma recomendada para establecer las propiedades de un nuevo dominio, como la base de la aplicación o el directorio raíz para la aplicación; la ubicación del archivo de configuración para el dominio; y la ruta de búsqueda que va a utilizar Common Language Runtime para cargar ensamblados en el dominio.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-207">This is the preferred way to set the properties of a new domain, such as the application base, or root directory for the application; the location of the configuration file for the domain; and the search path that the common language runtime is to use to load assemblies into the domain.</span></span>|  
|<span data-ttu-id="5c9c6-208"><xref:System.AppDomain.ExecuteAssembly%2A> y <xref:System.AppDomain.ExecuteAssemblyByName%2A></span><span class="sxs-lookup"><span data-stu-id="5c9c6-208"><xref:System.AppDomain.ExecuteAssembly%2A> and <xref:System.AppDomain.ExecuteAssemblyByName%2A></span></span>|<span data-ttu-id="5c9c6-209">Ejecuta un ensamblado en el dominio de aplicación.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-209">Executes an assembly in the application domain.</span></span> <span data-ttu-id="5c9c6-210">Éste es un método de instancia, por lo que se puede utilizar para ejecutar el código en otro dominio de aplicación al que se haga referencia.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-210">This is an instance method, so it can be used to execute code in another application domain to which you have a reference.</span></span>|  
|<xref:System.AppDomain.CreateInstanceAndUnwrap%2A>|<span data-ttu-id="5c9c6-211">Crea una instancia de un tipo especificado en el dominio de aplicación y devuelve un proxy.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-211">Creates an instance of a specified type in the application domain, and returns a proxy.</span></span> <span data-ttu-id="5c9c6-212">Utilice este método para evitar que se cargue el ensamblado que contiene el tipo creado en el ensamblado de llamada.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-212">Use this method to avoid loading the assembly containing the created type into the calling assembly.</span></span>|  
|<xref:System.AppDomain.Unload%2A>|<span data-ttu-id="5c9c6-213">Cierra el dominio correctamente.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-213">Performs a graceful shutdown of the domain.</span></span> <span data-ttu-id="5c9c6-214">El dominio de aplicación no se descarga hasta que todos los subprocesos que se están ejecutando en el dominio se hayan detenido o ya no se encuentren en el dominio.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-214">The application domain is not unloaded until all threads running in the domain have either stopped or are no longer in the domain.</span></span>|  
  
> [!NOTE]
> <span data-ttu-id="5c9c6-215">Common Language Runtime no admite la serialización de métodos globales, por lo que no se pueden utilizar los delegados para ejecutar métodos globales en otros dominios de aplicación.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-215">The common language runtime does not support serialization of global methods, so delegates cannot be used to execute global methods in other application domains.</span></span>  
  
 <span data-ttu-id="5c9c6-216">Las interfaces no administradas que se describen en la especificación de las interfaces de hospedaje de Common Language Runtime también proporcionan acceso a los dominios de aplicación.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-216">The unmanaged interfaces described in the common language runtime Hosting Interfaces Specification also provide access to application domains.</span></span> <span data-ttu-id="5c9c6-217">Los hosts de motor en tiempo de ejecución pueden usar interfaces de código no administrado para crear y obtener acceso a los dominios de aplicación en un proceso.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-217">Runtime hosts can use interfaces from unmanaged code to create and gain access to the application domains within a process.</span></span>  
  
## <a name="the-complus_loaderoptimization-environment-variable"></a><span data-ttu-id="5c9c6-218">COMPLUS_LoaderOptimization (Variable de entorno)</span><span class="sxs-lookup"><span data-stu-id="5c9c6-218">The COMPLUS_LoaderOptimization environment variable</span></span>

 <span data-ttu-id="5c9c6-219">Variable de entorno que establece la directiva predeterminada de optimización de cargador de una aplicación ejecutable.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-219">An environment variable that sets the default loader optimization policy of an executable application.</span></span>  
  
### <a name="syntax"></a><span data-ttu-id="5c9c6-220">Sintaxis</span><span class="sxs-lookup"><span data-stu-id="5c9c6-220">Syntax</span></span>  
  
```env  
COMPLUS_LoaderOptimization = 1  
```  
  
### <a name="remarks"></a><span data-ttu-id="5c9c6-221">Observaciones</span><span class="sxs-lookup"><span data-stu-id="5c9c6-221">Remarks</span></span>

 <span data-ttu-id="5c9c6-222">Una aplicación típica carga varios ensamblados en un dominio de aplicación antes de poder ejecutar el código que contienen.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-222">A typical application loads several assemblies into an application domain before the code they contain can be executed.</span></span>  
  
 <span data-ttu-id="5c9c6-223">La manera en que se carga el ensamblado determina si su código compilado Just-In-Time (JIT) se puede compartir entre varios dominios de aplicación del proceso.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-223">The way the assembly is loaded determines whether its just-in-time (JIT) compiled code can be shared by multiple application domains in the process.</span></span>  
  
- <span data-ttu-id="5c9c6-224">Si un ensamblado se carga con dominio neutro, todos los dominios de aplicación que comparten el mismo conjunto de permisos de seguridad pueden compartir el mismo código compilado JIT.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-224">If an assembly is loaded domain-neutral, all application domains that share the same security grant set can share the same JIT-compiled code.</span></span> <span data-ttu-id="5c9c6-225">Esto reduce la cantidad de memoria que necesita la aplicación.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-225">This reduces the memory required by the application.</span></span>  
  
- <span data-ttu-id="5c9c6-226">Si un ensamblado no se carga con dominio neutro, debe someterse a la compilación JIT en cada dominio de aplicación en el que se carga y el cargador no debe compartir recursos internos entre dominios de aplicación.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-226">If an assembly is not loaded domain-neutral, it must be JIT-compiled in every application domain in which it is loaded and the loader must not share internal resources across application domains.</span></span>  
  
 <span data-ttu-id="5c9c6-227">Cuando se establece en 1, la marca de entorno COMPLUS_LoaderOptimization obliga al host del runtime a cargar todos los ensamblados de una manera no neutra para el dominio que se conoce como SingleDomain.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-227">When set to 1, the COMPLUS_LoaderOptimization environment flag forces the runtime host to load all assemblies in non-domain-neutral way known as SingleDomain.</span></span> <span data-ttu-id="5c9c6-228">SingleDomain no carga ensamblados con dominio neutro, a excepción de Mscorlib, que siempre se carga con dominio neutro.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-228">SingleDomain loads no assemblies as domain-neutral, except Mscorlib, which is always loaded domain-neutral.</span></span> <span data-ttu-id="5c9c6-229">Esta configuración se denomina dominio simple porque suele utilizarse cuando el host ejecuta una sola aplicación en el proceso.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-229">This setting is called single domain because it is commonly used when the host is running only a single application in the process.</span></span>  
  
> [!CAUTION]
> <span data-ttu-id="5c9c6-230">La marca de entorno COMPLUS_LoaderOptimization se diseñó para utilizarse en escenarios de diagnóstico y prueba.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-230">The COMPLUS_LoaderOptimization environment flag was designed to be used in diagnostic and test scenarios.</span></span> <span data-ttu-id="5c9c6-231">Tener la marca activada puede producir una considerable ralentización y un aumento del uso de memoria.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-231">Having the flag turned on can cause severe slow-down and increase in memory usage.</span></span>  
  
### <a name="code-example"></a><span data-ttu-id="5c9c6-232">Ejemplo de código</span><span class="sxs-lookup"><span data-stu-id="5c9c6-232">Code example</span></span>

 <span data-ttu-id="5c9c6-233">Si anexa `COMPLUS_LoaderOptimization=1` en el valor de cadena múltiple del entorno de la clave HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\IISADMIN, podrá conseguir que no todos los ensamblados se carguen como dominio neutro para el servicio IISADMIN.</span><span class="sxs-lookup"><span data-stu-id="5c9c6-233">To force all assemblies not to be loaded as domain-neutral for the IISADMIN service can be achieved by appending `COMPLUS_LoaderOptimization=1` to the Environment’s Multi-String Value in the HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\IISADMIN key.</span></span>  
  
```env  
Key = HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\IISADMIN  
Name = Environment  
Type = REG_MULTI_SZ  
Value (to append) = COMPLUS_LoaderOptimization=1  
```  
  
## <a name="see-also"></a><span data-ttu-id="5c9c6-234">Consulte también</span><span class="sxs-lookup"><span data-stu-id="5c9c6-234">See also</span></span>

- <xref:System.AppDomain?displayProperty=nameWithType>
- <xref:System.MarshalByRefObject?displayProperty=nameWithType>
- [<span data-ttu-id="5c9c6-235">Programar con dominios de aplicación y ensamblados</span><span class="sxs-lookup"><span data-stu-id="5c9c6-235">Programming with Application Domains and Assemblies</span></span>](index.md)
- [<span data-ttu-id="5c9c6-236">Utilizar dominios de aplicación</span><span class="sxs-lookup"><span data-stu-id="5c9c6-236">Using Application Domains</span></span>](use.md)
