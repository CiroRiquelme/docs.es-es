---
title: Control de eventos en Visual Basic y WPF
ms.date: 03/30/2017
helpviewer_keywords:
- Visual Basic [WPF], event handlers
- event handlers [WPF], Visual Basic
ms.assetid: ad4eb9aa-3afc-4a71-8cf6-add3fbea54a1
ms.openlocfilehash: 5625b63f2a2162f8f188476bfd61bde4c717f1dd
ms.sourcegitcommit: f8c36054eab877de4d40a705aacafa2552ce70e9
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 12/31/2019
ms.locfileid: "75559864"
---
# <a name="visual-basic-and-wpf-event-handling"></a><span data-ttu-id="b80e8-102">Control de eventos en Visual Basic y WPF</span><span class="sxs-lookup"><span data-stu-id="b80e8-102">Visual Basic and WPF Event Handling</span></span>
<span data-ttu-id="b80e8-103">En el lenguaje Microsoft Visual Basic .NET específicamente, puede usar la palabra clave `Handles` específica del lenguaje para asociar controladores de eventos con instancias, en lugar de adjuntar controladores de eventos con atributos o usar el método <xref:System.Windows.UIElement.AddHandler%2A>.</span><span class="sxs-lookup"><span data-stu-id="b80e8-103">For the Microsoft Visual Basic .NET language specifically, you can use the language-specific `Handles` keyword to associate event handlers with instances, instead of attaching event handlers with attributes or using the <xref:System.Windows.UIElement.AddHandler%2A> method.</span></span> <span data-ttu-id="b80e8-104">Pero la técnica de `Handles` para adjuntar controladores a instancias tiene algunas limitaciones, ya que la sintaxis de `Handles` no es compatible con algunas de las características específicas de eventos enrutados del sistema de eventos de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b80e8-104">However, the `Handles` technique for attaching handlers to instances does have some limitations, because the `Handles` syntax cannot support some of the specific routed event features of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] event system.</span></span>  
  
## <a name="using-handles-in-a-wpf-application"></a><span data-ttu-id="b80e8-105">Usar "Handles" en una aplicación WPF</span><span class="sxs-lookup"><span data-stu-id="b80e8-105">Using "Handles" in a WPF Application</span></span>  
 <span data-ttu-id="b80e8-106">Los controladores de eventos que se conectan a instancias y eventos con `Handles` deben definirse dentro de la declaración de clase parcial de la instancia, algo que también es un requisito para los controladores de eventos que se asignan a través de valores de atributo en los elementos.</span><span class="sxs-lookup"><span data-stu-id="b80e8-106">The event handlers that are connected to instances and events with `Handles` must all be defined within the partial class declaration of the instance, which is also a requirement for event handlers that are assigned through attribute values on elements.</span></span> <span data-ttu-id="b80e8-107">Solo se puede especificar `Handles` para un elemento de la página que tenga un valor de propiedad <xref:System.Windows.FrameworkContentElement.Name%2A> (o una [Directiva x:Name](../../../desktop-wpf/xaml-services/xname-directive.md) declarada).</span><span class="sxs-lookup"><span data-stu-id="b80e8-107">You can only specify `Handles` for an element on the page that has a <xref:System.Windows.FrameworkContentElement.Name%2A> property value (or [x:Name Directive](../../../desktop-wpf/xaml-services/xname-directive.md) declared).</span></span> <span data-ttu-id="b80e8-108">Esto se debe a que el <xref:System.Windows.FrameworkContentElement.Name%2A> en [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] crea la referencia de instancia necesaria para admitir el formato de referencia de la *instancia. event* requerido por la sintaxis de `Handles`.</span><span class="sxs-lookup"><span data-stu-id="b80e8-108">This is because the <xref:System.Windows.FrameworkContentElement.Name%2A> in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] creates the instance reference that is necessary to support the *Instance.Event* reference format required by the `Handles` syntax.</span></span> <span data-ttu-id="b80e8-109">El único elemento que se puede usar para `Handles` sin una referencia <xref:System.Windows.FrameworkContentElement.Name%2A> es la instancia del elemento raíz que define la clase parcial.</span><span class="sxs-lookup"><span data-stu-id="b80e8-109">The only element that can be used for `Handles` without a <xref:System.Windows.FrameworkContentElement.Name%2A> reference is the root-element instance that defines the partial class.</span></span>  
  
 <span data-ttu-id="b80e8-110">Puede asignar el mismo controlador a varios elementos. Para ello, separe con comas las referencias *Instancia.Evento* después de `Handles`.</span><span class="sxs-lookup"><span data-stu-id="b80e8-110">You can assign the same handler to multiple elements by separating *Instance.Event* references after `Handles` with commas.</span></span>  
  
 <span data-ttu-id="b80e8-111">Puede usar `Handles` para asignar más de un controlador a la misma referencia *Instancia.Evento*.</span><span class="sxs-lookup"><span data-stu-id="b80e8-111">You can use `Handles` to assign more than one handler to the same *Instance.Event*reference.</span></span> <span data-ttu-id="b80e8-112">No dé importancia al orden en el que se proporcionan los controladores en la referencia `Handles`, ya que se supone que los controladores que controlan el mismo evento se pueden invocar en cualquier orden.</span><span class="sxs-lookup"><span data-stu-id="b80e8-112">Do not assign any importance to the order in which handlers are given in the `Handles` reference; you should assume that handlers that handle the same event can be invoked in any order.</span></span>  
  
 <span data-ttu-id="b80e8-113">Para quitar un controlador que se agregó con `Handles` en la declaración, puede llamar a <xref:System.Windows.UIElement.RemoveHandler%2A>.</span><span class="sxs-lookup"><span data-stu-id="b80e8-113">To remove a handler that was added with `Handles` in the declaration, you can call <xref:System.Windows.UIElement.RemoveHandler%2A>.</span></span>  
  
 <span data-ttu-id="b80e8-114">Puede usar `Handles` para asociar controladores para eventos enrutados, siempre y cuando asocie los controladores a instancias que definen el evento que se está controlando en sus tablas de miembros.</span><span class="sxs-lookup"><span data-stu-id="b80e8-114">You can use `Handles` to attach handlers for routed events, so long as you attach handlers to instances that define the event being handled in their members tables.</span></span> <span data-ttu-id="b80e8-115">En el caso de los eventos enrutados, los controladores adjuntos con `Handles` siguen las mismas reglas de enrutamiento que los controladores que se adjuntan como [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] atributos o con la firma común de <xref:System.Windows.UIElement.AddHandler%2A>.</span><span class="sxs-lookup"><span data-stu-id="b80e8-115">For routed events, handlers that are attached with `Handles` follow the same routing rules as do handlers that are attached as [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] attributes, or with the common signature of <xref:System.Windows.UIElement.AddHandler%2A>.</span></span> <span data-ttu-id="b80e8-116">Esto significa que si el evento ya está marcado como controlado (la propiedad <xref:System.Windows.RoutedEventArgs.Handled%2A> en los datos de evento se `True`), los controladores adjuntos con `Handles` no se invocan en respuesta a esa instancia de evento.</span><span class="sxs-lookup"><span data-stu-id="b80e8-116">This means that if the event is already marked handled (the <xref:System.Windows.RoutedEventArgs.Handled%2A> property in the event data is `True`), then handlers attached with `Handles` are not invoked in response to that event instance.</span></span> <span data-ttu-id="b80e8-117">El evento lo pueden marcar como controlado los controladores de instancia de otro elemento de la ruta o la clase que controla en el elemento actual o en elementos anteriores de la ruta.</span><span class="sxs-lookup"><span data-stu-id="b80e8-117">The event could be marked handled by instance handlers on another element in the route, or by class handling either on the current element or earlier elements along the route.</span></span> <span data-ttu-id="b80e8-118">En el caso de los eventos de entrada que admiten eventos emparejados de túnel/propagación, la ruta de tunelización puede haber marcado como controlado el par de eventos.</span><span class="sxs-lookup"><span data-stu-id="b80e8-118">For input events that support paired tunnel/bubble events, the tunneling route may have marked the event pair handled.</span></span> <span data-ttu-id="b80e8-119">Para obtener más información sobre los eventos enrutados, vea [Información general sobre eventos enrutados](routed-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="b80e8-119">For more information about routed events, see [Routed Events Overview](routed-events-overview.md).</span></span>  
  
## <a name="limitations-of-handles-for-adding-handlers"></a><span data-ttu-id="b80e8-120">Limitaciones de "Handles" para agregar controladores</span><span class="sxs-lookup"><span data-stu-id="b80e8-120">Limitations of "Handles" for Adding Handlers</span></span>  
 <span data-ttu-id="b80e8-121">`Handles` no puede hacer referencia a controladores para eventos adjuntos.</span><span class="sxs-lookup"><span data-stu-id="b80e8-121">`Handles` cannot reference handlers for attached events.</span></span> <span data-ttu-id="b80e8-122">Debe usar el método de descriptor de acceso `add` para ese evento adjunto o atributos de evento *nombreDeTipo.nombreDeEvento* en [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b80e8-122">You must use the `add` accessor method for that attached event, or *typename.eventname* event attributes in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span> <span data-ttu-id="b80e8-123">Para obtener más información, vea [Información general sobre eventos enrutados](routed-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="b80e8-123">For details, see [Routed Events Overview](routed-events-overview.md).</span></span>  
  
 <span data-ttu-id="b80e8-124">En el caso de los eventos enrutados, solo se puede usar `Handles` para asignar controladores a las instancias en las que ese evento existe en la tabla de miembros de instancia.</span><span class="sxs-lookup"><span data-stu-id="b80e8-124">For routed events, you can only use `Handles` to assign handlers for instances where that event exists in the instance members table.</span></span> <span data-ttu-id="b80e8-125">Pero, en los eventos enrutados en general, un elemento primario puede ser un agente de escucha de un evento de elementos secundarios, incluso si el elemento primario no contiene ese evento en su tabla de miembros.</span><span class="sxs-lookup"><span data-stu-id="b80e8-125">However, with routed events in general, a parent element can be a listener for an event from child elements, even if the parent element does not have that event in its members table.</span></span> <span data-ttu-id="b80e8-126">En la sintaxis de atributo, puede especificar esto mediante un formato de atributo *nombreDeTipo.nombreDeMiembro* que califica el tipo que realmente define el evento que quiere controlar.</span><span class="sxs-lookup"><span data-stu-id="b80e8-126">In attribute syntax, you can specify this through a *typename.membername* attribute form that qualifies which type actually defines the event you want to handle.</span></span> <span data-ttu-id="b80e8-127">Por ejemplo, un `Page` primario (sin ningún evento de `Click` definido) puede escuchar eventos de clic de botón mediante la asignación de un controlador de atributo con el formato `Button.Click`.</span><span class="sxs-lookup"><span data-stu-id="b80e8-127">For instance, a parent `Page` (with no `Click` event defined) can listen for button-click events by assigning an attribute handler in the form `Button.Click`.</span></span> <span data-ttu-id="b80e8-128">Pero `Handles` no es compatible con el formato *nombreDeTipo.nombreDeMiembro*, porque debe admitir un formato *Instancia.Evento* que entra en conflicto.</span><span class="sxs-lookup"><span data-stu-id="b80e8-128">But `Handles` does not support the *typename.membername* form, because it must support a conflicting *Instance.Event* form.</span></span> <span data-ttu-id="b80e8-129">Para obtener más información, vea [Información general sobre eventos enrutados](routed-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="b80e8-129">For details, see [Routed Events Overview](routed-events-overview.md).</span></span>  
  
 <span data-ttu-id="b80e8-130">`Handles` no puede adjuntar los controladores que se invocan para eventos que ya están marcados como controlados.</span><span class="sxs-lookup"><span data-stu-id="b80e8-130">`Handles` cannot attach handlers that are invoked for events that are already marked handled.</span></span> <span data-ttu-id="b80e8-131">En su lugar, debe usar el código y llamar a la sobrecarga de `handledEventsToo` de <xref:System.Windows.UIElement.AddHandler%28System.Windows.RoutedEvent%2CSystem.Delegate%2CSystem.Boolean%29>.</span><span class="sxs-lookup"><span data-stu-id="b80e8-131">Instead, you must use code and call the `handledEventsToo` overload of <xref:System.Windows.UIElement.AddHandler%28System.Windows.RoutedEvent%2CSystem.Delegate%2CSystem.Boolean%29>.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="b80e8-132">No use la sintaxis de `Handles` en el código de Visual Basic al especificar un controlador de eventos para el mismo evento en XAML.</span><span class="sxs-lookup"><span data-stu-id="b80e8-132">Do not use the `Handles` syntax in Visual Basic code when you specify an event handler for the same event in XAML.</span></span> <span data-ttu-id="b80e8-133">En ese caso, se llama al controlador de eventos dos veces.</span><span class="sxs-lookup"><span data-stu-id="b80e8-133">In this case, the event handler is called twice.</span></span>  
  
## <a name="how-wpf-implements-handles-functionality"></a><span data-ttu-id="b80e8-134">Cómo implementa WPF la funcionalidad "Handles"</span><span class="sxs-lookup"><span data-stu-id="b80e8-134">How WPF Implements "Handles" Functionality</span></span>  
 <span data-ttu-id="b80e8-135">Cuando se compila una página de [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)], el archivo intermedio declara `Friend` `WithEvents` referencias a todos los elementos de la página que tienen un conjunto de propiedades <xref:System.Windows.FrameworkContentElement.Name%2A> (o una [Directiva x:Name](../../../desktop-wpf/xaml-services/xname-directive.md) declarada).</span><span class="sxs-lookup"><span data-stu-id="b80e8-135">When a [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] page is compiled, the intermediate file declares `Friend` `WithEvents` references to every element on the page that has a <xref:System.Windows.FrameworkContentElement.Name%2A> property set (or [x:Name Directive](../../../desktop-wpf/xaml-services/xname-directive.md) declared).</span></span> <span data-ttu-id="b80e8-136">Cada instancia con nombre es potencialmente un elemento que se puede asignar a un controlador mediante `Handles`.</span><span class="sxs-lookup"><span data-stu-id="b80e8-136">Each named instance is potentially an element that can be assigned to a handler through `Handles`.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="b80e8-137">En Visual Studio, IntelliSense puede mostrar la finalización de los elementos que están disponibles para una referencia `Handles` en una página.</span><span class="sxs-lookup"><span data-stu-id="b80e8-137">Within Visual Studio, IntelliSense can show you completion for which elements are available for a `Handles` reference in a page.</span></span> <span data-ttu-id="b80e8-138">Sin embargo, esto podría ocupar un paso de compilación para que el archivo intermedio pueda rellenar todas las referencias `Friends`.</span><span class="sxs-lookup"><span data-stu-id="b80e8-138">However, this might take one compile pass so that the intermediate file can populate all the `Friends` references.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b80e8-139">Vea también</span><span class="sxs-lookup"><span data-stu-id="b80e8-139">See also</span></span>

- <xref:System.Windows.UIElement.AddHandler%2A>
- [<span data-ttu-id="b80e8-140">Marcar eventos enrutados como controlados y control de clases</span><span class="sxs-lookup"><span data-stu-id="b80e8-140">Marking Routed Events as Handled, and Class Handling</span></span>](marking-routed-events-as-handled-and-class-handling.md)
- [<span data-ttu-id="b80e8-141">Información general sobre eventos enrutados</span><span class="sxs-lookup"><span data-stu-id="b80e8-141">Routed Events Overview</span></span>](routed-events-overview.md)
- [<span data-ttu-id="b80e8-142">Información general sobre XAML (WPF)</span><span class="sxs-lookup"><span data-stu-id="b80e8-142">XAML Overview (WPF)</span></span>](../../../desktop-wpf/fundamentals/xaml.md)
