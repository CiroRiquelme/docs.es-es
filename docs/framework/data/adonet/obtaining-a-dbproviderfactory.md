---
title: Obtener un objeto DbProviderFactory
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: a16e4a4d-6a5b-45db-8635-19570e4572ae
ms.openlocfilehash: 0e2efd593019199ff641610b8602825cc60d4661
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/12/2020
ms.locfileid: "79149471"
---
# <a name="obtaining-a-dbproviderfactory"></a><span data-ttu-id="7222e-102">Obtener un objeto DbProviderFactory</span><span class="sxs-lookup"><span data-stu-id="7222e-102">Obtaining a DbProviderFactory</span></span>
<span data-ttu-id="7222e-103">El proceso de obtención de <xref:System.Data.Common.DbProviderFactory> implica pasar información sobre un proveedor de datos a la clase <xref:System.Data.Common.DbProviderFactories>.</span><span class="sxs-lookup"><span data-stu-id="7222e-103">The process of obtaining a <xref:System.Data.Common.DbProviderFactory> involves passing information about a data provider to the <xref:System.Data.Common.DbProviderFactories> class.</span></span> <span data-ttu-id="7222e-104">En función de esta información, el método <xref:System.Data.Common.DbProviderFactories.GetFactory%2A> crea un generador del proveedor fuertemente tipado.</span><span class="sxs-lookup"><span data-stu-id="7222e-104">Based on this information, the <xref:System.Data.Common.DbProviderFactories.GetFactory%2A> method creates a strongly typed provider factory.</span></span> <span data-ttu-id="7222e-105">Por ejemplo, para crear <xref:System.Data.SqlClient.SqlClientFactory>, se puede pasar a `GetFactory` una cadena con el nombre de proveedor especificado como "System.Data.SqlClient".</span><span class="sxs-lookup"><span data-stu-id="7222e-105">For example, to create a <xref:System.Data.SqlClient.SqlClientFactory>, you can pass `GetFactory` a string with the provider name specified as "System.Data.SqlClient".</span></span> <span data-ttu-id="7222e-106">La otra sobrecarga de `GetFactory` toma <xref:System.Data.DataRow>.</span><span class="sxs-lookup"><span data-stu-id="7222e-106">The other overload of `GetFactory` takes a <xref:System.Data.DataRow>.</span></span> <span data-ttu-id="7222e-107">Una vez creado el generador del proveedor, se pueden utilizar sus métodos para crear objetos adicionales.</span><span class="sxs-lookup"><span data-stu-id="7222e-107">Once you create the provider factory, you can then use its methods to create additional objects.</span></span> <span data-ttu-id="7222e-108">Entre los métodos de `SqlClientFactory` se incluyen <xref:System.Data.SqlClient.SqlClientFactory.CreateConnection%2A>, <xref:System.Data.SqlClient.SqlClientFactory.CreateCommand%2A> y <xref:System.Data.SqlClient.SqlClientFactory.CreateDataAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="7222e-108">Some of the methods of a `SqlClientFactory` include <xref:System.Data.SqlClient.SqlClientFactory.CreateConnection%2A>, <xref:System.Data.SqlClient.SqlClientFactory.CreateCommand%2A>, and <xref:System.Data.SqlClient.SqlClientFactory.CreateDataAdapter%2A>.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="7222e-109">Las clases <xref:System.Data.OracleClient.OracleClientFactory>, <xref:System.Data.Odbc.OdbcFactory> y <xref:System.Data.OleDb.OleDbFactory> de .NET Framework también proporcionan una funcionalidad similar.</span><span class="sxs-lookup"><span data-stu-id="7222e-109">The .NET Framework <xref:System.Data.OracleClient.OracleClientFactory>, <xref:System.Data.Odbc.OdbcFactory>, and <xref:System.Data.OleDb.OleDbFactory> classes also provide similar functionality.</span></span>  
  
## <a name="registering-dbproviderfactories"></a><span data-ttu-id="7222e-110">Registrar DbProviderFactories</span><span class="sxs-lookup"><span data-stu-id="7222e-110">Registering DbProviderFactories</span></span>  
 <span data-ttu-id="7222e-111">Cada proveedor de datos de .NET Framework que admite una clase basada en fábrica registra información de configuración en la sección **DbProviderFactories** del archivo **machine.config** del equipo local.</span><span class="sxs-lookup"><span data-stu-id="7222e-111">Each .NET Framework data provider that supports a factory-based class registers configuration information in the **DbProviderFactories** section of the **machine.config** file on the local computer.</span></span> <span data-ttu-id="7222e-112">El siguiente fragmento del archivo de configuración muestra la sintaxis y formato de <xref:System.Data.SqlClient>.</span><span class="sxs-lookup"><span data-stu-id="7222e-112">The following configuration file fragment shows the syntax and format for <xref:System.Data.SqlClient>.</span></span>  
  
```xml  
<system.data>  
  <DbProviderFactories>  
    <add name="SqlClient Data Provider"  
     invariant="System.Data.SqlClient"
     description=".Net Framework Data Provider for SqlServer"
     type="System.Data.SqlClient.SqlClientFactory, System.Data,
     Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"  
    />  
  </DbProviderFactories>  
</system.data>  
```  
  
 <span data-ttu-id="7222e-113">El atributo **invariable** identifica el proveedor de datos subyacente.</span><span class="sxs-lookup"><span data-stu-id="7222e-113">The **invariant** attribute identifies the underlying data provider.</span></span> <span data-ttu-id="7222e-114">Esta sintaxis de nomenclatura en tres partes también se utiliza al crear un nuevo generador y para identificar al proveedor en un archivo de configuración de la aplicación, de manera que el nombre de proveedor, junto con sus cadenas de conexión asociadas, se puedan recuperar en tiempo de conexión.</span><span class="sxs-lookup"><span data-stu-id="7222e-114">This three-part naming syntax is also used when creating a new factory and for identifying the provider in an application configuration file so that the provider name, along with its associated connection string, can be retrieved at run time.</span></span>  
  
## <a name="retrieving-provider-information"></a><span data-ttu-id="7222e-115">Recuperar información del proveedor</span><span class="sxs-lookup"><span data-stu-id="7222e-115">Retrieving Provider Information</span></span>  
 <span data-ttu-id="7222e-116">Se puede recuperar información acerca de todos los proveedores de datos instalados en el equipo local utilizando el método <xref:System.Data.Common.DbProviderFactories.GetFactoryClasses%2A>.</span><span class="sxs-lookup"><span data-stu-id="7222e-116">You can retrieve information about all of the data providers installed on the local computer by using the <xref:System.Data.Common.DbProviderFactories.GetFactoryClasses%2A> method.</span></span> <span data-ttu-id="7222e-117">Devuelve un <xref:System.Data.DataTable> **dbProviderFactories** con nombre que contiene las columnas descritas en la tabla siguiente.</span><span class="sxs-lookup"><span data-stu-id="7222e-117">It returns a <xref:System.Data.DataTable> named **DbProviderFactories** that contains the columns described in the following table.</span></span>  
  
|<span data-ttu-id="7222e-118">Índice de columna</span><span class="sxs-lookup"><span data-stu-id="7222e-118">Column ordinal</span></span>|<span data-ttu-id="7222e-119">Nombre de la columna</span><span class="sxs-lookup"><span data-stu-id="7222e-119">Column name</span></span>|<span data-ttu-id="7222e-120">Salida de ejemplo</span><span class="sxs-lookup"><span data-stu-id="7222e-120">Example output</span></span>|<span data-ttu-id="7222e-121">Descripción</span><span class="sxs-lookup"><span data-stu-id="7222e-121">Description</span></span>|  
|--------------------|-----------------|--------------------|-----------------|  
|<span data-ttu-id="7222e-122">0</span><span class="sxs-lookup"><span data-stu-id="7222e-122">0</span></span>|<span data-ttu-id="7222e-123">**Nombre**</span><span class="sxs-lookup"><span data-stu-id="7222e-123">**Name**</span></span>|<span data-ttu-id="7222e-124">Proveedor de datos SqlClient</span><span class="sxs-lookup"><span data-stu-id="7222e-124">SqlClient Data Provider</span></span>|<span data-ttu-id="7222e-125">Nombre legible del proveedor de datos</span><span class="sxs-lookup"><span data-stu-id="7222e-125">Readable name for the data provider</span></span>|  
|<span data-ttu-id="7222e-126">1</span><span class="sxs-lookup"><span data-stu-id="7222e-126">1</span></span>|<span data-ttu-id="7222e-127">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="7222e-127">**Description**</span></span>|<span data-ttu-id="7222e-128">Proveedor de datos .NET Framework para SqlServer</span><span class="sxs-lookup"><span data-stu-id="7222e-128">.Net Framework Data Provider for SqlServer</span></span>|<span data-ttu-id="7222e-129">Descripción legible del proveedor de datos</span><span class="sxs-lookup"><span data-stu-id="7222e-129">Readable description of the data provider</span></span>|  
|<span data-ttu-id="7222e-130">2</span><span class="sxs-lookup"><span data-stu-id="7222e-130">2</span></span>|<span data-ttu-id="7222e-131">**InvariantName**</span><span class="sxs-lookup"><span data-stu-id="7222e-131">**InvariantName**</span></span>|<span data-ttu-id="7222e-132">System.Data.SqlClient</span><span class="sxs-lookup"><span data-stu-id="7222e-132">System.Data.SqlClient</span></span>|<span data-ttu-id="7222e-133">Nombre que se puede utilizar mediante programación para hacer referencia al proveedor de datos</span><span class="sxs-lookup"><span data-stu-id="7222e-133">Name that can be used programmatically to refer to the data provider</span></span>|  
|<span data-ttu-id="7222e-134">3</span><span class="sxs-lookup"><span data-stu-id="7222e-134">3</span></span>|<span data-ttu-id="7222e-135">**AssemblyQualifiedName**</span><span class="sxs-lookup"><span data-stu-id="7222e-135">**AssemblyQualifiedName**</span></span>|<span data-ttu-id="7222e-136">System.Data.SqlClient.SqlClientFactory, System.Data, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</span><span class="sxs-lookup"><span data-stu-id="7222e-136">System.Data.SqlClient.SqlClientFactory, System.Data, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</span></span>|<span data-ttu-id="7222e-137">Nombre completo de la clase de generador, el cual tiene información suficiente para crear la instancia del objeto</span><span class="sxs-lookup"><span data-stu-id="7222e-137">Fully qualified name of the factory class, which contains enough information to instantiate the object</span></span>|  
  
 <span data-ttu-id="7222e-138">Este `DataTable` se puede utilizar para permitir a un usuario seleccionar un <xref:System.Data.DataRow> en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="7222e-138">This `DataTable` can be used to enable a user to select a <xref:System.Data.DataRow> at run time.</span></span> <span data-ttu-id="7222e-139">El `DataRow` seleccionado se puede pasar al método <xref:System.Data.Common.DbProviderFactories.GetFactory%2A> para crear un <xref:System.Data.Common.DbProviderFactory> fuertemente tipado.</span><span class="sxs-lookup"><span data-stu-id="7222e-139">The selected `DataRow` can then be passed to the <xref:System.Data.Common.DbProviderFactories.GetFactory%2A> method to create a strongly typed <xref:System.Data.Common.DbProviderFactory>.</span></span> <span data-ttu-id="7222e-140">Un <xref:System.Data.DataRow> seleccionado se puede pasar al método `GetFactory` para crear el objeto `DbProviderFactory` deseado.</span><span class="sxs-lookup"><span data-stu-id="7222e-140">A selected <xref:System.Data.DataRow> can be passed to the `GetFactory` method to create the desired `DbProviderFactory` object.</span></span>  
  
## <a name="listing-the-installed-provider-factory-classes"></a><span data-ttu-id="7222e-141">Enumerar las clases de generador del proveedor instaladas</span><span class="sxs-lookup"><span data-stu-id="7222e-141">Listing the Installed Provider Factory Classes</span></span>  
 <span data-ttu-id="7222e-142">Este ejemplo muestra cómo el método <xref:System.Data.Common.DbProviderFactories.GetFactoryClasses%2A> devuelve un <xref:System.Data.DataTable> con información sobre los proveedores instalados.</span><span class="sxs-lookup"><span data-stu-id="7222e-142">This example demonstrates how to use the <xref:System.Data.Common.DbProviderFactories.GetFactoryClasses%2A> method to return a <xref:System.Data.DataTable> containing information about the installed providers.</span></span> <span data-ttu-id="7222e-143">El código recorre en iteración cada fila de `DataTable` y muestra información de todos los proveedores instalados en la ventana de la consola.</span><span class="sxs-lookup"><span data-stu-id="7222e-143">The code iterates through each row in the `DataTable`, displaying information for each installed provider in the console window.</span></span>  
  
 [!code-csharp[DataWorks DbProviderFactories#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks DbProviderFactories/CS/source.cs#1)]
 [!code-vb[DataWorks DbProviderFactories#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks DbProviderFactories/VB/source.vb#1)]  
  
## <a name="using-application-configuration-files-to-store-factory-information"></a><span data-ttu-id="7222e-144">Utilizar archivos de configuración de la aplicación para almacenar información del generador</span><span class="sxs-lookup"><span data-stu-id="7222e-144">Using Application Configuration Files to Store Factory Information</span></span>  
 <span data-ttu-id="7222e-145">El patrón de diseño utilizado para trabajar con fábricas implica almacenar información de proveedor y cadena de conexión en un archivo de configuración de aplicación, como **app.config** para una aplicación de Windows y **web.config** para una aplicación de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="7222e-145">The design pattern used for working with factories entails storing provider and connection string information in an application configuration file, such as **app.config** for a Windows application, and **web.config** for an ASP.NET application.</span></span>  
  
 <span data-ttu-id="7222e-146">El siguiente fragmento de archivo de configuración muestra cómo guardar dos cadenas de conexión, una denominada "NorthwindSQL", para la conexión a la base de datos Northwind de SQL Server, y la otra denominada "NorthwindAccess", para una conexión a la base de datos Northwind de Access/Jet.</span><span class="sxs-lookup"><span data-stu-id="7222e-146">The following configuration file fragment demonstrates how to save two named connection strings, "NorthwindSQL" for a connection to the Northwind database in SQL Server, and "NorthwindAccess" for a connection to the Northwind database in Access/Jet.</span></span> <span data-ttu-id="7222e-147">El nombre **invariable** se utiliza para el atributo **providerName.**</span><span class="sxs-lookup"><span data-stu-id="7222e-147">The **invariant** name is used for the **providerName** attribute.</span></span>  
  
```xml  
<configuration>  
  <connectionStrings>  
    <clear/>  
    <add name="NorthwindSQL"
     providerName="System.Data.SqlClient"
     connectionString=  
     "Data Source=MSSQL1;Initial Catalog=Northwind;Integrated Security=true"  
    />  
  
    <add name="NorthwindAccess"
     providerName="System.Data.OleDb"
     connectionString=  
     "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\Data\Northwind.mdb;"  
    />  
  </connectionStrings>  
</configuration>  
```  
  
### <a name="retrieving-a-connection-string-by-provider-name"></a><span data-ttu-id="7222e-148">Recuperar una cadena de conexión por el nombre de proveedor</span><span class="sxs-lookup"><span data-stu-id="7222e-148">Retrieving a Connection String by Provider Name</span></span>  
 <span data-ttu-id="7222e-149">Para crear un generador del proveedor, debe proporcionar una cadena de conexión así como el nombre del proveedor.</span><span class="sxs-lookup"><span data-stu-id="7222e-149">In order to create a provider factory, you must supply a connection string as well as the provider name.</span></span> <span data-ttu-id="7222e-150">En este ejemplo se muestra cómo recuperar una cadena de conexión de un archivo de configuración de aplicación pasando el nombre del proveedor en el formato invariable "*System.Data.ProviderName*".</span><span class="sxs-lookup"><span data-stu-id="7222e-150">This example demonstrates how to retrieve a connection string from an application configuration file by passing the provider name in the invariant format "*System.Data.ProviderName*".</span></span> <span data-ttu-id="7222e-151">El código recorre en iteración <xref:System.Configuration.ConnectionStringSettingsCollection>.</span><span class="sxs-lookup"><span data-stu-id="7222e-151">The code iterates through the <xref:System.Configuration.ConnectionStringSettingsCollection>.</span></span> <span data-ttu-id="7222e-152">Devuelve correctamente <xref:System.Configuration.ConnectionStringSettings.ProviderName%2A>; en caso contrario, `null` (`Nothing` en Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="7222e-152">It returns the <xref:System.Configuration.ConnectionStringSettings.ProviderName%2A> on success; otherwise `null` (`Nothing` in Visual Basic).</span></span> <span data-ttu-id="7222e-153">Si existen varias entradas para un proveedor, se devuelve la primera que se encuentra.</span><span class="sxs-lookup"><span data-stu-id="7222e-153">If there are multiple entries for a provider, the first one found is returned.</span></span> <span data-ttu-id="7222e-154">Para obtener más información y ejemplos de recuperación de cadenas de conexión de archivos de configuración, vea Cadenas de [conexión y archivos](connection-strings-and-configuration-files.md)de configuración .</span><span class="sxs-lookup"><span data-stu-id="7222e-154">For more information and examples of retrieving connection strings from configuration files, see [Connection Strings and Configuration Files](connection-strings-and-configuration-files.md).</span></span>  
  
> [!NOTE]
> <span data-ttu-id="7222e-155">Se necesita una referencia a `System.Configuration.dll` para que se ejecute el código.</span><span class="sxs-lookup"><span data-stu-id="7222e-155">A reference to `System.Configuration.dll` is required in order for the code to run.</span></span>  
  
 [!code-csharp[DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider/CS/source.cs#1)]
 [!code-vb[DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider/VB/source.vb#1)]  
  
## <a name="creating-the-dbproviderfactory-and-dbconnection"></a><span data-ttu-id="7222e-156">Crear DbProviderFactory y DbConnection</span><span class="sxs-lookup"><span data-stu-id="7222e-156">Creating the DbProviderFactory and DbConnection</span></span>  
 <span data-ttu-id="7222e-157">En este ejemplo se <xref:System.Data.Common.DbProviderFactory> muestra <xref:System.Data.Common.DbConnection> cómo crear un y object pasándole el nombre del proveedor en el formato "*System.Data.ProviderName*" y una cadena de conexión.</span><span class="sxs-lookup"><span data-stu-id="7222e-157">This example demonstrates how to create a <xref:System.Data.Common.DbProviderFactory> and <xref:System.Data.Common.DbConnection> object by passing it the provider name in the format "*System.Data.ProviderName*" and a connection string.</span></span> <span data-ttu-id="7222e-158">Se devuelve correctamente un objeto `DbConnection`; `null` (`Nothing` en Visual Basic), en caso de producirse un error.</span><span class="sxs-lookup"><span data-stu-id="7222e-158">A `DbConnection` object is returned on success; `null` (`Nothing` in Visual Basic) on any error.</span></span>  
  
 <span data-ttu-id="7222e-159">El código obtiene `DbProviderFactory` llamando a <xref:System.Data.Common.DbProviderFactories.GetFactory%2A>.</span><span class="sxs-lookup"><span data-stu-id="7222e-159">The code obtains the `DbProviderFactory` by calling <xref:System.Data.Common.DbProviderFactories.GetFactory%2A>.</span></span> <span data-ttu-id="7222e-160">Entonces, el método <xref:System.Data.Common.DbProviderFactory.CreateConnection%2A> crea el objeto <xref:System.Data.Common.DbConnection> y la propiedad <xref:System.Data.Common.DbConnection.ConnectionString%2A> se establece en la cadena de conexión.</span><span class="sxs-lookup"><span data-stu-id="7222e-160">Then the <xref:System.Data.Common.DbProviderFactory.CreateConnection%2A> method creates the <xref:System.Data.Common.DbConnection> object and the <xref:System.Data.Common.DbConnection.ConnectionString%2A> property is set to the connection string.</span></span>  
  
 [!code-csharp[DataWorks DbProviderFactories.GetFactory#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks DbProviderFactories.GetFactory/CS/source.cs#1)]
 [!code-vb[DataWorks DbProviderFactories.GetFactory#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks DbProviderFactories.GetFactory/VB/source.vb#1)]  
  
## <a name="see-also"></a><span data-ttu-id="7222e-161">Consulte también</span><span class="sxs-lookup"><span data-stu-id="7222e-161">See also</span></span>

- [<span data-ttu-id="7222e-162">Objetos DbProviderFactory</span><span class="sxs-lookup"><span data-stu-id="7222e-162">DbProviderFactories</span></span>](dbproviderfactories.md)
- [<span data-ttu-id="7222e-163">Cadenas de conexión</span><span class="sxs-lookup"><span data-stu-id="7222e-163">Connection Strings</span></span>](connection-strings.md)
- <span data-ttu-id="7222e-164">[Utilizar las clases Configuration](https://docs.microsoft.com/previous-versions/aspnet/ms228063(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="7222e-164">[Using the Configuration Classes](https://docs.microsoft.com/previous-versions/aspnet/ms228063(v=vs.100))</span></span>
- [<span data-ttu-id="7222e-165">Información general de ADO.NET</span><span class="sxs-lookup"><span data-stu-id="7222e-165">ADO.NET Overview</span></span>](ado-net-overview.md)
