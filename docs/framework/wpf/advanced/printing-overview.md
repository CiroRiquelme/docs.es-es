---
title: Información general sobre impresión
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- print path [WPF], XPS
- printers [WPF], XPSDrv-based
- printing [WPF]
- PrintQueue class PrintServer class [WPF]
- XML Paper Specification (XPS) file format
- XPS (XML Paper Specification) file format
- XPSDrv-based printers
- GDI print path [WPF]
ms.assetid: 0de8ac41-9aa6-413d-a121-7aa6f41539b1
ms.openlocfilehash: 22d363fde369bc7e84a9354d27f57af356f30ebb
ms.sourcegitcommit: 7bc6887ab658550baa78f1520ea735838249345e
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/03/2020
ms.locfileid: "75636463"
---
# <a name="printing-overview"></a><span data-ttu-id="cccec-102">Información general sobre impresión</span><span class="sxs-lookup"><span data-stu-id="cccec-102">Printing Overview</span></span>
<span data-ttu-id="cccec-103">Con Microsoft .NET Framework, los desarrolladores de aplicaciones que usan Windows Presentation Foundation (WPF) tienen un nuevo conjunto de API de impresión y administración del sistema de impresión.</span><span class="sxs-lookup"><span data-stu-id="cccec-103">With Microsoft .NET Framework, application developers using Windows Presentation Foundation (WPF) have a rich new set of printing and print system management APIs.</span></span> <span data-ttu-id="cccec-104">Con Windows Vista, algunas de estas mejoras del sistema de impresión también están disponibles para los desarrolladores que crean [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] aplicaciones y desarrolladores que usan código no administrado.</span><span class="sxs-lookup"><span data-stu-id="cccec-104">With Windows Vista, some of these print system enhancements are also available to developers creating [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] applications and developers using unmanaged code.</span></span> <span data-ttu-id="cccec-105">La base de esta nueva funcionalidad es el nuevo formato de archivo XML Paper Specification (XPS) y la ruta de impresión XPS.</span><span class="sxs-lookup"><span data-stu-id="cccec-105">At the core of this new functionality is the new XML Paper Specification (XPS) file format and the XPS print path.</span></span>  
  
 <span data-ttu-id="cccec-106">En este tema se incluyen las siguientes secciones.</span><span class="sxs-lookup"><span data-stu-id="cccec-106">This topic contains the following sections.</span></span>  
  
<a name="introduction_to_XPS"></a>   
## <a name="about-xps"></a><span data-ttu-id="cccec-107">Sobre XPS</span><span class="sxs-lookup"><span data-stu-id="cccec-107">About XPS</span></span>  
 <span data-ttu-id="cccec-108">XPS es un formato de documento electrónico, un formato de archivo de cola de impresión y un lenguaje de descripción de página.</span><span class="sxs-lookup"><span data-stu-id="cccec-108">XPS is an electronic document format, a spool file format and a page description language.</span></span> <span data-ttu-id="cccec-109">Es un formato de documento abierto que usa XML, convenciones de empaquetado abierto (OPC) y otros estándares del sector para crear documentos multiplataforma.</span><span class="sxs-lookup"><span data-stu-id="cccec-109">It is an open document format that uses XML, Open Packaging Conventions (OPC), and other industry standards to create cross-platform documents.</span></span> <span data-ttu-id="cccec-110">XPS simplifica el proceso mediante el cual los documentos digitales se crean, comparten, imprimen, ven y archivan.</span><span class="sxs-lookup"><span data-stu-id="cccec-110">XPS simplifies the process by which digital documents are created, shared, printed, viewed, and archived.</span></span> <span data-ttu-id="cccec-111">Para obtener información adicional sobre XPS, consulte [documentos XPS](/windows/desktop/printdocs/documents).</span><span class="sxs-lookup"><span data-stu-id="cccec-111">For additional information on XPS, see [XPS Documents](/windows/desktop/printdocs/documents).</span></span>  
  
 <span data-ttu-id="cccec-112">Varias técnicas de impresión de contenido basado en XPS mediante WPF se muestran en [Imprimir archivos XPS mediante programación](how-to-programmatically-print-xps-files.md).</span><span class="sxs-lookup"><span data-stu-id="cccec-112">Several techniques for printing XPS-based content using WPF are demonstrated in [Programmatically Print XPS Files](how-to-programmatically-print-xps-files.md).</span></span> <span data-ttu-id="cccec-113">Estos ejemplos le resultarán útil para comprender el contenido de este tema.</span><span class="sxs-lookup"><span data-stu-id="cccec-113">You may find it useful to reference these samples during review of content contained in this topic.</span></span> <span data-ttu-id="cccec-114">(Los desarrolladores de código no administrado deben ver la documentación de la [función MXDC_ESCAPE](/windows/desktop/printdocs/mxdc-escape).</span><span class="sxs-lookup"><span data-stu-id="cccec-114">(Unmanaged code developers should see documentation for the [MXDC_ESCAPE function](/windows/desktop/printdocs/mxdc-escape).</span></span> <span data-ttu-id="cccec-115">Windows Forms desarrolladores deben usar la API en el espacio de nombres <xref:System.Drawing.Printing> que no admite la ruta de impresión completa de XPS, pero admite una ruta de impresión híbrida de GDI a XPS.</span><span class="sxs-lookup"><span data-stu-id="cccec-115">Windows Forms developers must use the API in the <xref:System.Drawing.Printing> namespace which does not support the full XPS print path, but does support a hybrid GDI-to-XPS print path.</span></span> <span data-ttu-id="cccec-116">Consulte el siguiente apartado **Arquitectura de la ruta de impresión**).</span><span class="sxs-lookup"><span data-stu-id="cccec-116">See **Print Path Architecture** below.)</span></span>  
  
<a name="XPS_print_path_intro"></a>   
## <a name="xps-print-path"></a><span data-ttu-id="cccec-117">Ruta de impresión XPS</span><span class="sxs-lookup"><span data-stu-id="cccec-117">XPS Print Path</span></span>  
 <span data-ttu-id="cccec-118">La ruta de impresión de XML Paper Specification (XPS) es una nueva característica de Windows que vuelve a definir la forma en que se controla la impresión en aplicaciones de Windows.</span><span class="sxs-lookup"><span data-stu-id="cccec-118">The XML Paper Specification (XPS) print path is a new Windows feature that redefines how printing is handled in Windows applications.</span></span> <span data-ttu-id="cccec-119">Dado que XPS puede reemplazar un lenguaje de presentación de documentos (como RTF), un formato de administrador de trabajos de impresión (como WMF) y un lenguaje de descripción de páginas (como PCL o PostScript); la nueva ruta de impresión mantiene el formato XPS de la publicación de la aplicación al procesamiento final en el dispositivo o controlador de impresión.</span><span class="sxs-lookup"><span data-stu-id="cccec-119">Because XPS can replace a document presentation language (such as RTF), a print spooler format (such as WMF), and a page description language (such as PCL or Postscript); the new print path maintains the XPS format from application publication to the final processing in the print driver or device.</span></span>  
  
 <span data-ttu-id="cccec-120">La ruta de impresión XPS se basa en el modelo de controlador de impresora XPS (XPSDrv), que proporciona varias ventajas a los desarrolladores, como la impresión de lo que se ve es lo que se obtiene (WYSIWYG), la compatibilidad mejorada con colores y el rendimiento de impresión considerablemente mejorado.</span><span class="sxs-lookup"><span data-stu-id="cccec-120">The XPS print path is built upon the XPS printer driver model (XPSDrv), which provides several benefits for developers such as "what you see is what you get" (WYSIWYG) printing, improved color support, and significantly improved print performance.</span></span> <span data-ttu-id="cccec-121">(Para obtener más información sobre XPSDrv, consulte la [documentación del kit de controladores de Windows](/windows-hardware/drivers/)).</span><span class="sxs-lookup"><span data-stu-id="cccec-121">(For more on XPSDrv, see the [Windows Driver Kit documentation](/windows-hardware/drivers/).)</span></span>  
  
 <span data-ttu-id="cccec-122">La operación del administrador de trabajos de impresión para documentos XPS es esencialmente la misma que en versiones anteriores de Windows.</span><span class="sxs-lookup"><span data-stu-id="cccec-122">The operation of the print spooler for XPS documents is essentially the same as in previous versions of Windows.</span></span> <span data-ttu-id="cccec-123">Sin embargo, se ha mejorado para admitir la ruta de impresión XPS además de la ruta de impresión de GDI existente.</span><span class="sxs-lookup"><span data-stu-id="cccec-123">However, it has been enhanced to support the XPS print path in addition to the existing GDI print path.</span></span> <span data-ttu-id="cccec-124">La nueva ruta de impresión usa de forma nativa un archivo de cola XPS.</span><span class="sxs-lookup"><span data-stu-id="cccec-124">The new print path natively consumes an XPS spool file.</span></span> <span data-ttu-id="cccec-125">Aunque los controladores de impresora de modo de usuario escritos para versiones anteriores de Windows seguirán funcionando, es necesario un controlador de impresora XPS (XPSDrv) para poder usar la ruta de impresión XPS.</span><span class="sxs-lookup"><span data-stu-id="cccec-125">While user-mode printer drivers written for previous versions of Windows will continue to work, an XPS printer driver (XPSDrv) is required in order to use the XPS print path.</span></span>  
  
 <span data-ttu-id="cccec-126">Las ventajas de la ruta de impresión XPS son significativas e incluyen:</span><span class="sxs-lookup"><span data-stu-id="cccec-126">The benefits of the XPS print path are significant, and include:</span></span>  
  
- <span data-ttu-id="cccec-127">Compatibilidad con impresión WYSIWYG</span><span class="sxs-lookup"><span data-stu-id="cccec-127">WYSIWYG print support</span></span>  
  
- <span data-ttu-id="cccec-128">Soporte nativo de perfiles de color avanzados, que incluyen 32 bits por canal (bpc), CMYK, colores con nombre, tintas n y soporte nativo de transparencia y degradados.</span><span class="sxs-lookup"><span data-stu-id="cccec-128">Native support of advanced color profiles, which include 32 bits per channel (bpc), CMYK, named-colors, n-inks, and native support of transparency and gradients.</span></span>  
  
- <span data-ttu-id="cccec-129">Rendimiento de impresión mejorado para aplicaciones basadas en .NET Framework y [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cccec-129">Improved print performance for both .NET Framework and [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] based applications.</span></span>  
  
- <span data-ttu-id="cccec-130">Formato XPS estándar del sector.</span><span class="sxs-lookup"><span data-stu-id="cccec-130">Industry standard XPS format.</span></span>  
  
 <span data-ttu-id="cccec-131">En el caso de los escenarios de impresión básicos, hay disponible una API sencilla e intuitiva con un único punto de entrada para la interfaz de usuario, la configuración y el envío de trabajos.</span><span class="sxs-lookup"><span data-stu-id="cccec-131">For basic print scenarios, a simple and intuitive API is available with a single entry point for user interface, configuration and job submission.</span></span> <span data-ttu-id="cccec-132">Para los escenarios avanzados se agrega soporte adicional para la personalización de la [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] (o sin [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]), impresión sincrónica o asincrónica y capacidades de impresión por lotes.</span><span class="sxs-lookup"><span data-stu-id="cccec-132">For advanced scenarios, an additional support is added for [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] customization (or no [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] at all), synchronous or asynchronous printing, and batch printing capabilities.</span></span> <span data-ttu-id="cccec-133">Ambas opciones ofrecen soporte de impresión en modo de confianza plena o parcial.</span><span class="sxs-lookup"><span data-stu-id="cccec-133">Both options provide print support in full or partial trust mode.</span></span>  
  
 <span data-ttu-id="cccec-134">XPS se diseñó teniendo en cuenta la extensibilidad.</span><span class="sxs-lookup"><span data-stu-id="cccec-134">XPS was designed with extensibility in mind.</span></span> <span data-ttu-id="cccec-135">Con el marco de extensibilidad, se pueden agregar características y capacidades a XPS de una manera modular.</span><span class="sxs-lookup"><span data-stu-id="cccec-135">By using the extensibility framework, features and capabilities can be added to XPS in a modular manner.</span></span> <span data-ttu-id="cccec-136">Las características de extensibilidad incluyen:</span><span class="sxs-lookup"><span data-stu-id="cccec-136">Extensibility features include:</span></span>  
  
- <span data-ttu-id="cccec-137">Esquema de impresión.</span><span class="sxs-lookup"><span data-stu-id="cccec-137">Print Schema.</span></span> <span data-ttu-id="cccec-138">El esquema público se actualiza periódicamente y permite la extensión rápida de las capacidades del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="cccec-138">The public schema is updated regularly and enables rapid extension of device capabilities.</span></span> <span data-ttu-id="cccec-139">(Consulte más abajo **PrintTicket y PrintCapabilities**).</span><span class="sxs-lookup"><span data-stu-id="cccec-139">(See **PrintTicket and PrintCapabilities** below.)</span></span>  
  
- <span data-ttu-id="cccec-140">Canalización de filtros extensible.</span><span class="sxs-lookup"><span data-stu-id="cccec-140">Extensible Filter Pipeline.</span></span> <span data-ttu-id="cccec-141">La canalización de filtros del controlador de impresora XPS (XPSDrv) se diseñó para habilitar la impresión directa y escalable de documentos XPS.</span><span class="sxs-lookup"><span data-stu-id="cccec-141">The XPS printer driver (XPSDrv) filter pipeline was designed to enable both direct and scalable printing of XPS documents.</span></span> <span data-ttu-id="cccec-142">Para obtener más información, consulte [controladores de impresora XPSDrv](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span><span class="sxs-lookup"><span data-stu-id="cccec-142">For more information, see [XPSDrv Printer Drivers](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span></span> 
  
### <a name="print-path-architecture"></a><span data-ttu-id="cccec-143">Arquitectura de la ruta de impresión</span><span class="sxs-lookup"><span data-stu-id="cccec-143">Print Path Architecture</span></span>  
 <span data-ttu-id="cccec-144">Aunque tanto las aplicaciones [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] como las .NET Framework admiten XPS, [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] y las aplicaciones de Windows Forms usan una conversión de GDI a XPS para crear contenido con formato XPS para el controlador de impresora XPS (XPSDrv).</span><span class="sxs-lookup"><span data-stu-id="cccec-144">While both [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and .NET Framework applications support XPS, [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and Windows Forms applications use a GDI to XPS conversion in order to create XPS formatted content for the XPS printer driver (XPSDrv).</span></span> <span data-ttu-id="cccec-145">Estas aplicaciones no necesitan usar la ruta de impresión XPS y pueden seguir utilizando la impresión basada en metarchivo mejorado (EMF).</span><span class="sxs-lookup"><span data-stu-id="cccec-145">These applications are not required to use the XPS print path, and can continue to use Enhanced Metafile (EMF) based printing.</span></span> <span data-ttu-id="cccec-146">Sin embargo, la mayoría de las características y mejoras de XPS solo están disponibles para las aplicaciones que tienen como destino la ruta de impresión XPS.</span><span class="sxs-lookup"><span data-stu-id="cccec-146">However, most XPS features and enhancements are only available to applications that target the XPS print path.</span></span>  
  
 <span data-ttu-id="cccec-147">Para habilitar el uso de impresoras basadas en XPSDrv por [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] y Windows Forms aplicaciones, el controlador de impresora XPS (XPSDrv) admite la conversión de GDI al formato XPS.</span><span class="sxs-lookup"><span data-stu-id="cccec-147">To enable the use of XPSDrv-based printers by [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and Windows Forms applications, the XPS printer driver (XPSDrv) supports conversion of GDI to XPS format.</span></span> <span data-ttu-id="cccec-148">El modelo XPSDrv también proporciona un convertidor para el formato de XPS a GDI, de modo que las aplicaciones de [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] puedan imprimir documentos XPS.</span><span class="sxs-lookup"><span data-stu-id="cccec-148">The XPSDrv model also provides a converter for XPS to GDI format so that [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] applications can print XPS Documents.</span></span> <span data-ttu-id="cccec-149">En el caso de las aplicaciones de WPF, la conversión del formato XPS a GDI se realiza automáticamente mediante los métodos <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> y <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> de la clase <xref:System.Windows.Xps.XpsDocumentWriter> cada vez que la cola de impresión de destino de la operación de escritura no tiene un controlador XPSDrv.</span><span class="sxs-lookup"><span data-stu-id="cccec-149">For WPF applications, conversion of XPS to GDI format is done automatically by the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter> class whenever the target print queue of the write operation does not have an XPSDrv driver.</span></span> <span data-ttu-id="cccec-150">(Windows Forms aplicaciones no pueden imprimir documentos XPS).</span><span class="sxs-lookup"><span data-stu-id="cccec-150">(Windows Forms applications cannot print XPS Documents.)</span></span>  
  
 <span data-ttu-id="cccec-151">En la ilustración siguiente se muestra el subsistema de impresión y se definen las partes proporcionadas por Microsoft y las partes definidas por los proveedores de software y hardware:</span><span class="sxs-lookup"><span data-stu-id="cccec-151">The following illustration depicts the print subsystem and defines the portions provided by Microsoft, and the portions defined by software and hardware vendors:</span></span>  
  
 ![Captura de pantalla que muestra el sistema de impresión XPS.](./media/printing-overview/xml-paper-specification-print-system.png)  
  
### <a name="basic-xps-printing"></a><span data-ttu-id="cccec-153">Impresión XPS básica</span><span class="sxs-lookup"><span data-stu-id="cccec-153">Basic XPS Printing</span></span>  
 <span data-ttu-id="cccec-154">WPF define una API básica y avanzada.</span><span class="sxs-lookup"><span data-stu-id="cccec-154">WPF defines both a basic and advanced API.</span></span> <span data-ttu-id="cccec-155">En el caso de las aplicaciones que no requieren una personalización de impresión amplia o el acceso al conjunto completo de características de XPS, está disponible el soporte básico de impresión.</span><span class="sxs-lookup"><span data-stu-id="cccec-155">For those applications that do not require extensive print customization or access to the complete XPS feature set, basic print support is available.</span></span> <span data-ttu-id="cccec-156">El soporte básico de impresión se expone a través de un control de diálogo de impresión que requiere una configuración mínima y presenta una [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] reconocible.</span><span class="sxs-lookup"><span data-stu-id="cccec-156">Basic print support is exposed through a print dialog control that requires minimal configuration and features a familiar [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="cccec-157">Muchas características de XPS están disponibles con este modelo de impresión simplificado.</span><span class="sxs-lookup"><span data-stu-id="cccec-157">Many XPS features are available using this simplified print model.</span></span>  
  
#### <a name="printdialog"></a><span data-ttu-id="cccec-158">PrintDialog</span><span class="sxs-lookup"><span data-stu-id="cccec-158">PrintDialog</span></span>  
 <span data-ttu-id="cccec-159">El control <xref:System.Windows.Controls.PrintDialog?displayProperty=nameWithType> proporciona un único punto de entrada para el envío de [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], configuración y trabajo XPS.</span><span class="sxs-lookup"><span data-stu-id="cccec-159">The <xref:System.Windows.Controls.PrintDialog?displayProperty=nameWithType> control provides a single entry point for [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], configuration, and XPS job submission.</span></span> <span data-ttu-id="cccec-160">Para obtener información sobre la creación de instancias y el uso del control, consulte [Invocar un cuadro de diálogo de impresión](how-to-invoke-a-print-dialog.md).</span><span class="sxs-lookup"><span data-stu-id="cccec-160">For information about how to instantiate and use the control, see [Invoke a Print Dialog](how-to-invoke-a-print-dialog.md).</span></span>  
  
### <a name="advanced-xps-printing"></a><span data-ttu-id="cccec-161">Impresión XPS avanzada</span><span class="sxs-lookup"><span data-stu-id="cccec-161">Advanced XPS Printing</span></span>  
 <span data-ttu-id="cccec-162">Para tener acceso al conjunto completo de características de XPS, se debe usar la API de impresión avanzada.</span><span class="sxs-lookup"><span data-stu-id="cccec-162">To access the complete set of XPS features, the advanced print API must be used.</span></span> <span data-ttu-id="cccec-163">A continuación se describen con más detalle varias API pertinentes.</span><span class="sxs-lookup"><span data-stu-id="cccec-163">Several relevant API are described in greater detail below.</span></span> <span data-ttu-id="cccec-164">Para obtener una lista completa de las API de ruta de impresión XPS, consulte las referencias de espacio de nombres <xref:System.Windows.Xps> y <xref:System.Printing>.</span><span class="sxs-lookup"><span data-stu-id="cccec-164">For a complete list of XPS print path APIs, see the <xref:System.Windows.Xps> and <xref:System.Printing> namespace references.</span></span>  
  
#### <a name="printticket-and-printcapabilities"></a><span data-ttu-id="cccec-165">PrintTicket y PrintCapabilities</span><span class="sxs-lookup"><span data-stu-id="cccec-165">PrintTicket and PrintCapabilities</span></span>  
 <span data-ttu-id="cccec-166">Las clases <xref:System.Printing.PrintTicket> y <xref:System.Printing.PrintCapabilities> son la base de las características avanzadas de XPS.</span><span class="sxs-lookup"><span data-stu-id="cccec-166">The <xref:System.Printing.PrintTicket> and <xref:System.Printing.PrintCapabilities> classes are the foundation of the advanced XPS features.</span></span> <span data-ttu-id="cccec-167">Ambos tipos de objetos son estructuras con formato XML de características orientadas a la impresión, como intercalación, impresión a dos caras, grapado, etc. Estas estructuras se definen mediante el esquema de impresión.</span><span class="sxs-lookup"><span data-stu-id="cccec-167">Both types of objects are XML formatted structures of print-oriented features such as collation, two-sided printing, stapling, etc. These structures are defined by the print schema.</span></span> <span data-ttu-id="cccec-168">Un <xref:System.Printing.PrintTicket> indica a una impresora cómo procesar un trabajo de impresión.</span><span class="sxs-lookup"><span data-stu-id="cccec-168">A <xref:System.Printing.PrintTicket> instructs a printer how to process a print job.</span></span> <span data-ttu-id="cccec-169">La clase <xref:System.Printing.PrintCapabilities> define las capacidades de una impresora.</span><span class="sxs-lookup"><span data-stu-id="cccec-169">The <xref:System.Printing.PrintCapabilities> class defines the capabilities of a printer.</span></span> <span data-ttu-id="cccec-170">Mediante una consulta de las capacidades de una impresora, se puede crear un <xref:System.Printing.PrintTicket> que aproveche al máximo las características compatibles de una impresora.</span><span class="sxs-lookup"><span data-stu-id="cccec-170">By querying the capabilities of a printer, a <xref:System.Printing.PrintTicket> can be created that takes full advantage of a printer's supported features.</span></span> <span data-ttu-id="cccec-171">De forma similar, se pueden evitar las características no compatibles.</span><span class="sxs-lookup"><span data-stu-id="cccec-171">Similarly, unsupported features can be avoided.</span></span>  
  
 <span data-ttu-id="cccec-172">En el ejemplo siguiente se muestra cómo consultar las <xref:System.Printing.PrintCapabilities> de una impresora y crear un <xref:System.Printing.PrintTicket> mediante código.</span><span class="sxs-lookup"><span data-stu-id="cccec-172">The following example demonstrates how to query the <xref:System.Printing.PrintCapabilities> of a printer and create a <xref:System.Printing.PrintTicket> using code.</span></span>  
  
 [!code-cpp[xpscreate#PrinterCapabilities](~/samples/snippets/cpp/VS_Snippets_Wpf/XpsCreate/CPP/XpsCreate.cpp#printercapabilities)]
 [!code-csharp[xpscreate#PrinterCapabilities](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsCreate/CSharp/XpsCreate.cs#printercapabilities)]
 [!code-vb[xpscreate#PrinterCapabilities](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsCreate/visualbasic/xpscreate.vb#printercapabilities)]  
  
#### <a name="printserver-and-printqueue"></a><span data-ttu-id="cccec-173">PrintServer y PrintQueue</span><span class="sxs-lookup"><span data-stu-id="cccec-173">PrintServer and PrintQueue</span></span>  
 <span data-ttu-id="cccec-174">La clase <xref:System.Printing.PrintServer> representa un servidor de impresión de red y la clase <xref:System.Printing.PrintQueue> representa una impresora y la cola de trabajos de salida asociados a él.</span><span class="sxs-lookup"><span data-stu-id="cccec-174">The <xref:System.Printing.PrintServer> class represents a network print server and the <xref:System.Printing.PrintQueue> class represents a printer and the output job queue associated with it.</span></span> <span data-ttu-id="cccec-175">Juntas, estas API permiten la administración avanzada de los trabajos de impresión de un servidor.</span><span class="sxs-lookup"><span data-stu-id="cccec-175">Together, these APIs allow advanced management of a server's print jobs.</span></span> <span data-ttu-id="cccec-176">Un <xref:System.Printing.PrintServer>, o una de sus clases derivadas, se usa para administrar un <xref:System.Printing.PrintQueue>.</span><span class="sxs-lookup"><span data-stu-id="cccec-176">A <xref:System.Printing.PrintServer>, or one of its derived classes, is used to manage a <xref:System.Printing.PrintQueue>.</span></span> <span data-ttu-id="cccec-177">El método <xref:System.Printing.PrintQueue.AddJob%2A> se usa para insertar un nuevo trabajo de impresión en la cola.</span><span class="sxs-lookup"><span data-stu-id="cccec-177">The <xref:System.Printing.PrintQueue.AddJob%2A> method is used to insert a new print job into the queue.</span></span>  
  
 <span data-ttu-id="cccec-178">En el ejemplo siguiente se muestra cómo crear un <xref:System.Printing.LocalPrintServer> y tener acceso a su <xref:System.Printing.PrintQueue> predeterminado mediante código.</span><span class="sxs-lookup"><span data-stu-id="cccec-178">The following example demonstrates how to create a <xref:System.Printing.LocalPrintServer> and access its default <xref:System.Printing.PrintQueue> by using code.</span></span>  
  
 [!code-csharp[xpsprint#PrintQueueSnip](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)]
 [!code-vb[xpsprint#PrintQueueSnip](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)]  
  
#### <a name="xpsdocumentwriter"></a><span data-ttu-id="cccec-179">XpsDocumentWriter</span><span class="sxs-lookup"><span data-stu-id="cccec-179">XpsDocumentWriter</span></span>  
 <span data-ttu-id="cccec-180">Un <xref:System.Windows.Xps.XpsDocumentWriter>, con sus diversos métodos <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> y <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A>, se usa para escribir documentos XPS en un <xref:System.Printing.PrintQueue>.</span><span class="sxs-lookup"><span data-stu-id="cccec-180">An <xref:System.Windows.Xps.XpsDocumentWriter>, with its many the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods, is used to write XPS documents to a <xref:System.Printing.PrintQueue>.</span></span> <span data-ttu-id="cccec-181">Por ejemplo, el método <xref:System.Windows.Xps.XpsDocumentWriter.Write%28System.Windows.Documents.FixedPage%2CSystem.Printing.PrintTicket%29> se usa para generar un documento XPS y <xref:System.Printing.PrintTicket> de forma sincrónica.</span><span class="sxs-lookup"><span data-stu-id="cccec-181">For example, the <xref:System.Windows.Xps.XpsDocumentWriter.Write%28System.Windows.Documents.FixedPage%2CSystem.Printing.PrintTicket%29> method is used to output an XPS document and <xref:System.Printing.PrintTicket> synchronously.</span></span> <span data-ttu-id="cccec-182">El método <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%28System.Windows.Documents.FixedDocument%2CSystem.Printing.PrintTicket%29> se usa para generar un documento XPS y <xref:System.Printing.PrintTicket> de forma asincrónica.</span><span class="sxs-lookup"><span data-stu-id="cccec-182">The <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%28System.Windows.Documents.FixedDocument%2CSystem.Printing.PrintTicket%29> method is used to output an XPS document and <xref:System.Printing.PrintTicket> asynchronously.</span></span>  
  
 <span data-ttu-id="cccec-183">En el siguiente ejemplo se muestra cómo crear un <xref:System.Windows.Xps.XpsDocumentWriter> mediante código.</span><span class="sxs-lookup"><span data-stu-id="cccec-183">The following example demonstrates how to create an <xref:System.Windows.Xps.XpsDocumentWriter> using code.</span></span>  
  
 [!code-csharp[XpsPrint#PrintQueueSnip](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)]
 [!code-vb[XpsPrint#PrintQueueSnip](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)]  
  
 <span data-ttu-id="cccec-184">Los métodos <xref:System.Printing.PrintQueue.AddJob%2A> también proporcionan formas de imprimir.</span><span class="sxs-lookup"><span data-stu-id="cccec-184">The <xref:System.Printing.PrintQueue.AddJob%2A> methods also provide ways to print.</span></span> <span data-ttu-id="cccec-185">Consulte [Imprimir archivos XPS mediante programación](how-to-programmatically-print-xps-files.md).</span><span class="sxs-lookup"><span data-stu-id="cccec-185">See [Programmatically Print XPS Files](how-to-programmatically-print-xps-files.md).</span></span> <span data-ttu-id="cccec-186">para obtener información detallada.</span><span class="sxs-lookup"><span data-stu-id="cccec-186">for details.</span></span>  
  
<a name="GDI_Print_Path_intro"></a>   
## <a name="gdi-print-path"></a><span data-ttu-id="cccec-187">Ruta de impresión GDI</span><span class="sxs-lookup"><span data-stu-id="cccec-187">GDI Print Path</span></span>  
 <span data-ttu-id="cccec-188">Aunque las aplicaciones de WPF admiten de forma nativa la ruta de impresión de XPS, las aplicaciones [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] y Windows Forms también pueden aprovechar algunas características de XPS.</span><span class="sxs-lookup"><span data-stu-id="cccec-188">While WPF applications natively support the XPS print path, [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and Windows Forms applications can also take advantage of some XPS features.</span></span> <span data-ttu-id="cccec-189">El controlador de impresora XPS (XPSDrv) puede convertir la salida basada en GDI al formato XPS.</span><span class="sxs-lookup"><span data-stu-id="cccec-189">The XPS printer driver (XPSDrv) can convert GDI based output to XPS format.</span></span> <span data-ttu-id="cccec-190">En escenarios avanzados, se admite la conversión personalizada de contenido mediante el [convertidor de documentos XPS de Microsoft (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-).</span><span class="sxs-lookup"><span data-stu-id="cccec-190">For advanced scenarios, custom conversion of content is supported using the [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-).</span></span> <span data-ttu-id="cccec-191">Del mismo modo, las aplicaciones WPF también pueden generar resultados en la ruta de impresión GDI llamando a uno de los métodos <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> o <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> de la clase <xref:System.Windows.Xps.XpsDocumentWriter> y designando una impresora que no sea XpsDrv como cola de impresión de destino.</span><span class="sxs-lookup"><span data-stu-id="cccec-191">Similarly, WPF applications can also output to the GDI print path by calling one of the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> or <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter> class and designating a non-XpsDrv printer as the target print queue.</span></span>  

<span data-ttu-id="cccec-192">En el caso de las aplicaciones que no requieren funcionalidad o soporte XPS, la ruta de impresión GDI actual permanece sin cambios.</span><span class="sxs-lookup"><span data-stu-id="cccec-192">For applications that do not require XPS functionality or support, the current GDI print path remains unchanged.</span></span>  
  
- <span data-ttu-id="cccec-193">Para obtener material de referencia adicional sobre la ruta de impresión GDI y las distintas opciones de conversión de XPS, consulte [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-) y [controladores de impresora XPSDrv](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span><span class="sxs-lookup"><span data-stu-id="cccec-193">For additional reference material on the GDI print path and the various XPS conversion options, see [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-) and [XPSDrv Printer Drivers](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span></span>  
  
<a name="XPS_Driver_Model_intro"></a>   
## <a name="xpsdrv-driver-model"></a><span data-ttu-id="cccec-194">Modelo de controlador XPSDrv</span><span class="sxs-lookup"><span data-stu-id="cccec-194">XPSDrv Driver Model</span></span>  
 <span data-ttu-id="cccec-195">La ruta de impresión XPS mejora la eficacia del administrador de trabajos de impresión mediante el uso de XPS como formato nativo de la cola de impresión cuando se imprime en una impresora o un controlador habilitado para XPS.</span><span class="sxs-lookup"><span data-stu-id="cccec-195">The XPS print path improves spooler efficiency by using XPS as the native print spool format when printing to an XPS -enabled printer or driver.</span></span> <span data-ttu-id="cccec-196">El proceso de puesta en cola simplificado elimina la necesidad de generar un archivo de cola intermedio, como un archivo de datos EMF, antes de que se pongan en cola el documento.</span><span class="sxs-lookup"><span data-stu-id="cccec-196">The simplified spooling process eliminates the need to generate an intermediate spool file, such as an EMF data file, before the document is spooled.</span></span> <span data-ttu-id="cccec-197">A través de tamaños de archivo de cola más pequeños, la ruta de impresión XPS puede reducir el tráfico de red y mejorar el rendimiento de impresión.</span><span class="sxs-lookup"><span data-stu-id="cccec-197">Through smaller spool file sizes, the XPS print path can reduce network traffic and improve print performance.</span></span>  
  
 <span data-ttu-id="cccec-198">EMF es un formato cerrado que representa la salida de la aplicación como una serie de llamadas a GDI para los servicios de representación.</span><span class="sxs-lookup"><span data-stu-id="cccec-198">EMF is a closed format that represents application output as a series of calls into GDI for rendering services.</span></span> <span data-ttu-id="cccec-199">A diferencia de EMF, el formato de cola XPS representa el documento real sin necesidad de una mayor interpretación cuando se envía a un controlador de impresora basado en XPS (XPSDrv).</span><span class="sxs-lookup"><span data-stu-id="cccec-199">Unlike EMF, the XPS spool format represents the actual document without requiring further interpretation when output to an XPS-based printer driver (XPSDrv).</span></span> <span data-ttu-id="cccec-200">Los controladores pueden trabajar directamente con los datos en el formato.</span><span class="sxs-lookup"><span data-stu-id="cccec-200">The drivers can operate directly on the data in the format.</span></span> <span data-ttu-id="cccec-201">Esta capacidad elimina las conversiones de espacio de color y datos que son necesarias cuando se usan archivos EMF y controladores de impresión basados en GDI.</span><span class="sxs-lookup"><span data-stu-id="cccec-201">This capability eliminates the data and color space conversions required when you use EMF files and GDI-based print drivers.</span></span>  
  
 <span data-ttu-id="cccec-202">Los tamaños de los archivos de cola de impresión suelen reducirse cuando se usan documentos XPS que tienen como destino un controlador de impresora XPS (XPSDrv) en comparación con sus equivalentes EMF; sin embargo, hay excepciones:</span><span class="sxs-lookup"><span data-stu-id="cccec-202">Spool file sizes are usually reduced when you use XPS Documents that target an XPS printer driver (XPSDrv) compared with their EMF equivalents; however, there are exceptions:</span></span>  
  
- <span data-ttu-id="cccec-203">Un gráfico vectorial muy complejo, con varias capas o escrito de forma ineficaz puede ser mayor que una versión de mapa de bits del mismo gráfico.</span><span class="sxs-lookup"><span data-stu-id="cccec-203">A vector graphic that is very complex, multi-layered, or inefficiently written can be larger than a bitmapped version of the same graphic.</span></span>  
  
- <span data-ttu-id="cccec-204">Para la presentación en pantalla, los archivos XPS insertan fuentes del dispositivo y del equipo, mientras que los archivos de cola de impresión GDI no insertan fuentes de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="cccec-204">For screen display purposes, XPS files embed device fonts as well as computer-based fonts; whereas GDI spool files do not embed device fonts.</span></span> <span data-ttu-id="cccec-205">Sin embargo, ambos tipos de fuentes se incluyen en un subconjunto (ver abajo) y los controladores de impresora pueden quitar las fuentes de dispositivo antes de transmitir el archivo a la impresora.</span><span class="sxs-lookup"><span data-stu-id="cccec-205">But both kinds of fonts are subsetted (see below) and printer drivers can remove the device fonts before transmitting the file to the printer.</span></span>  
  
 <span data-ttu-id="cccec-206">La reducción del tamaño de cola de impresión se consigue a través de varios mecanismos:</span><span class="sxs-lookup"><span data-stu-id="cccec-206">Spool size reduction is performed through several mechanisms:</span></span>  
  
- <span data-ttu-id="cccec-207">**Creación de un subconjunto de fuentes**.</span><span class="sxs-lookup"><span data-stu-id="cccec-207">**Font subsetting**.</span></span> <span data-ttu-id="cccec-208">Solo los caracteres usados en el documento real se almacenan en el archivo XPS.</span><span class="sxs-lookup"><span data-stu-id="cccec-208">Only characters used within the actual document are stored in the XPS file.</span></span>  
  
- <span data-ttu-id="cccec-209">**Compatibilidad con gráficos avanzados**.</span><span class="sxs-lookup"><span data-stu-id="cccec-209">**Advanced Graphics Support**.</span></span> <span data-ttu-id="cccec-210">La compatibilidad nativa con la transparencia y las primitivas de degradado evita la rasterización del contenido en el documento XPS.</span><span class="sxs-lookup"><span data-stu-id="cccec-210">Native support for transparency and gradient primitives avoids rasterization of content in the XPS Document.</span></span>  
  
- <span data-ttu-id="cccec-211">**Identificación de recursos comunes**.</span><span class="sxs-lookup"><span data-stu-id="cccec-211">**Identification of common resources**.</span></span> <span data-ttu-id="cccec-212">Los recursos que se usan varias veces (como una imagen que representa un logotipo corporativo) se tratan como recursos compartidos y se cargan solamente una vez.</span><span class="sxs-lookup"><span data-stu-id="cccec-212">Resources that are used multiple times (such as an image that represents a corporate logo) are treated as shared resources and are loaded only once.</span></span>  
  
- <span data-ttu-id="cccec-213">**Compresión ZIP**.</span><span class="sxs-lookup"><span data-stu-id="cccec-213">**ZIP compression**.</span></span> <span data-ttu-id="cccec-214">Todos los documentos XPS usan la compresión ZIP.</span><span class="sxs-lookup"><span data-stu-id="cccec-214">All XPS documents use ZIP compression.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="cccec-215">Vea también</span><span class="sxs-lookup"><span data-stu-id="cccec-215">See also</span></span>

- <xref:System.Windows.Controls.PrintDialog>
- <xref:System.Windows.Xps.XpsDocumentWriter>
- <xref:System.Windows.Xps.Packaging.XpsDocument>
- <xref:System.Printing.PrintTicket>
- <xref:System.Printing.PrintCapabilities>
- <xref:System.Printing.PrintServer>
- <xref:System.Printing.PrintQueue>
- [<span data-ttu-id="cccec-216">Temas "Cómo..."</span><span class="sxs-lookup"><span data-stu-id="cccec-216">How-to Topics</span></span>](printing-how-to-topics.md)
- [<span data-ttu-id="cccec-217">Documentos en WPF</span><span class="sxs-lookup"><span data-stu-id="cccec-217">Documents in WPF</span></span>](documents-in-wpf.md)
- [<span data-ttu-id="cccec-218">Documentos XPS</span><span class="sxs-lookup"><span data-stu-id="cccec-218">XPS Documents</span></span>](/windows/desktop/printdocs/documents)
- [<span data-ttu-id="cccec-219">Almacenamiento y serialización de documentos</span><span class="sxs-lookup"><span data-stu-id="cccec-219">Document Serialization and Storage</span></span>](document-serialization-and-storage.md)
- [<span data-ttu-id="cccec-220">Convertidor de documentos XPS de Microsoft (MXDC)</span><span class="sxs-lookup"><span data-stu-id="cccec-220">Microsoft XPS Document Converter (MXDC)</span></span>](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-)
