---
title: gRPC
description: Obtenga información sobre gRPC, su rol en aplicaciones nativas de la nube y cómo difiere de la comunicación HTTP RESTful.
author: robvet
ms.date: 03/31/2020
ms.openlocfilehash: 28a07ad5ec105d3fc5b65e4cf0ac0cd85eb16627
ms.sourcegitcommit: 79b0dd8bfc63f33a02137121dd23475887ecefda
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/01/2020
ms.locfileid: "80524212"
---
# <a name="grpc"></a><span data-ttu-id="dd448-103">gRPC</span><span class="sxs-lookup"><span data-stu-id="dd448-103">gRPC</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="dd448-104">Hasta ahora en este libro, nos hemos centrado en la comunicación [basada en REST.](https://docs.microsoft.com/azure/architecture/best-practices/api-design)</span><span class="sxs-lookup"><span data-stu-id="dd448-104">So far in this book, we've focused on [REST-based](https://docs.microsoft.com/azure/architecture/best-practices/api-design) communication.</span></span> <span data-ttu-id="dd448-105">Hemos visto que REST es un estilo arquitectónico flexible que define las operaciones basadas en CRUD con los recursos de entidad.</span><span class="sxs-lookup"><span data-stu-id="dd448-105">We've seen that REST is a flexible architectural style that defines CRUD-based operations against entity resources.</span></span> <span data-ttu-id="dd448-106">Los clientes interactúan con los recursos a través de HTTP con un modelo de comunicación de solicitud/respuesta.</span><span class="sxs-lookup"><span data-stu-id="dd448-106">Clients interact with resources across HTTP with a request/response communication model.</span></span> <span data-ttu-id="dd448-107">Aunque REST está ampliamente implementado, una tecnología de comunicación más reciente, gRPC, ha ganado un gran impulso en toda la comunidad nativa de la nube.</span><span class="sxs-lookup"><span data-stu-id="dd448-107">While REST is widely implemented, a newer communication technology, gRPC, has gained tremendous momentum across the cloud-native community.</span></span>

## <a name="what-is-grpc"></a><span data-ttu-id="dd448-108">¿Qué es gRPC?</span><span class="sxs-lookup"><span data-stu-id="dd448-108">What is gRPC?</span></span>

<span data-ttu-id="dd448-109">gRPC es un marco moderno de alto rendimiento que evoluciona el antiguo protocolo de llamada a [procedimiento remoto (RPC).](https://en.wikipedia.org/wiki/Remote_procedure_call)</span><span class="sxs-lookup"><span data-stu-id="dd448-109">gRPC is a modern, high-performance framework that evolves the age-old [remote procedure call (RPC)](https://en.wikipedia.org/wiki/Remote_procedure_call) protocol.</span></span> <span data-ttu-id="dd448-110">En el nivel de aplicación, gRPC optimiza la mensajería entre clientes y servicios back-end.</span><span class="sxs-lookup"><span data-stu-id="dd448-110">At the application level, gRPC streamlines messaging between clients and back-end services.</span></span> <span data-ttu-id="dd448-111">Originario de Google, gRPC es de código abierto y forma parte del ecosistema de Cloud [Native Computing Foundation (CNCF)](https://www.cncf.io/) de ofertas nativas de la nube.</span><span class="sxs-lookup"><span data-stu-id="dd448-111">Originating from Google, gRPC is open source and part of the  [Cloud Native Computing Foundation (CNCF)](https://www.cncf.io/) ecosystem of cloud-native offerings.</span></span> <span data-ttu-id="dd448-112">CNCF considera gRPC un proyecto de [incubación.](https://github.com/cncf/toc/blob/master/process/graduation_criteria.adoc)</span><span class="sxs-lookup"><span data-stu-id="dd448-112">CNCF considers gRPC an [incubating project](https://github.com/cncf/toc/blob/master/process/graduation_criteria.adoc).</span></span> <span data-ttu-id="dd448-113">Incubar significa que los usuarios finales están utilizando la tecnología en aplicaciones de producción, y el proyecto tiene un número saludable de contribuyentes.</span><span class="sxs-lookup"><span data-stu-id="dd448-113">Incubating means end users are using the technology in production applications, and the project has a healthy number of contributors.</span></span>

<span data-ttu-id="dd448-114">Una aplicación cliente gRPC típica expondrá una función local en proceso que implementa una operación empresarial.</span><span class="sxs-lookup"><span data-stu-id="dd448-114">A typical gRPC client app will expose a local, in-process function that implements a business operation.</span></span> <span data-ttu-id="dd448-115">Debajo de las cubiertas, esa función local invoca otra función en un equipo remoto.</span><span class="sxs-lookup"><span data-stu-id="dd448-115">Under the covers, that local function invokes another function on a remote machine.</span></span> <span data-ttu-id="dd448-116">Lo que parece ser una llamada local se convierte esencialmente en una llamada transparente fuera de proceso a un servicio remoto.</span><span class="sxs-lookup"><span data-stu-id="dd448-116">What appears to be a local call essentially becomes a transparent out-of-process call to a remote service.</span></span> <span data-ttu-id="dd448-117">La plomería RPC abstrae la comunicación de red punto a punto, la serialización y la ejecución entre equipos.</span><span class="sxs-lookup"><span data-stu-id="dd448-117">The RPC plumbing abstracts the point-to-point networking communication, serialization, and execution between computers.</span></span>

<span data-ttu-id="dd448-118">En las aplicaciones nativas de la nube, los desarrolladores a menudo trabajan en lenguajes de programación, marcos y tecnologías.</span><span class="sxs-lookup"><span data-stu-id="dd448-118">In cloud-native applications, developers often work across programming languages, frameworks, and technologies.</span></span> <span data-ttu-id="dd448-119">Esta *interoperabilidad* complica los contratos de mensajes y la fontanería necesaria para la comunicación multiplataforma.</span><span class="sxs-lookup"><span data-stu-id="dd448-119">This *interoperability* complicates message contracts and the plumbing required for cross-platform communication.</span></span>  <span data-ttu-id="dd448-120">gRPC proporciona una "capa horizontal uniforme" que abstrae estas preocupaciones.</span><span class="sxs-lookup"><span data-stu-id="dd448-120">gRPC provides a "uniform horizontal layer" that abstracts these concerns.</span></span> <span data-ttu-id="dd448-121">Los desarrolladores codifican en su plataforma nativa centrada en la funcionalidad empresarial, mientras que gRPC se encarga de las tuberías de comunicación.</span><span class="sxs-lookup"><span data-stu-id="dd448-121">Developers code in their native platform focused on business functionality, while gRPC handles communication plumbing.</span></span>

<span data-ttu-id="dd448-122">gRPC ofrece soporte integral en las pilas de desarrollo más populares, incluyendo Java, JavaScript, C, Go, Swift y NodeJS.</span><span class="sxs-lookup"><span data-stu-id="dd448-122">gRPC offers comprehensive support across most popular development stacks, including Java, JavaScript, C#, Go, Swift, and NodeJS.</span></span>

## <a name="grpc-benefits"></a><span data-ttu-id="dd448-123">Beneficios de gRPC</span><span class="sxs-lookup"><span data-stu-id="dd448-123">gRPC Benefits</span></span>

<span data-ttu-id="dd448-124">gRPC utiliza HTTP/2 para su protocolo de transporte.</span><span class="sxs-lookup"><span data-stu-id="dd448-124">gRPC uses HTTP/2 for its transport protocol.</span></span> <span data-ttu-id="dd448-125">Aunque es compatible con HTTP 1.1, HTTP/2 cuenta con muchas capacidades avanzadas:</span><span class="sxs-lookup"><span data-stu-id="dd448-125">While compatible with HTTP 1.1, HTTP/2 features many advanced capabilities:</span></span>

- <span data-ttu-id="dd448-126">Un protocolo binario para el transporte de datos, a diferencia de HTTP 1.1, que envía datos como texto no cifrado.</span><span class="sxs-lookup"><span data-stu-id="dd448-126">A binary protocol for data transport - unlike HTTP 1.1, which sends data as clear text.</span></span>
- <span data-ttu-id="dd448-127">Compatibilidad con multiplexación para enviar varias solicitudes paralelas a través de la misma conexión: HTTP 1.1 limita el procesamiento a un mensaje de solicitud/respuesta a la vez.</span><span class="sxs-lookup"><span data-stu-id="dd448-127">Multiplexing support for sending multiple parallel requests over the same connection - HTTP 1.1 limits processing to one request/response message at a time.</span></span>
- <span data-ttu-id="dd448-128">Comunicación bidireccional dúplex completo para enviar solicitudes de cliente y respuestas de servidor simultáneamente.</span><span class="sxs-lookup"><span data-stu-id="dd448-128">Bidirectional full-duplex communication for sending both client requests and server responses simultaneously.</span></span>
- <span data-ttu-id="dd448-129">El streaming integrado permite solicitudes y respuestas para transmitir de forma asincrónica grandes conjuntos de datos.</span><span class="sxs-lookup"><span data-stu-id="dd448-129">Built-in streaming enabling requests and responses to asynchronously stream large data sets.</span></span>

<span data-ttu-id="dd448-130">gRPC es ligero y altamente rendimiento.</span><span class="sxs-lookup"><span data-stu-id="dd448-130">gRPC is lightweight and highly performant.</span></span> <span data-ttu-id="dd448-131">Puede ser hasta 8 veces más rápido que la serialización JSON con mensajes 60-80% más pequeños.</span><span class="sxs-lookup"><span data-stu-id="dd448-131">It can be up to 8x faster than JSON serialization with messages 60-80% smaller.</span></span> <span data-ttu-id="dd448-132">En el lenguaje de Microsoft [Windows Communication Foundation (WCF),](https://docs.microsoft.com/dotnet/framework/wcf/whats-wcf) el rendimiento de gRPC supera la velocidad y la eficiencia de los [enlaces NetTCP altamente optimizados.](https://docs.microsoft.com/dotnet/api/system.servicemodel.nettcpbinding?view=netframework-4.8)</span><span class="sxs-lookup"><span data-stu-id="dd448-132">In Microsoft [Windows Communication Foundation (WCF)](https://docs.microsoft.com/dotnet/framework/wcf/whats-wcf) parlance, gRPC performance exceeds the speed and efficiency of the highly optimized [NetTCP bindings](https://docs.microsoft.com/dotnet/api/system.servicemodel.nettcpbinding?view=netframework-4.8).</span></span> <span data-ttu-id="dd448-133">A diferencia de NetTCP, que favorece la pila de Microsoft, gRPC es multiplataforma.</span><span class="sxs-lookup"><span data-stu-id="dd448-133">Unlike NetTCP, which favors the Microsoft stack, gRPC is cross-platform.</span></span>

## <a name="protocol-buffers"></a><span data-ttu-id="dd448-134">Búferes de protocolo</span><span class="sxs-lookup"><span data-stu-id="dd448-134">Protocol Buffers</span></span>

<span data-ttu-id="dd448-135">gRPC adopta una tecnología de código abierto llamada [Protocol Buffers](https://developers.google.com/protocol-buffers/docs/overview).</span><span class="sxs-lookup"><span data-stu-id="dd448-135">gRPC embraces an open-source technology called [Protocol Buffers](https://developers.google.com/protocol-buffers/docs/overview).</span></span> <span data-ttu-id="dd448-136">Proporcionan un formato de serialización altamente eficiente y neutral para la plataforma para serializar mensajes estructurados que los servicios se envían entre sí.</span><span class="sxs-lookup"><span data-stu-id="dd448-136">They provide a highly efficient and platform-neutral serialization format for serializing structured messages that services send to each other.</span></span> <span data-ttu-id="dd448-137">Mediante un lenguaje de definición de interfaz (IDL) multiplataforma, los desarrolladores definen un contrato de servicio para cada microservicio.</span><span class="sxs-lookup"><span data-stu-id="dd448-137">Using a cross-platform Interface Definition Language (IDL), developers define a service contract for each microservice.</span></span> <span data-ttu-id="dd448-138">El contrato, implementado como un `.proto` archivo basado en texto, describe los métodos, entradas y salidas para cada servicio.</span><span class="sxs-lookup"><span data-stu-id="dd448-138">The contract, implemented as a text-based `.proto` file, describes the methods, inputs, and outputs for each service.</span></span> <span data-ttu-id="dd448-139">El mismo archivo de contrato se puede utilizar para clientes y servicios gRPC basados en diferentes plataformas de desarrollo.</span><span class="sxs-lookup"><span data-stu-id="dd448-139">The same contract file can be used for gRPC clients and services built on different development platforms.</span></span>

<span data-ttu-id="dd448-140">Mediante el archivo proto, el `protoc`compilador Protobuf, , genera código de cliente y de servicio para la plataforma de destino.</span><span class="sxs-lookup"><span data-stu-id="dd448-140">Using the proto file, the Protobuf compiler, `protoc`, generates both client and service code for your target platform.</span></span> <span data-ttu-id="dd448-141">El código incluye los siguientes componentes:</span><span class="sxs-lookup"><span data-stu-id="dd448-141">The code includes the following components:</span></span>

- <span data-ttu-id="dd448-142">Objetos fuertemente tipados, compartidos por el cliente y el servicio, que representan las operaciones de servicio y los elementos de datos de un mensaje.</span><span class="sxs-lookup"><span data-stu-id="dd448-142">Strongly-typed objects, shared by the client and service, that represent the service operations and data elements for a message.</span></span>
- <span data-ttu-id="dd448-143">Una clase base fuertemente tipada con la tubería de red necesaria que el servicio gRPC remoto puede heredar y extender.</span><span class="sxs-lookup"><span data-stu-id="dd448-143">A strongly-typed base class with the required network plumbing that the remote gRPC service can inherit and extend.</span></span>
- <span data-ttu-id="dd448-144">Un código auxiliar de cliente que contiene la fontanería necesaria para invocar el servicio gRPC remoto.</span><span class="sxs-lookup"><span data-stu-id="dd448-144">A client stub that contains the required plumbing to invoke the remote gRPC service.</span></span>

<span data-ttu-id="dd448-145">En tiempo de ejecución, cada mensaje se serializa como una representación Protobuf estándar e intercambia entre el cliente y el servicio remoto.</span><span class="sxs-lookup"><span data-stu-id="dd448-145">At runtime, each message is serialized as a standard Protobuf representation and exchanged between the client and remote service.</span></span> <span data-ttu-id="dd448-146">A diferencia de JSON o XML, los mensajes Protobuf se serializan como bytes binarios compilados.</span><span class="sxs-lookup"><span data-stu-id="dd448-146">Unlike JSON or XML, Protobuf messages are serialized as compiled binary bytes.</span></span>

<span data-ttu-id="dd448-147">El libro, [gRPC para desarrolladores de WCF,](https://docs.microsoft.com/dotnet/architecture/grpc-for-wcf-developers/)disponible en el sitio de arquitectura de Microsoft, proporciona una cobertura detallada de gRPC y búferes de protocolo.</span><span class="sxs-lookup"><span data-stu-id="dd448-147">The book, [gRPC for WCF Developers](https://docs.microsoft.com/dotnet/architecture/grpc-for-wcf-developers/), available from the Microsoft Architecture site, provides in-depth coverage of gRPC and Protocol Buffers.</span></span>

## <a name="grpc-support-in-net"></a><span data-ttu-id="dd448-148">Compatibilidad con gRPC en .NET</span><span class="sxs-lookup"><span data-stu-id="dd448-148">gRPC support in .NET</span></span>

<span data-ttu-id="dd448-149">gRPC está integrado en el SDK de .NET Core 3.0 o posterior.</span><span class="sxs-lookup"><span data-stu-id="dd448-149">gRPC is integrated into .NET Core 3.0 SDK or later.</span></span> <span data-ttu-id="dd448-150">Las siguientes herramientas lo admiten:</span><span class="sxs-lookup"><span data-stu-id="dd448-150">The following tools support it:</span></span>

- <span data-ttu-id="dd448-151">Visual Studio 2019, versión 16.3 o posterior, con la carga de trabajo de desarrollo web instalada.</span><span class="sxs-lookup"><span data-stu-id="dd448-151">Visual Studio 2019, version 16.3 or later, with the web development workload installed.</span></span>
- <span data-ttu-id="dd448-152">Visual Studio Code</span><span class="sxs-lookup"><span data-stu-id="dd448-152">Visual Studio Code</span></span>
- <span data-ttu-id="dd448-153">el DOTnet CLI</span><span class="sxs-lookup"><span data-stu-id="dd448-153">the dotnet CLI</span></span>

<span data-ttu-id="dd448-154">El SDK incluye herramientas para el enrutamiento de puntos de conexión, IoC integrado y registro.</span><span class="sxs-lookup"><span data-stu-id="dd448-154">The SDK includes tooling for endpoint routing, built-in IoC, and logging.</span></span> <span data-ttu-id="dd448-155">El servidor web Kestrel de código abierto admite conexiones HTTP/2.</span><span class="sxs-lookup"><span data-stu-id="dd448-155">The open-source Kestrel web server supports HTTP/2 connections.</span></span> <span data-ttu-id="dd448-156">En la figura 4-20 se muestra una plantilla de Visual Studio 2019 que aplica scaffolding a un proyecto de esqueleto para un servicio gRPC.</span><span class="sxs-lookup"><span data-stu-id="dd448-156">Figure 4-20 shows a Visual Studio 2019 template that scaffolds a skeleton project for a gRPC service.</span></span> <span data-ttu-id="dd448-157">Observe cómo .NET Core es totalmente compatible con Windows, Linux y macOS.</span><span class="sxs-lookup"><span data-stu-id="dd448-157">Note how .NET Core fully supports Windows, Linux, and macOS.</span></span>

![Compatibilidad con gRPC en Visual Studio 2019](./media/visual-studio-2019-grpc-template.png)

<span data-ttu-id="dd448-159">**Figura 4-20**.</span><span class="sxs-lookup"><span data-stu-id="dd448-159">**Figure 4-20**.</span></span> <span data-ttu-id="dd448-160">Compatibilidad con gRPC en Visual Studio 2019</span><span class="sxs-lookup"><span data-stu-id="dd448-160">gRPC support in Visual Studio 2019</span></span>
  
<span data-ttu-id="dd448-161">En la figura 4-21 se muestra el servicio gRPC de esqueleto generado a partir del andamiaje integrado incluido en Visual Studio 2019.</span><span class="sxs-lookup"><span data-stu-id="dd448-161">Figure 4-21 shows the skeleton gRPC service generated from the built-in scaffolding included in Visual Studio 2019.</span></span>  

![proyecto gRPC en Visual Studio 2019](./media/grpc-project.png  )

<span data-ttu-id="dd448-163">**Figura 4-21**.</span><span class="sxs-lookup"><span data-stu-id="dd448-163">**Figure 4-21**.</span></span> <span data-ttu-id="dd448-164">proyecto gRPC en Visual Studio 2019</span><span class="sxs-lookup"><span data-stu-id="dd448-164">gRPC project in Visual Studio 2019</span></span>

<span data-ttu-id="dd448-165">En la figura anterior, tenga en cuenta el archivo de descripción proto y el código de servicio.</span><span class="sxs-lookup"><span data-stu-id="dd448-165">In the previous figure, note the proto description file and service code.</span></span> <span data-ttu-id="dd448-166">Como verá en breve, Visual Studio genera una configuración adicional tanto en la clase Startup como en el archivo de proyecto subyacente.</span><span class="sxs-lookup"><span data-stu-id="dd448-166">As you'll see shortly, Visual Studio generates additional configuration in both the Startup class and underlying project file.</span></span>

## <a name="grpc-usage"></a><span data-ttu-id="dd448-167">uso de gRPC</span><span class="sxs-lookup"><span data-stu-id="dd448-167">gRPC usage</span></span>

<span data-ttu-id="dd448-168">Favorecer gRPC para los siguientes escenarios:</span><span class="sxs-lookup"><span data-stu-id="dd448-168">Favor gRPC for the following scenarios:</span></span>

- <span data-ttu-id="dd448-169">Comunicación sincrónica de microservicio a microservicio de back-end donde se requiere una respuesta inmediata para continuar el procesamiento.</span><span class="sxs-lookup"><span data-stu-id="dd448-169">Synchronous backend microservice-to-microservice communication where an immediate response is required to continue processing.</span></span>
- <span data-ttu-id="dd448-170">Entornos políglotas que necesitan admitir plataformas de programación mixtas.</span><span class="sxs-lookup"><span data-stu-id="dd448-170">Polyglot environments that need to support mixed programming platforms.</span></span>
- <span data-ttu-id="dd448-171">Baja latencia y comunicación de alto rendimiento donde el rendimiento es crítico.</span><span class="sxs-lookup"><span data-stu-id="dd448-171">Low latency and high throughput communication where performance is critical.</span></span>
- <span data-ttu-id="dd448-172">Comunicación punto a punto en tiempo real: gRPC puede enviar mensajes en tiempo real sin sondeo y tiene un excelente soporte para streaming bidireccional.</span><span class="sxs-lookup"><span data-stu-id="dd448-172">Point-to-point real-time communication - gRPC can push messages in real time without polling and has excellent support for bi-directional streaming.</span></span>
- <span data-ttu-id="dd448-173">Entornos restringidos en red: los mensajes gRPC binarios siempre son más pequeños que un mensaje JSON basado en texto equivalente.</span><span class="sxs-lookup"><span data-stu-id="dd448-173">Network constrained environments – binary gRPC messages are always smaller than an equivalent text-based JSON message.</span></span>

<span data-ttu-id="dd448-174">En ese momento, de esta escritura, gRPC se utiliza principalmente con servicios back-end.</span><span class="sxs-lookup"><span data-stu-id="dd448-174">At the time, of this writing, gRPC is primarily used with backend services.</span></span> <span data-ttu-id="dd448-175">La mayoría de los navegadores modernos no pueden proporcionar el nivel de control HTTP/2 necesario para admitir un cliente gRPC front-end.</span><span class="sxs-lookup"><span data-stu-id="dd448-175">Most modern browsers can't provide the level of HTTP/2 control required to support a front-end gRPC client.</span></span> <span data-ttu-id="dd448-176">Dicho esto, hay una [iniciativa temprana](https://devblogs.microsoft.com/aspnet/grpc-web-experiment/) que permite la comunicación gRPC desde aplicaciones basadas en navegador creadas con tecnologías JavaScript o Blazor WebAssembly.</span><span class="sxs-lookup"><span data-stu-id="dd448-176">That said, there's an [early initiative](https://devblogs.microsoft.com/aspnet/grpc-web-experiment/) that enables gRPC communication from browser-based apps built with JavaScript or Blazor WebAssembly technologies.</span></span> <span data-ttu-id="dd448-177">[GRPC-Web para .NET](https://github.com/grpc/grpc/blob/master/doc/PROTOCOL-WEB.md) permite que una aplicación gRPC de ASP.NET Core admita las características de gRPC en las aplicaciones del explorador:</span><span class="sxs-lookup"><span data-stu-id="dd448-177">The  [gRPC-Web for .NET](https://github.com/grpc/grpc/blob/master/doc/PROTOCOL-WEB.md) enables an ASP.NET Core gRPC app to support gRPC features in browser apps:</span></span>

- <span data-ttu-id="dd448-178">Clientes generados por código fuertemente tipados</span><span class="sxs-lookup"><span data-stu-id="dd448-178">Strongly-typed code-generated clients</span></span>
- <span data-ttu-id="dd448-179">Mensajes compactos de Protobuf</span><span class="sxs-lookup"><span data-stu-id="dd448-179">Compact Protobuf messages</span></span>
- <span data-ttu-id="dd448-180">Transmisión de servidores</span><span class="sxs-lookup"><span data-stu-id="dd448-180">Server streaming</span></span>

## <a name="grpc-implementation"></a><span data-ttu-id="dd448-181">implementación de gRPC</span><span class="sxs-lookup"><span data-stu-id="dd448-181">gRPC implementation</span></span>

<span data-ttu-id="dd448-182">La arquitectura de referencia de microservicios, [eShop on Containers](https://github.com/dotnet-architecture/eShopOnContainers), de Microsoft, muestra cómo implementar servicios gRPC en aplicaciones de .NET Core.</span><span class="sxs-lookup"><span data-stu-id="dd448-182">The microservice reference architecture, [eShop on Containers](https://github.com/dotnet-architecture/eShopOnContainers), from Microsoft, shows how to implement gRPC services in .NET Core applications.</span></span> <span data-ttu-id="dd448-183">La Figura 4-22 presenta la arquitectura de back-end.</span><span class="sxs-lookup"><span data-stu-id="dd448-183">Figure 4-22 presents the back-end architecture.</span></span>

![Arquitectura de back-end para eShop en contenedores](./media/eshop-with-aggregators.png)

<span data-ttu-id="dd448-185">**Figura 4-22**.</span><span class="sxs-lookup"><span data-stu-id="dd448-185">**Figure 4-22**.</span></span> <span data-ttu-id="dd448-186">Arquitectura de back-end para eShop en contenedores</span><span class="sxs-lookup"><span data-stu-id="dd448-186">Backend architecture for eShop on Containers</span></span>

<span data-ttu-id="dd448-187">En la figura anterior, observe cómo eShop adopta el [patrón backend for Frontends](https://docs.microsoft.com/azure/architecture/patterns/backends-for-frontends) (BFF) exponiendo varias puertas de enlace de API.</span><span class="sxs-lookup"><span data-stu-id="dd448-187">In the previous figure, note how eShop embraces the [Backend for Frontends pattern](https://docs.microsoft.com/azure/architecture/patterns/backends-for-frontends) (BFF) by exposing multiple API gateways.</span></span> <span data-ttu-id="dd448-188">Hemos discutido el patrón BFF anteriormente en este capítulo.</span><span class="sxs-lookup"><span data-stu-id="dd448-188">We discussed the BFF pattern earlier in this chapter.</span></span> <span data-ttu-id="dd448-189">Preste mucha atención al microservicio de Agregador (en gris) que se encuentra entre la puerta de enlace de API de Web-Shopping y los microservicios de Shopping de back-end.</span><span class="sxs-lookup"><span data-stu-id="dd448-189">Pay close attention to the Aggregator microservice (in gray) that sits between the Web-Shopping API Gateway and backend Shopping microservices.</span></span> <span data-ttu-id="dd448-190">El agregador recibe una única solicitud de un cliente, la distribuye a varios microservicios, agrega los resultados y los devuelve al cliente solicitante.</span><span class="sxs-lookup"><span data-stu-id="dd448-190">The Aggregator receives a single request from a client, dispatches it to various microservices, aggregates the results, and sends them back to the requesting client.</span></span> <span data-ttu-id="dd448-191">Estas operaciones normalmente requieren comunicación sincrónica para producir una respuesta inmediata.</span><span class="sxs-lookup"><span data-stu-id="dd448-191">Such operations typically require synchronous communication as to produce an immediate response.</span></span> <span data-ttu-id="dd448-192">En eShop, las llamadas de back-end desde el agregador se realizan mediante gRPC como se muestra en la figura 4-23.</span><span class="sxs-lookup"><span data-stu-id="dd448-192">In eShop, backend calls from the Aggregator are performed using gRPC as shown in Figure 4-23.</span></span>

![gRPC en eShop en contenedores](./media/grpc-implementation.png)

<span data-ttu-id="dd448-194">**Figura 4-23**.</span><span class="sxs-lookup"><span data-stu-id="dd448-194">**Figure 4-23**.</span></span> <span data-ttu-id="dd448-195">gRPC en eShop en contenedores</span><span class="sxs-lookup"><span data-stu-id="dd448-195">gRPC in eShop on Containers</span></span>

<span data-ttu-id="dd448-196">La comunicación gRPC requiere componentes de cliente y servidor.</span><span class="sxs-lookup"><span data-stu-id="dd448-196">gRPC communication requires both client and server components.</span></span> <span data-ttu-id="dd448-197">En la figura anterior, observe cómo el agregador de compras implementa un cliente gRPC.</span><span class="sxs-lookup"><span data-stu-id="dd448-197">In the previous figure, note how the Shopping Aggregator implements a gRPC client.</span></span> <span data-ttu-id="dd448-198">El cliente realiza llamadas gRPC sincrónicas (en rojo) a microservicios de back-end, cada uno de los cuales implementa un servidor gRPC.</span><span class="sxs-lookup"><span data-stu-id="dd448-198">The client makes synchronous gRPC calls (in red) to backend microservices, each of which implement a gRPC server.</span></span> <span data-ttu-id="dd448-199">Tanto el cliente como el servidor aprovechan la plomería gRPC integrada desde el SDK de .NET Core 3.0.</span><span class="sxs-lookup"><span data-stu-id="dd448-199">Both the client and server take advantage of the built-in gRPC plumbing from the .NET Core 3.0 SDK.</span></span> <span data-ttu-id="dd448-200">Los *stubs* del lado cliente proporcionan la plomería para invocar llamadas gRPC remotas.</span><span class="sxs-lookup"><span data-stu-id="dd448-200">Client-side *stubs* provide the plumbing to invoke remote gRPC calls.</span></span> <span data-ttu-id="dd448-201">Los componentes del lado del servidor proporcionan la plomería gRPC que las clases de servicio personalizadas pueden heredar y consumir.</span><span class="sxs-lookup"><span data-stu-id="dd448-201">Server-side components provide gRPC plumbing that custom service classes can inherit and consume.</span></span>

<span data-ttu-id="dd448-202">Los microservicios que exponen una API RESTful y una comunicación gRPC requieren varios puntos de conexión para administrar el tráfico.</span><span class="sxs-lookup"><span data-stu-id="dd448-202">Microservices that expose both a RESTful API and gRPC communication require multiple endpoints to manage traffic.</span></span> <span data-ttu-id="dd448-203">Abriría un punto de conexión que escuche el tráfico HTTP para las llamadas RESTful y otro para las llamadas gRPC.</span><span class="sxs-lookup"><span data-stu-id="dd448-203">You would open an endpoint that listens for HTTP traffic for the RESTful calls and another for gRPC calls.</span></span> <span data-ttu-id="dd448-204">El punto final gRPC se debe configurar para el protocolo HTTP/2 que se requiere para la comunicación gRPC.</span><span class="sxs-lookup"><span data-stu-id="dd448-204">The gRPC endpoint must be configured for the HTTP/2 protocol that is required for gRPC communication.</span></span>

<span data-ttu-id="dd448-205">Aunque nos esforzamos por desacoplar microservicios con patrones de comunicación asincrónicos, algunas operaciones requieren llamadas directas.</span><span class="sxs-lookup"><span data-stu-id="dd448-205">While we strive to decouple microservices with asynchronous communication patterns, some operations require direct calls.</span></span> <span data-ttu-id="dd448-206">gRPC debe ser la opción principal para la comunicación sincrónica directa entre microservicios.</span><span class="sxs-lookup"><span data-stu-id="dd448-206">gRPC should be the primary choice for direct synchronous communication between microservices.</span></span> <span data-ttu-id="dd448-207">Su protocolo de comunicación de alto rendimiento, basado en HTTP/2 y búferes de protocolo, lo convierten en una opción perfecta.</span><span class="sxs-lookup"><span data-stu-id="dd448-207">Its high-performance communication protocol, based on HTTP/2 and protocol buffers, make it a perfect choice.</span></span>

## <a name="looking-ahead"></a><span data-ttu-id="dd448-208">Mirando hacia el futuro</span><span class="sxs-lookup"><span data-stu-id="dd448-208">Looking ahead</span></span>

<span data-ttu-id="dd448-209">De cara al futuro, gRPC seguirá ganando tracción para los sistemas nativos de la nube.</span><span class="sxs-lookup"><span data-stu-id="dd448-209">Looking ahead, gRPC will continue to gain traction for cloud-native systems.</span></span> <span data-ttu-id="dd448-210">Los beneficios de rendimiento y la facilidad de desarrollo son convincentes.</span><span class="sxs-lookup"><span data-stu-id="dd448-210">The performance benefits and ease of development are compelling.</span></span> <span data-ttu-id="dd448-211">Sin embargo, es probable que REST esté por aquí durante mucho tiempo.</span><span class="sxs-lookup"><span data-stu-id="dd448-211">However, REST will likely be around for a long time.</span></span> <span data-ttu-id="dd448-212">Se destaca por las API expuestas públicamente y por razones de compatibilidad con versiones anteriores.</span><span class="sxs-lookup"><span data-stu-id="dd448-212">It excels for publicly exposed APIs and for backward compatibility reasons.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="dd448-213">[Anterior](service-to-service-communication.md)
>[Siguiente](service-mesh-communication-infrastructure.md)</span><span class="sxs-lookup"><span data-stu-id="dd448-213">[Previous](service-to-service-communication.md)
[Next](service-mesh-communication-infrastructure.md)</span></span>
