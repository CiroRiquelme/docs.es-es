---
title: Directiva de protección extendida
ms.date: 03/30/2017
ms.assetid: e2616a10-317e-4c34-8023-0c015a80a82f
ms.openlocfilehash: 3a5b1c7f296c68d407f0217963dec56f53e9a08a
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/12/2020
ms.locfileid: "79144727"
---
# <a name="extended-protection-policy"></a><span data-ttu-id="79c77-102">Directiva de protección extendida</span><span class="sxs-lookup"><span data-stu-id="79c77-102">Extended Protection Policy</span></span>
<span data-ttu-id="79c77-103">Protección extendida es una iniciativa de seguridad para protegerse contra los ataques de tipo "Man in the middle" (MITM).</span><span class="sxs-lookup"><span data-stu-id="79c77-103">Extended Protection is a security initiative for protecting against man-in-the-middle (MITM) attacks.</span></span> <span data-ttu-id="79c77-104">Un ataque MITM es una amenaza de seguridad en la que MITM toma las credenciales de un cliente y lo reenvía a un servidor.</span><span class="sxs-lookup"><span data-stu-id="79c77-104">A MITM attack is a security threat in which a MITM takes a client’s credentials and forwards it to a server.</span></span>  
  
## <a name="demonstrates"></a><span data-ttu-id="79c77-105">Muestra</span><span class="sxs-lookup"><span data-stu-id="79c77-105">Demonstrates</span></span>  
 <span data-ttu-id="79c77-106">Protección extendida</span><span class="sxs-lookup"><span data-stu-id="79c77-106">Extended protection</span></span>  
  
## <a name="discussion"></a><span data-ttu-id="79c77-107">Discusión</span><span class="sxs-lookup"><span data-stu-id="79c77-107">Discussion</span></span>  
 <span data-ttu-id="79c77-108">Cuando las aplicaciones cliente se autentican mediante Kerberos, Digest o NTLM usando HTTPS, se establece en primer lugar un canal de Seguridad de nivel de transporte (TLS) y después la autenticación se lleva a cabo usando el canal seguro.</span><span class="sxs-lookup"><span data-stu-id="79c77-108">When applications authenticate using Kerberos, Digest or NTLM using HTTPS, a Transport Level Security (TLS) channel is first established and then authentication takes place using the secure channel.</span></span> <span data-ttu-id="79c77-109">Sin embargo, no hay ningún enlace entre la clave de sesión generada por SSL y la clave de sesión generada durante la autenticación.</span><span class="sxs-lookup"><span data-stu-id="79c77-109">However, there is no binding between the session key generated by SSL and the session key generated during authentication.</span></span> <span data-ttu-id="79c77-110">MITM se puede establecer entre el cliente y el servidor, y comienza a reenviar las solicitudes del cliente, incluso cuando el propio canal de transporte es seguro, porque el servidor no tiene ninguna manera de saber si el canal seguro se ha establecido desde el cliente o desde un MITM.</span><span class="sxs-lookup"><span data-stu-id="79c77-110">Any MITM can establish itself between the client and the server and start forwarding the requests from the client, even when the transport channel itself is secure, because the server has no way of knowing whether the secure channel has been established from the client or a MITM.</span></span> <span data-ttu-id="79c77-111">La solución en este escenario es enlazar el canal de TLS externo con el canal de autenticación interno de modo que el servidor puede detectar si hay un MITM.</span><span class="sxs-lookup"><span data-stu-id="79c77-111">The solution in this scenario is to bind the outer TLS channel with the inner authentication channel such that the server can detect if there is a MITM.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="79c77-112">Este ejemplo solo funciona cuando se hospeda en IIS y no puede trabajar en Cassini. El servidor de desarrollo de Visual Studio porque Cassini no admite HTTPS.</span><span class="sxs-lookup"><span data-stu-id="79c77-112">This sample only works when hosted on IIS and cannot work on Cassini – Visual Studio Development Server because Cassini does not support HTTPS.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="79c77-113">Esta característica solo está disponible actualmente en Windows 7.</span><span class="sxs-lookup"><span data-stu-id="79c77-113">This feature is currently only available on Windows 7.</span></span> <span data-ttu-id="79c77-114">Los siguientes pasos son específicos de Windows 7.</span><span class="sxs-lookup"><span data-stu-id="79c77-114">The following steps are specific to Windows 7.</span></span>  
  
#### <a name="to-set-up-build-and-run-the-sample"></a><span data-ttu-id="79c77-115">Configurar, compilar y ejecutar el ejemplo</span><span class="sxs-lookup"><span data-stu-id="79c77-115">To set up, build, and run the sample</span></span>  
  
1. <span data-ttu-id="79c77-116">Instalar Internet Information Services desde panel de **control**, **Agregar o quitar programas**, Características de **Windows**.</span><span class="sxs-lookup"><span data-stu-id="79c77-116">Install Internet Information Services from **Control Panel**, **Add/Remove Programs**, **Windows Features**.</span></span>  
  
2. <span data-ttu-id="79c77-117">Instale **la autenticación** de Windows en Características de **Windows,** Servicios de Internet Information **Server,** **Servicios World Wide Web,** **Seguridad**y Autenticación **de Windows.**</span><span class="sxs-lookup"><span data-stu-id="79c77-117">Install **Windows Authentication** in **Windows Features**, **Internet Information Services**, **World Wide Web Services**, **Security**, and **Windows Authentication**.</span></span>  
  
3. <span data-ttu-id="79c77-118">Instale **la activación HTTP** de Windows Communication Foundation en Características de **Windows**, **Microsoft .NET Framework 3.5.1**y **Activación HTTP**de Windows Communication Foundation .</span><span class="sxs-lookup"><span data-stu-id="79c77-118">Install **Windows Communication Foundation HTTP Activation** in **Windows Features**, **Microsoft .NET Framework 3.5.1**, and **Windows Communication Foundation HTTP Activation**.</span></span>  
  
4. <span data-ttu-id="79c77-119">Este ejemplo requiere que el cliente establezca un canal seguro con el servidor, por lo que es necesaria la presencia de un certificado de servidor que se puede instalar desde el Administrador de Internet Information Services (IIS).</span><span class="sxs-lookup"><span data-stu-id="79c77-119">This sample requires the client to establish a secure channel with the server, so it requires the presence of a server certificate which can be installed from Internet Information Services (IIS) Manager.</span></span>  
  
    1. <span data-ttu-id="79c77-120">Abra Administrador de IIS.</span><span class="sxs-lookup"><span data-stu-id="79c77-120">Open IIS Manager.</span></span> <span data-ttu-id="79c77-121">Abra **Certificados de servidor,** que aparece en la pestaña **Vista** de características cuando se selecciona el nodo raíz (nombre del equipo).</span><span class="sxs-lookup"><span data-stu-id="79c77-121">Open **Server certificates**, which appears in the **Feature View** tab when the root node (machine name) is selected.</span></span>  
  
    2. <span data-ttu-id="79c77-122">Para las pruebas de este ejemplo, puede crear un certificado autofirmado.</span><span class="sxs-lookup"><span data-stu-id="79c77-122">For the purpose of testing this sample, create a self-signed certificate.</span></span> <span data-ttu-id="79c77-123">Si no desea que Internet Explorer le indique que el certificado no es seguro, instálelo en el almacén Entidades emisoras de certificados raíz de confianza.</span><span class="sxs-lookup"><span data-stu-id="79c77-123">If you do not want Internet Explorer to prompt you about the certificate not being secure, install the certificate in the Trusted Certificate Root authority store.</span></span>  
  
5. <span data-ttu-id="79c77-124">Abra el panel **Acciones** del sitio Web predeterminado.</span><span class="sxs-lookup"><span data-stu-id="79c77-124">Open the **Actions** pane for the default Web site.</span></span> <span data-ttu-id="79c77-125">Haga clic en **Editar sitio**, **Enlaces**.</span><span class="sxs-lookup"><span data-stu-id="79c77-125">Click **Edit Site**, **Bindings**.</span></span> <span data-ttu-id="79c77-126">Agregue HTTPS como un tipo si no está presente, con el número de puerto 443.</span><span class="sxs-lookup"><span data-stu-id="79c77-126">Add HTTPS as a type if not already present, with port number 443.</span></span> <span data-ttu-id="79c77-127">Asigne el certificado SSL creado en el paso anterior.</span><span class="sxs-lookup"><span data-stu-id="79c77-127">Assign the SSL certificate created in the preceding step.</span></span>  
  
6. <span data-ttu-id="79c77-128">Compile el servicio.</span><span class="sxs-lookup"><span data-stu-id="79c77-128">Build the service.</span></span> <span data-ttu-id="79c77-129">De esta forma se crea un directorio virtual en IIS y se copian los archivos .dll, .svc y .config, tal y como se requiere para que el servicio se hospede en web.</span><span class="sxs-lookup"><span data-stu-id="79c77-129">This creates a virtual directory in IIS, and copies the .dll, .svc and .config files as required for the service to be Web hosted.</span></span>  
  
7. <span data-ttu-id="79c77-130">Abra Administrador de IIS.</span><span class="sxs-lookup"><span data-stu-id="79c77-130">Open IIS Manager.</span></span> <span data-ttu-id="79c77-131">Haga clic con el botón derecho en el directorio virtual (**ExtendedProtection**), que se creó en el paso anterior.</span><span class="sxs-lookup"><span data-stu-id="79c77-131">Right-click the virtual directory (**ExtendedProtection**), which was created in the preceding step.</span></span> <span data-ttu-id="79c77-132">Seleccione **Convertir en aplicación**.</span><span class="sxs-lookup"><span data-stu-id="79c77-132">Select **Convert to Application**.</span></span>  
  
8. <span data-ttu-id="79c77-133">Abra el módulo **Autenticación** en el Administrador de IIS para este directorio virtual y habilite **Autenticación de Windows**.</span><span class="sxs-lookup"><span data-stu-id="79c77-133">Open the **Authentication** module in IIS Manager for this virtual directory and enable **Windows Authentication**.</span></span>  
  
9. <span data-ttu-id="79c77-134">Abra **Configuración avanzada** en Autenticación de **Windows** para este directorio virtual y establézquelo en **Requerido**.</span><span class="sxs-lookup"><span data-stu-id="79c77-134">Open **Advanced Settings** under **Windows Authentication** for this virtual directory and set it to **Required**.</span></span>  
  
10. <span data-ttu-id="79c77-135">Puede probar el servicio teniendo acceso a la dirección URL HTTPS de una ventana del explorador (proporcione un nombre de dominio completo).</span><span class="sxs-lookup"><span data-stu-id="79c77-135">You can test the service by accessing the HTTPS URL from a browser window (Provide a fully-qualified domain name).</span></span> <span data-ttu-id="79c77-136">Si desea tener acceso a esta dirección URL desde un equipo remoto, asegúrese de que el firewall está abierto para todas las conexiones HTTP y HTTPS entrantes.</span><span class="sxs-lookup"><span data-stu-id="79c77-136">If you want to access this URL from a remote machine, make sure that the firewall is opened for all incoming HTTP and HTTPS connections.</span></span>  
  
11. <span data-ttu-id="79c77-137">Abra el archivo de configuración del cliente y proporcione un nombre de dominio completo para el cliente o el atributo de dirección de punto de conexión que reemplace a `<<full_machine_name>>`.</span><span class="sxs-lookup"><span data-stu-id="79c77-137">Open the client configuration file and provide a fully-qualified domain name for the client or endpoint address attribute that replaces `<<full_machine_name>>`.</span></span>  
  
12. <span data-ttu-id="79c77-138">Ejecute el cliente.</span><span class="sxs-lookup"><span data-stu-id="79c77-138">Run the client.</span></span> <span data-ttu-id="79c77-139">El cliente se comunica con el servicio, que establece un canal seguro y utiliza la protección extendida.</span><span class="sxs-lookup"><span data-stu-id="79c77-139">The client communicates with the service, which establishes a secure channel and uses extended protection.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="79c77-140">Puede que los ejemplos ya estén instalados en su equipo.</span><span class="sxs-lookup"><span data-stu-id="79c77-140">The samples may already be installed on your machine.</span></span> <span data-ttu-id="79c77-141">Compruebe el siguiente directorio (predeterminado) antes de continuar.</span><span class="sxs-lookup"><span data-stu-id="79c77-141">Check for the following (default) directory before continuing.</span></span>  
>
> `<InstallDrive>:\WF_WCF_Samples`  
>
> <span data-ttu-id="79c77-142">Si este directorio no existe, vaya a Ejemplos de [Windows Communication Foundation (WCF) y Windows Workflow Foundation (WF) para .NET Framework 4](https://www.microsoft.com/download/details.aspx?id=21459) para descargar todos los ejemplos y [!INCLUDE[wf1](../../../../includes/wf1-md.md)] Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="79c77-142">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://www.microsoft.com/download/details.aspx?id=21459) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="79c77-143">Este ejemplo se encuentra en el siguiente directorio.</span><span class="sxs-lookup"><span data-stu-id="79c77-143">This sample is located in the following directory.</span></span>  
>
> `<InstallDrive>:\WF_WCF_Samples\WCF\Basic\Services\Security\ExtendedProtection`
