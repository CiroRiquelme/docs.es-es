---
title: Información general sobre el modelo de texto de UI Automation
ms.date: 03/30/2017
helpviewer_keywords:
- UI Automation, TextPattern class
- TextPattern class
- classes, TextPattern
ms.assetid: 41787927-df1f-4f4a-aba3-641662854fc4
ms.openlocfilehash: 22966c8ed80be99497e7d05b56455c3057fdd81a
ms.sourcegitcommit: 9a97c76e141333394676bc5d264c6624b6f45bcf
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2020
ms.locfileid: "75741419"
---
# <a name="ui-automation-textpattern-overview"></a><span data-ttu-id="61e8b-102">Información general sobre el modelo de texto de UI Automation</span><span class="sxs-lookup"><span data-stu-id="61e8b-102">UI Automation TextPattern Overview</span></span>

> [!NOTE]
> <span data-ttu-id="61e8b-103">Esta documentación está dirigida a los desarrolladores de .NET Framework que quieran usar las clases [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] administradas definidas en el espacio de nombres <xref:System.Windows.Automation>.</span><span class="sxs-lookup"><span data-stu-id="61e8b-103">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="61e8b-104">Para ver la información más reciente acerca de [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], consulte [Windows Automation API: automatización de la interfaz de usuario](/windows/win32/winauto/entry-uiauto-win32).</span><span class="sxs-lookup"><span data-stu-id="61e8b-104">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span></span>

<span data-ttu-id="61e8b-105">Esta información general describe cómo usar [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] para exponer el contenido textual, incluidos los atributos de estilo y formato, de los controles de texto en plataformas compatibles con [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)].</span><span class="sxs-lookup"><span data-stu-id="61e8b-105">This overview describes how to use [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] to expose the textual content, including format and style attributes, of text controls in [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]-supported platforms.</span></span> <span data-ttu-id="61e8b-106">Estos controles incluyen, entre otros, el marco de Microsoft .NET <xref:System.Windows.Controls.TextBox> y <xref:System.Windows.Controls.RichTextBox>, así como sus equivalentes de Win32.</span><span class="sxs-lookup"><span data-stu-id="61e8b-106">These controls include, but are not limited to, the Microsoft .NET Framework <xref:System.Windows.Controls.TextBox> and <xref:System.Windows.Controls.RichTextBox> as well as their Win32 equivalents.</span></span>

<span data-ttu-id="61e8b-107">Exponer el contenido textual de un control se logra mediante el uso del patrón de control <xref:System.Windows.Automation.TextPattern> , que representa el contenido de un contenedor de texto como una secuencia de texto.</span><span class="sxs-lookup"><span data-stu-id="61e8b-107">Exposing the textual content of a control is accomplished through the use of the <xref:System.Windows.Automation.TextPattern> control pattern, which represents the contents of a text container as a text stream.</span></span> <span data-ttu-id="61e8b-108">A su vez, <xref:System.Windows.Automation.TextPattern> requiere el soporte de la clase <xref:System.Windows.Automation.Text.TextPatternRange> para exponer atributos de formato y estilo.</span><span class="sxs-lookup"><span data-stu-id="61e8b-108">In turn, <xref:System.Windows.Automation.TextPattern> requires the support of the <xref:System.Windows.Automation.Text.TextPatternRange> class to expose format and style attributes.</span></span> <span data-ttu-id="61e8b-109"><xref:System.Windows.Automation.Text.TextPatternRange> da soporte a <xref:System.Windows.Automation.TextPattern> mediante la representación de intervalos de texto contiguos, múltiples o no contiguos en un contenedor de texto con una colección de extremos <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.Start> y <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.End> .</span><span class="sxs-lookup"><span data-stu-id="61e8b-109"><xref:System.Windows.Automation.Text.TextPatternRange> supports <xref:System.Windows.Automation.TextPattern> by representing contiguous or multiple, disjoint text spans in a text container with a collection of <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.Start> and <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.End> endpoints.</span></span> <span data-ttu-id="61e8b-110"><xref:System.Windows.Automation.Text.TextPatternRange> admite la funcionalidad como selección, comparación, recuperación y exploración transversal.</span><span class="sxs-lookup"><span data-stu-id="61e8b-110"><xref:System.Windows.Automation.Text.TextPatternRange> supports functionality such as selection, comparison, retrieval and traversal.</span></span>

> [!NOTE]
> <span data-ttu-id="61e8b-111">Las clase <xref:System.Windows.Automation.TextPattern> no proporcionan un medio para insertar o modificar texto.</span><span class="sxs-lookup"><span data-stu-id="61e8b-111">The <xref:System.Windows.Automation.TextPattern> classes do not provide a means to insert or modify text.</span></span> <span data-ttu-id="61e8b-112">Sin embargo, dependiendo del control, esto puede realizarse mediante el [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <xref:System.Windows.Automation.ValuePattern> o a través de la entrada de teclado directa.</span><span class="sxs-lookup"><span data-stu-id="61e8b-112">However, depending on the control, this may be accomplished by the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <xref:System.Windows.Automation.ValuePattern> or through direct keyboard input.</span></span> <span data-ttu-id="61e8b-113">Vea [TextPattern Insert Text Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/InsertText) para obtener un ejemplo.</span><span class="sxs-lookup"><span data-stu-id="61e8b-113">See the [TextPattern Insert Text Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/InsertText) for an example.</span></span>

<span data-ttu-id="61e8b-114">La funcionalidad descrita en este artículo es vital para los proveedores de tecnología de asistencia y sus usuarios finales.</span><span class="sxs-lookup"><span data-stu-id="61e8b-114">The functionality described in this overview is vital to assistive technology vendors and their end users.</span></span> <span data-ttu-id="61e8b-115">Las tecnologías de asistencia pueden usar [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] para recopilar información de formato de texto para el usuario y proporcionar navegación y selección de texto mediante programación por <xref:System.Windows.Automation.Text.TextUnit> (carácter, palabra, línea o párrafo).</span><span class="sxs-lookup"><span data-stu-id="61e8b-115">Assistive technologies can use [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] to gather complete text formatting information for the user and provide programmatic navigation and selection of text by <xref:System.Windows.Automation.Text.TextUnit> (character, word, line, or paragraph).</span></span>

<a name="UI_Automation_TextPattern_vs__Cicero"></a>

## <a name="ui-automation-textpattern-vs-text-services-framework"></a><span data-ttu-id="61e8b-116">TextPattern de automatización de la interfaz de usuario versus Text Services Framework (TSF)</span><span class="sxs-lookup"><span data-stu-id="61e8b-116">UI Automation TextPattern vs. Text Services Framework</span></span>

<span data-ttu-id="61e8b-117">Text Services Framework (TSF) es un marco de trabajo del sistema simple y escalable que habilita los servicios de lenguaje natural y la entrada de texto avanzada en el escritorio y en las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="61e8b-117">Text Services Framework (TSF) is a simple and scalable system framework that enables natural language services and advanced text input on the desktop and within applications.</span></span> <span data-ttu-id="61e8b-118">Además de proporcionar interfaces para aplicaciones para exponer su almacén de texto, también admite metadatos para ese almacén de texto.</span><span class="sxs-lookup"><span data-stu-id="61e8b-118">In addition to providing interfaces for applications to expose their text store it also supports metadata for that text store.</span></span>

<span data-ttu-id="61e8b-119">Sin embargo, TSF se diseñó para aplicaciones que necesitan insertar entradas en escenarios de contexto, mientras que <xref:System.Windows.Automation.TextPattern> es una solución de solo lectura (con la solución limitada indicada anteriormente) diseñada para proporcionar acceso optimizado a un almacén de texto para los lectores de pantalla y los dispositivos Braille.</span><span class="sxs-lookup"><span data-stu-id="61e8b-119">However, TSF was designed for applications that need to inject input into context-aware scenarios whereas <xref:System.Windows.Automation.TextPattern> is a read-only solution (with the limited workaround noted above) meant to provide optimized access to a text store for screen-readers and Braille devices.</span></span>

<span data-ttu-id="61e8b-120">En Resumen, las tecnologías accesibles que requieren acceso de solo lectura a un almacén de texto pueden usar <xref:System.Windows.Automation.TextPattern>, pero necesitarán la funcionalidad más compleja de TSF para la entrada compatible con el contexto.</span><span class="sxs-lookup"><span data-stu-id="61e8b-120">In short, accessible technologies that require read-only access to a text store can use <xref:System.Windows.Automation.TextPattern>, but will need the more complex functionality of TSF for context-aware input.</span></span>

<a name="Control_Types"></a>

## <a name="control-types"></a><span data-ttu-id="61e8b-121">Tipos de controles</span><span class="sxs-lookup"><span data-stu-id="61e8b-121">Control Types</span></span>

### <a name="text"></a><span data-ttu-id="61e8b-122">Text</span><span class="sxs-lookup"><span data-stu-id="61e8b-122">Text</span></span>

<span data-ttu-id="61e8b-123">El control de texto (Text) es el elemento básico que representa un fragmento de texto en la pantalla.</span><span class="sxs-lookup"><span data-stu-id="61e8b-123">The Text control is the basic element representing a piece of text on the screen.</span></span>

<span data-ttu-id="61e8b-124">Un control de texto independiente puede usarse como una etiqueta o texto estático en un formulario.</span><span class="sxs-lookup"><span data-stu-id="61e8b-124">A standalone text control can be used as a label or static text on a form.</span></span> <span data-ttu-id="61e8b-125">Los controles de texto también pueden estar dentro de la estructura de un <xref:System.Windows.Automation.ControlType.ListItem>, <xref:System.Windows.Automation.ControlType.TreeItem> o <xref:System.Windows.Automation.ControlType.DataItem>.</span><span class="sxs-lookup"><span data-stu-id="61e8b-125">Text controls can also be contained within the structure of a <xref:System.Windows.Automation.ControlType.ListItem>, <xref:System.Windows.Automation.ControlType.TreeItem> or <xref:System.Windows.Automation.ControlType.DataItem>.</span></span>

> [!NOTE]
> <span data-ttu-id="61e8b-126">Es posible que los controles de texto no aparezcan en la vista de contenido del árbol de [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] (consulte [UI Automation Tree Overview](ui-automation-tree-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="61e8b-126">Text controls might not appear in the content view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree (see [UI Automation Tree Overview](ui-automation-tree-overview.md)).</span></span> <span data-ttu-id="61e8b-127">Esto se debe a que los controles de texto se muestran a menudo a través de la propiedad Name de otro control.</span><span class="sxs-lookup"><span data-stu-id="61e8b-127">This is because text controls are often displayed through the Name property of another control.</span></span> <span data-ttu-id="61e8b-128">Por ejemplo, el texto que se usa para etiquetar un control de edición (Edit) se expone a través de la propiedad Name del control de edición.</span><span class="sxs-lookup"><span data-stu-id="61e8b-128">For instance, the text that is used to label an Edit control is exposed through the Name property of the Edit control.</span></span> <span data-ttu-id="61e8b-129">Dado que el control de edición que se encuentra en la vista de contenido del árbol de [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] , no es necesario que el elemento de texto esté en esa vista del árbol de [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="61e8b-129">Because the Edit control is in the content view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree, it is not necessary for the text element itself to be in that view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree.</span></span> <span data-ttu-id="61e8b-130">El único texto que se muestra en la vista de contenido es el texto que no es información redundante.</span><span class="sxs-lookup"><span data-stu-id="61e8b-130">The only text that shows up in the content view is text that is not redundant information.</span></span> <span data-ttu-id="61e8b-131">Esto permite a las tecnologías de asistencia filtrar rápidamente solo los fragmentos de información que necesitan los usuarios.</span><span class="sxs-lookup"><span data-stu-id="61e8b-131">This enables any assistive technology to quickly filter only on the pieces of information that their users need.</span></span>

### <a name="edit"></a><span data-ttu-id="61e8b-132">Edit</span><span class="sxs-lookup"><span data-stu-id="61e8b-132">Edit</span></span>

<span data-ttu-id="61e8b-133">Los controles de edición (Edit) permiten al usuario ver y editar una sola línea de texto.</span><span class="sxs-lookup"><span data-stu-id="61e8b-133">Edit controls enable a user to view and edit a single line of text.</span></span>

> [!NOTE]
> <span data-ttu-id="61e8b-134">La única línea de texto puede encapsularse en ciertos escenarios de diseño.</span><span class="sxs-lookup"><span data-stu-id="61e8b-134">The single line of text may wrap in certain layout scenarios.</span></span>

### <a name="document"></a><span data-ttu-id="61e8b-135">Documento</span><span class="sxs-lookup"><span data-stu-id="61e8b-135">Document</span></span>

<span data-ttu-id="61e8b-136">Los controles de documento permiten a un usuario navegar y obtener información de varias páginas de texto.</span><span class="sxs-lookup"><span data-stu-id="61e8b-136">Document controls let a user navigate and obtain information from multiple pages of text.</span></span>

<a name="TextPattern_Client_API_s"></a>

## <a name="textpattern-client-apis"></a><span data-ttu-id="61e8b-137">API de cliente de TextPattern</span><span class="sxs-lookup"><span data-stu-id="61e8b-137">TextPattern Client APIs</span></span>

|||
|-|-|
|`System.Windows.Automation.TextPattern Class`|<span data-ttu-id="61e8b-138">Es el punto de entrada para el modelo de texto de [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="61e8b-138">The entry point for the [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] text model.</span></span><br /><br /> <span data-ttu-id="61e8b-139">Esta clase también contiene las dos escuchas de eventos de <xref:System.Windows.Automation.TextPattern> , <xref:System.Windows.Automation.TextPattern.TextSelectionChangedEvent> y <xref:System.Windows.Automation.TextPattern.TextChangedEvent>.</span><span class="sxs-lookup"><span data-stu-id="61e8b-139">This class also contains the two <xref:System.Windows.Automation.TextPattern> event listeners, <xref:System.Windows.Automation.TextPattern.TextSelectionChangedEvent> and <xref:System.Windows.Automation.TextPattern.TextChangedEvent>.</span></span>|
|`System.Windows.Automation.Text.TextPatternRange Class`|<span data-ttu-id="61e8b-140">Es la representación de un intervalo de texto dentro de un contenedor de texto que admite <xref:System.Windows.Automation.TextPattern>.</span><span class="sxs-lookup"><span data-stu-id="61e8b-140">The representation of a span of text within a text container that supports <xref:System.Windows.Automation.TextPattern>.</span></span><br /><br /> <span data-ttu-id="61e8b-141">Los clientes de automatización de la interfaz de usuario debe tener cuidado con la validez actual de un intervalo de texto creado con <xref:System.Windows.Automation.Text.TextPatternRange>.</span><span class="sxs-lookup"><span data-stu-id="61e8b-141">UI Automation clients should be careful about the current validity of a text range created using <xref:System.Windows.Automation.Text.TextPatternRange>.</span></span> <span data-ttu-id="61e8b-142">Si el texto original del control de texto se reemplaza totalmente por el nuevo texto, el intervalo de texto actual deja de ser válido.</span><span class="sxs-lookup"><span data-stu-id="61e8b-142">If the original text in the text control is completely replaced by new text, the current text range becomes invalid.</span></span> <span data-ttu-id="61e8b-143">Sin embargo, puede que el intervalo de texto aún tenga alguna viabilidad si únicamente se cambia una parte del texto original y el control de texto subyacente está administrando su “puntero” de texto con delimitadores (o extremos) en lugar de con la posición de carácter absoluto.</span><span class="sxs-lookup"><span data-stu-id="61e8b-143">However, the text range may still have some viability if only part of the original text is changed and the underlying text control is managing its text "pointer" with anchors (or endpoints) rather than with absolute character positioning.</span></span><br /><br /> <span data-ttu-id="61e8b-144">Los clientes pueden realizar escuchas de un <xref:System.Windows.Automation.TextPattern.TextChangedEvent> para recibir notificaciones de los cambios realizados en el contenido textual con el que trabajan.</span><span class="sxs-lookup"><span data-stu-id="61e8b-144">Clients can listen for a <xref:System.Windows.Automation.TextPattern.TextChangedEvent> for notification of any changes to the textual content they are working with.</span></span>|
|`System.Windows.Automation.AutomationTextAttribute Class`|<span data-ttu-id="61e8b-145">Se usa para identificar los atributos de formato de un intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="61e8b-145">Used to identify the formatting attributes of a text range.</span></span>|

<a name="TextPattern_Provider_API_s"></a>

## <a name="textpattern-provider-apis"></a><span data-ttu-id="61e8b-146">API del proveedor TextPattern</span><span class="sxs-lookup"><span data-stu-id="61e8b-146">TextPattern Provider APIs</span></span>

<span data-ttu-id="61e8b-147">Los controles o elementos de interfaz de usuario que admiten <xref:System.Windows.Automation.TextPattern> al implementar las interfaces <xref:System.Windows.Automation.Provider.ITextProvider> y <xref:System.Windows.Automation.Provider.ITextRangeProvider> , ya sea de forma nativa o mediante los proxy de [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] , son capaces de exponer información detallada de atributos sobre cualquier texto que contengan, además de proporcionar sólidas funcionalidades de navegación.</span><span class="sxs-lookup"><span data-stu-id="61e8b-147">UI elements or controls that support <xref:System.Windows.Automation.TextPattern> by implementing the <xref:System.Windows.Automation.Provider.ITextProvider> and <xref:System.Windows.Automation.Provider.ITextRangeProvider> interfaces, either natively or through [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] proxies, are capable of exposing detailed attribute information for any text they contain in addition to providing robust navigational capabilities.</span></span>

<span data-ttu-id="61e8b-148">Un proveedor de <xref:System.Windows.Automation.TextPattern> no tiene que admitir todos los atributos de texto si el control no es compatible con algún atributo concreto.</span><span class="sxs-lookup"><span data-stu-id="61e8b-148">A <xref:System.Windows.Automation.TextPattern> provider does not have to support all text attributes if the control lacks support for any particular attributes.</span></span>

<span data-ttu-id="61e8b-149">Un proveedor de <xref:System.Windows.Automation.TextPattern> debe admitir las funciones <xref:System.Windows.Automation.TextPattern.GetSelection%2A> y <xref:System.Windows.Automation.Text.TextPatternRange.Select%2A> si el control admite la selección de texto o la ubicación del cursor de texto (o símbolo de inserción) dentro del área de texto.</span><span class="sxs-lookup"><span data-stu-id="61e8b-149">A <xref:System.Windows.Automation.TextPattern> provider must support the <xref:System.Windows.Automation.TextPattern.GetSelection%2A> and <xref:System.Windows.Automation.Text.TextPatternRange.Select%2A> functions if the control supports text selection or placement of the text cursor (or system caret) within the text area.</span></span> <span data-ttu-id="61e8b-150">Si el control no admite esta funcionalidad, entonces no es necesario que admita ninguno de estos métodos.</span><span class="sxs-lookup"><span data-stu-id="61e8b-150">If the control does not support this functionality then it does not need to support either of these methods.</span></span> <span data-ttu-id="61e8b-151">Sin embargo, el control debe implementar la propiedad <xref:System.Windows.Automation.Provider.ITextProvider.SupportedTextSelection%2A> a fin de exponer el tipo de selección de texto que admite.</span><span class="sxs-lookup"><span data-stu-id="61e8b-151">However, the control must expose the type of text selection it supports by implementing the <xref:System.Windows.Automation.Provider.ITextProvider.SupportedTextSelection%2A> property.</span></span>

<span data-ttu-id="61e8b-152">Un proveedor de <xref:System.Windows.Automation.TextPattern> siempre debe admitir las constantes <xref:System.Windows.Automation.Text.TextUnit> y <xref:System.Windows.Automation.Text.TextUnit.Character> de <xref:System.Windows.Automation.Text.TextUnit.Document> , así como cualquier otras constantes de <xref:System.Windows.Automation.Text.TextUnit> que es capaz de admitir.</span><span class="sxs-lookup"><span data-stu-id="61e8b-152">A <xref:System.Windows.Automation.TextPattern> provider must always support the <xref:System.Windows.Automation.Text.TextUnit> constants <xref:System.Windows.Automation.Text.TextUnit.Character> and <xref:System.Windows.Automation.Text.TextUnit.Document> as well as any other <xref:System.Windows.Automation.Text.TextUnit> constants it is capable of supporting.</span></span>

> [!NOTE]
> <span data-ttu-id="61e8b-153">El proveedor puede omitir la compatibilidad para un determinado <xref:System.Windows.Automation.Text.TextUnit> si se aplaza al siguiente mayor <xref:System.Windows.Automation.Text.TextUnit> compatible en el orden siguiente: <xref:System.Windows.Automation.Text.TextUnit.Character>, <xref:System.Windows.Automation.Text.TextUnit.Format>, <xref:System.Windows.Automation.Text.TextUnit.Word>, <xref:System.Windows.Automation.Text.TextUnit.Line>, <xref:System.Windows.Automation.Text.TextUnit.Paragraph>, <xref:System.Windows.Automation.Text.TextUnit.Page>y <xref:System.Windows.Automation.Text.TextUnit.Document>.</span><span class="sxs-lookup"><span data-stu-id="61e8b-153">The provider may skip support for a specific <xref:System.Windows.Automation.Text.TextUnit> by deferring to the next largest <xref:System.Windows.Automation.Text.TextUnit> supported in the following order: <xref:System.Windows.Automation.Text.TextUnit.Character>, <xref:System.Windows.Automation.Text.TextUnit.Format>, <xref:System.Windows.Automation.Text.TextUnit.Word>, <xref:System.Windows.Automation.Text.TextUnit.Line>, <xref:System.Windows.Automation.Text.TextUnit.Paragraph>, <xref:System.Windows.Automation.Text.TextUnit.Page>, and <xref:System.Windows.Automation.Text.TextUnit.Document>.</span></span>

|||
|-|-|
|`ITextProvider Interface`|<span data-ttu-id="61e8b-154">Expone métodos, propiedades y los atributos que admiten <xref:System.Windows.Automation.TextPattern> en las aplicaciones cliente (consulte <xref:System.Windows.Automation.Provider.ITextProvider>).</span><span class="sxs-lookup"><span data-stu-id="61e8b-154">Exposes methods, properties and attributes that support <xref:System.Windows.Automation.TextPattern> in client applications (see <xref:System.Windows.Automation.Provider.ITextProvider>).</span></span>|
|`ITextRangeProvider Interface`|<span data-ttu-id="61e8b-155">Representa un intervalo de texto en un proveedor de texto (consulte <xref:System.Windows.Automation.Provider.ITextRangeProvider>).</span><span class="sxs-lookup"><span data-stu-id="61e8b-155">Represents a span of text in a text provider (see <xref:System.Windows.Automation.Provider.ITextRangeProvider>).</span></span>|
|`System.Windows.Automation.TextPatternIdentifiers Class`|<span data-ttu-id="61e8b-156">Contiene valores que se usan como identificadores para los proveedores de texto (consulte <xref:System.Windows.Automation.TextPatternIdentifiers>).</span><span class="sxs-lookup"><span data-stu-id="61e8b-156">Contains values that are used as identifiers for text providers (see <xref:System.Windows.Automation.TextPatternIdentifiers>).</span></span>|

<a name="Security"></a>

## <a name="security"></a><span data-ttu-id="61e8b-157">de seguridad</span><span class="sxs-lookup"><span data-stu-id="61e8b-157">Security</span></span>

<span data-ttu-id="61e8b-158">Las clase [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] se diseñó teniendo en cuenta la seguridad (consulte [UI Automation Security Overview](ui-automation-security-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="61e8b-158">The [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] architecture was designed with security in mind (see [UI Automation Security Overview](ui-automation-security-overview.md)).</span></span> <span data-ttu-id="61e8b-159">Sin embargo, las clases TextPattern descritas en este artículo requieren algunas consideraciones de seguridad específicas.</span><span class="sxs-lookup"><span data-stu-id="61e8b-159">However, the TextPattern classes described in this overview require some specific security considerations.</span></span>

- <span data-ttu-id="61e8b-160">Los proveedores de texto de[!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] proporcionan interfaces de solo lectura y no proporcionan la capacidad de cambiar el texto existente en un control.</span><span class="sxs-lookup"><span data-stu-id="61e8b-160">[!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] text providers supply read-only interfaces and do not provide the ability to change the existing text in a control.</span></span>

- <span data-ttu-id="61e8b-161">Los clientes de la automatización de la interfaz de usuario solo pueden usar [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] si son de plena "confianza".</span><span class="sxs-lookup"><span data-stu-id="61e8b-161">UI Automation clients can only use [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] if they are fully "trusted".</span></span> <span data-ttu-id="61e8b-162">Un ejemplo de esto sería el escritorio de inicio de sesión protegido, donde tan solo pueden ejecutarse aplicaciones conocidas y de confianza.</span><span class="sxs-lookup"><span data-stu-id="61e8b-162">An example of this would be the protected Logon Desktop, where only known and trusted applications can run.</span></span>

- <span data-ttu-id="61e8b-163">Los desarrolladores de proveedores de automatización de la interfaz de usuario deben tener en cuenta que toda la información que elijan exponer en sus controles a través de [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] es básicamente pública y totalmente accesible por otro código.</span><span class="sxs-lookup"><span data-stu-id="61e8b-163">Developers of UI Automation providers should be aware that all information they choose to expose in their controls through [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] is essentially public and fully accessible by other code.</span></span> [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] <span data-ttu-id="61e8b-164">no realiza ningún esfuerzo para determinar la confiabilidad de cualquier cliente de automatización de la interfaz de usuario y, por tanto, el proveedor de automatización de la interfaz de usuario no debe exponer información textual confidencial o contenido protegido (por ejemplo, los campos de contraseña).</span><span class="sxs-lookup"><span data-stu-id="61e8b-164">makes no effort to determine the trustworthiness of any UI Automation client and therefore the UI Automation provider should not expose protected content or sensitive textual information (such as password fields).</span></span>

- <span data-ttu-id="61e8b-165">Uno de los cambios más importantes en la seguridad de Windows Vista se denomina ampliamente "entrada segura", que abarca tecnologías como cuentas de usuario con privilegios mínimos (o limitados) y aislamiento de nivel de privilegios de interfaz de usuario (UIPI).</span><span class="sxs-lookup"><span data-stu-id="61e8b-165">One of the most significant changes in security for Windows Vista is broadly referred to as "Secure Input" which encompasses technologies such as Least-privileged (or Limited) User Accounts (LUA) and UI Privilege Level Isolation (UIPI).</span></span>

  - <span data-ttu-id="61e8b-166">UIPI evita que un programa controle o supervise otro programa “con más privilegios”, lo que impide los ataques de mensajes de ventanas entre procesos que suplantan la entrada de los usuarios.</span><span class="sxs-lookup"><span data-stu-id="61e8b-166">UIPI prevents one program from controlling and/or monitoring another more "privileged" program, preventing cross-process window message attacks that spoof user input.</span></span>

  - <span data-ttu-id="61e8b-167">LUA establece límites en los privilegios de las aplicaciones ejecutadas por los usuarios del grupo Administradores.</span><span class="sxs-lookup"><span data-stu-id="61e8b-167">LUA sets limits on the privileges of applications being run by users in the Administrators group.</span></span> <span data-ttu-id="61e8b-168">Las aplicaciones no tienen necesariamente privilegios de administrador, sino que en su lugar se ejecutarán con los privilegios mínimos necesarios.</span><span class="sxs-lookup"><span data-stu-id="61e8b-168">Applications won't necessarily have administrator privileges, but will instead run with the least privileges necessary.</span></span> <span data-ttu-id="61e8b-169">Como consecuencia, puede haber algunas restricciones que se apliquen en escenarios LUA.</span><span class="sxs-lookup"><span data-stu-id="61e8b-169">As a consequence, there may be some restrictions enforced in LUA scenarios.</span></span> <span data-ttu-id="61e8b-170">En particular, el truncamiento de cadenas (incluidas cadenas TextPattern), donde puede ser necesario limitar el tamaño de las cadenas que se recuperan desde las aplicaciones de nivel de administrador, de modo que no se vean obligadas a asignar memoria hasta el punto de deshabilitar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="61e8b-170">Most notably string truncation (including TextPattern strings), where it may be necessary to limit the size of strings being retrieved from administrator-level applications so they aren't forced to allocate memory to the point of disabling the application.</span></span>

<a name="Performance"></a>

## <a name="performance"></a><span data-ttu-id="61e8b-171">Rendimiento</span><span class="sxs-lookup"><span data-stu-id="61e8b-171">Performance</span></span>

<span data-ttu-id="61e8b-172">Dado la mayor parte de la funcionalidad de TextPattern se basa en las llamadas entre procesos, no proporciona un mecanismo de almacenamiento en caché para mejorar el rendimiento al procesar el contenido.</span><span class="sxs-lookup"><span data-stu-id="61e8b-172">Because TextPattern relies on cross-process calls for most of its functionality, it does not provide a caching mechanism to improve performance when processing content.</span></span> <span data-ttu-id="61e8b-173">Esto es diferente a otros patrones de control de la [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] a los que se puede tener acceso mediante los métodos <xref:System.Windows.Automation.AutomationElement.GetCachedPattern%2A> o <xref:System.Windows.Automation.AutomationElement.TryGetCachedPattern%2A> .</span><span class="sxs-lookup"><span data-stu-id="61e8b-173">This is unlike other control patterns in [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] that can be accessed using the <xref:System.Windows.Automation.AutomationElement.GetCachedPattern%2A> or <xref:System.Windows.Automation.AutomationElement.TryGetCachedPattern%2A> methods.</span></span>

<span data-ttu-id="61e8b-174">Una táctica para mejorar el rendimiento es asegurarse de que los clientes de automatización de la interfaz de usuario intentan recuperar bloques de texto de tamaño moderado con <xref:System.Windows.Automation.Text.TextPatternRange.GetText%2A>.</span><span class="sxs-lookup"><span data-stu-id="61e8b-174">One tactic for improving performance is by making sure UI Automation clients attempt to retrieve moderately-sized blocks of text using <xref:System.Windows.Automation.Text.TextPatternRange.GetText%2A>.</span></span> <span data-ttu-id="61e8b-175">Por ejemplo, las llamadas a GetText(1) incurrirán en varios resultados entre procesos para cada carácter, mientras que una llamada a GetText (-1) incurrirá en un solo resultado entre procesos, pero puede tener una latencia elevada según el tamaño del proveedor de texto.</span><span class="sxs-lookup"><span data-stu-id="61e8b-175">For example, GetText(1) calls will incur cross-process hits for each character whereas one GetText(-1) call will incur one cross-process hit, but can have high latency depending on the size of the text provider.</span></span>

<a name="Glossary"></a>

## <a name="textpattern-terminology"></a><span data-ttu-id="61e8b-176">Terminología de TextPattern</span><span class="sxs-lookup"><span data-stu-id="61e8b-176">TextPattern Terminology</span></span>

<span data-ttu-id="61e8b-177">\ de **atributo**</span><span class="sxs-lookup"><span data-stu-id="61e8b-177">**Attribute**\</span></span>
<span data-ttu-id="61e8b-178">Es una característica de formato de un intervalo de texto (por ejemplo, <xref:System.Windows.Automation.TextPattern.IsItalicAttribute> o <xref:System.Windows.Automation.TextPattern.FontNameAttribute>).</span><span class="sxs-lookup"><span data-stu-id="61e8b-178">A formatting characteristic of a text range (for example, <xref:System.Windows.Automation.TextPattern.IsItalicAttribute> or <xref:System.Windows.Automation.TextPattern.FontNameAttribute>).</span></span>

<span data-ttu-id="61e8b-179">**Intervalo Degenerado**</span><span class="sxs-lookup"><span data-stu-id="61e8b-179">**Degenerate Range**</span></span>\
<span data-ttu-id="61e8b-180">Un intervalo degenerado es un intervalo de texto vacío o con cero caracteres.</span><span class="sxs-lookup"><span data-stu-id="61e8b-180">A degenerate range is an empty or zero-character text range.</span></span> <span data-ttu-id="61e8b-181">Para los fines del patrón de control TextPattern, el punto de inserción de texto (o símbolo de inserción) se considera un intervalo degenerado.</span><span class="sxs-lookup"><span data-stu-id="61e8b-181">For the purposes of the TextPattern control pattern, the text insertion point (or system caret) is considered a degenerate range.</span></span> <span data-ttu-id="61e8b-182">Si no hay texto seleccionado, <xref:System.Windows.Automation.TextPattern.GetSelection%2A> devolverá un intervalo degenerado en el punto de inserción de texto y <xref:System.Windows.Automation.TextPattern.RangeFromPoint%2A> devolverá un intervalo degenerado como extremo inicial.</span><span class="sxs-lookup"><span data-stu-id="61e8b-182">If no text is selected, <xref:System.Windows.Automation.TextPattern.GetSelection%2A> would return a degenerate range at the text insertion point and <xref:System.Windows.Automation.TextPattern.RangeFromPoint%2A> would return a degenerate range as its starting endpoint.</span></span> <span data-ttu-id="61e8b-183"><xref:System.Windows.Automation.TextPattern.RangeFromChild%2A> y <xref:System.Windows.Automation.TextPattern.GetVisibleRanges%2A> pueden devolver intervalos degenerados cuando el proveedor de texto no encuentra ningún intervalo de texto que coincida con la condición especificada.</span><span class="sxs-lookup"><span data-stu-id="61e8b-183"><xref:System.Windows.Automation.TextPattern.RangeFromChild%2A> and <xref:System.Windows.Automation.TextPattern.GetVisibleRanges%2A> may return degenerate ranges when the text provider cannot find any text ranges that match the given condition.</span></span> <span data-ttu-id="61e8b-184">Este intervalo degenerado puede usarse como extremo inicial dentro del proveedor de texto.</span><span class="sxs-lookup"><span data-stu-id="61e8b-184">This degenerate range can be used as a starting endpoint within the text provider.</span></span> <span data-ttu-id="61e8b-185"><xref:System.Windows.Automation.Text.TextPatternRange.FindText%2A> y <xref:System.Windows.Automation.Text.TextPatternRange.FindAttribute%2A> devuelven una referencia nula (`Nothing` en Microsoft Visual Basic .NET) para evitar la confusión con un intervalo descubierto en lugar de un intervalo degenerado.</span><span class="sxs-lookup"><span data-stu-id="61e8b-185"><xref:System.Windows.Automation.Text.TextPatternRange.FindText%2A> and <xref:System.Windows.Automation.Text.TextPatternRange.FindAttribute%2A> return a null reference (`Nothing` in Microsoft Visual Basic .NET) to avoid confusion with a discovered range versus a degenerate range.</span></span>

<span data-ttu-id="61e8b-186">\ de **objeto incrustado**</span><span class="sxs-lookup"><span data-stu-id="61e8b-186">**Embedded Object**\</span></span>
<span data-ttu-id="61e8b-187">Hay dos tipos de objetos incrustados en el modelo de texto de [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</span><span class="sxs-lookup"><span data-stu-id="61e8b-187">There are two types of embedded objects in the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] text model.</span></span> <span data-ttu-id="61e8b-188">que están formados por elementos de contenido basado en texto, como hipervínculos o tablas, y elementos de control, como imágenes y botones.</span><span class="sxs-lookup"><span data-stu-id="61e8b-188">They consist of text-based content elements such as hyperlinks or tables, and control elements such as images and buttons.</span></span> <span data-ttu-id="61e8b-189">Para información detallada, vea [Access Embedded Objects Using UI Automation](access-embedded-objects-using-ui-automation.md).</span><span class="sxs-lookup"><span data-stu-id="61e8b-189">For more detailed information, see [Access Embedded Objects Using UI Automation](access-embedded-objects-using-ui-automation.md).</span></span>

<span data-ttu-id="61e8b-190">\ de **extremo**</span><span class="sxs-lookup"><span data-stu-id="61e8b-190">**Endpoint**\</span></span>
<span data-ttu-id="61e8b-191">Es el punto <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.Start> o <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.End> absoluto de un intervalo de texto dentro de un contenedor de texto.</span><span class="sxs-lookup"><span data-stu-id="61e8b-191">The absolute <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.Start> or <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.End> point of a text range within a text container.</span></span>

<span data-ttu-id="61e8b-192">![Inicio &#40;y finalización&#41;de TextPatternRangeEndpoints.](./media/uia-textpattern-endpoints.PNG "UIA_TextPattern_Endpoints")</span><span class="sxs-lookup"><span data-stu-id="61e8b-192">![TextPatternRangeEndpoints &#40;start and end&#41;.](./media/uia-textpattern-endpoints.PNG "UIA_TextPattern_Endpoints")</span></span>
<span data-ttu-id="61e8b-193">En el siguiente ejemplo se muestra un conjunto de puntos de inicio y final.</span><span class="sxs-lookup"><span data-stu-id="61e8b-193">The following illustrates a set of start and end points.</span></span>

<span data-ttu-id="61e8b-194">**TextRange**</span><span class="sxs-lookup"><span data-stu-id="61e8b-194">**TextRange**</span></span>\
<span data-ttu-id="61e8b-195">Es una representación de un intervalo de texto, con puntos de inicio y final, en un contenedor de texto que incluye todos los atributos y la funcionalidad asociados.</span><span class="sxs-lookup"><span data-stu-id="61e8b-195">A representation of a span of text, with start and end points, in a text container including all associated attributes and functionality.</span></span>

<xref:System.Windows.Automation.Text.TextUnit>\
<span data-ttu-id="61e8b-196">Unidad predefinida de texto (carácter, palabra, línea o párrafo) usada para navegar por los segmentos lógicos de un intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="61e8b-196">A pre-defined unit of text (character, word, line, or paragraph) used for navigating through logical segments of a text range.</span></span>

## <a name="see-also"></a><span data-ttu-id="61e8b-197">Vea también</span><span class="sxs-lookup"><span data-stu-id="61e8b-197">See also</span></span>

- [<span data-ttu-id="61e8b-198">Patrones de control de Automatización de la interfaz de usuario para clientes</span><span class="sxs-lookup"><span data-stu-id="61e8b-198">UI Automation Control Patterns for Clients</span></span>](ui-automation-control-patterns-for-clients.md)
- [<span data-ttu-id="61e8b-199">Información general sobre los patrones de control de la Automatización de la interfaz de usuario</span><span class="sxs-lookup"><span data-stu-id="61e8b-199">UI Automation Control Patterns Overview</span></span>](ui-automation-control-patterns-overview.md)
- [<span data-ttu-id="61e8b-200">Información general sobre el árbol de la Automatización de la interfaz de usuario</span><span class="sxs-lookup"><span data-stu-id="61e8b-200">UI Automation Tree Overview</span></span>](ui-automation-tree-overview.md)
- [<span data-ttu-id="61e8b-201">Uso del almacenamiento en caché en la Automatización de la interfaz de usuario</span><span class="sxs-lookup"><span data-stu-id="61e8b-201">Use Caching in UI Automation</span></span>](use-caching-in-ui-automation.md)
- [<span data-ttu-id="61e8b-202">Patrones de control compatibles en un proveedor de Automatización de la interfaz de usuario</span><span class="sxs-lookup"><span data-stu-id="61e8b-202">Support Control Patterns in a UI Automation Provider</span></span>](support-control-patterns-in-a-ui-automation-provider.md)
- [<span data-ttu-id="61e8b-203">Asignación de patrones de control para clientes de Automatización de la interfaz de usuario</span><span class="sxs-lookup"><span data-stu-id="61e8b-203">Control Pattern Mapping for UI Automation Clients</span></span>](control-pattern-mapping-for-ui-automation-clients.md)
- [<span data-ttu-id="61e8b-204">Text Services Framework (TSF)</span><span class="sxs-lookup"><span data-stu-id="61e8b-204">Text Services Framework</span></span>](/windows/desktop/api/_tsf/)
