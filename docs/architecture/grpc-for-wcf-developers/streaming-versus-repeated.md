---
title: Streaming Services frente a campos repetidos-gRPC para desarrolladores de WCF
description: Compare los campos repetidos con los servicios de streaming como formas de pasar colecciones de datos con gRPC.
ms.date: 09/02/2019
ms.openlocfilehash: 46586ab08df6b136cdafb990ce8be75435a6bf6c
ms.sourcegitcommit: 30a558d23e3ac5a52071121a52c305c85fe15726
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 12/25/2019
ms.locfileid: "75337867"
---
# <a name="grpc-streaming-services-versus-repeated-fields"></a><span data-ttu-id="340ca-103">gRPC streaming Services frente a campos repetidos</span><span class="sxs-lookup"><span data-stu-id="340ca-103">gRPC streaming services versus repeated fields</span></span>

<span data-ttu-id="340ca-104">los servicios de gRPC proporcionan dos maneras de devolver conjuntos de valores o listas de objetos.</span><span class="sxs-lookup"><span data-stu-id="340ca-104">gRPC services provide two ways of returning datasets, or lists of objects.</span></span> <span data-ttu-id="340ca-105">La especificación de mensajes de búferes de protocolo utiliza la palabra clave `repeated` para declarar listas o matrices de mensajes dentro de otro mensaje.</span><span class="sxs-lookup"><span data-stu-id="340ca-105">The Protocol Buffers message specification uses the `repeated` keyword for declaring lists or arrays of messages within another message.</span></span> <span data-ttu-id="340ca-106">La especificación del servicio gRPC usa la palabra clave `stream` para declarar una conexión persistente de ejecución prolongada a través de la cual se envían varios mensajes y se puede procesar de forma individual.</span><span class="sxs-lookup"><span data-stu-id="340ca-106">The gRPC service specification uses the `stream` keyword to declare a long-running persistent connection over which multiple messages are sent, and can be processed, individually.</span></span> <span data-ttu-id="340ca-107">La característica `stream` también se puede usar para datos temporales de ejecución prolongada como notificaciones o mensajes de registro, pero en este capítulo se considerará su uso para devolver un único conjunto de datos.</span><span class="sxs-lookup"><span data-stu-id="340ca-107">The `stream` feature can also be used for long-running temporal data such as notifications or log messages, but this chapter will consider its use for returning a single dataset.</span></span>

<span data-ttu-id="340ca-108">El uso de depende de varios factores, como el tamaño total del conjunto de elementos, el tiempo que se tarda en crear el conjunto de valores en el cliente o en el extremo del servidor, y si el consumidor del conjunto de elementos puede empezar a actuar en él en cuanto el primer elemento esté disponible. , o necesita el conjunto de resultados completo para hacer algo útil.</span><span class="sxs-lookup"><span data-stu-id="340ca-108">Which you should use depends on various factors, such as the overall size of the dataset, the time it took to create the dataset at either the client or server end, and whether the consumer of the dataset can start acting on it as soon as the first item is available, or needs the complete dataset to do anything useful.</span></span>

## <a name="when-to-use-repeated-fields"></a><span data-ttu-id="340ca-109">Cuándo usar `repeated` campos</span><span class="sxs-lookup"><span data-stu-id="340ca-109">When to use `repeated` fields</span></span>

<span data-ttu-id="340ca-110">Para cualquier conjunto de elementos que esté restringido en tamaño y que se pueda generar en su totalidad en un breve período de tiempo (por ejemplo, en un segundo), debe usar un `repeated` campo en un mensaje protobuf normal.</span><span class="sxs-lookup"><span data-stu-id="340ca-110">For any dataset that is constrained in size and that can be generated in its entirety in a short time—say, under one second—you should use a `repeated` field in a regular Protobuf message.</span></span> <span data-ttu-id="340ca-111">Por ejemplo, en un sistema de comercio electrónico, para crear una lista de elementos dentro de un pedido probablemente sea rápido y la lista no sea muy grande.</span><span class="sxs-lookup"><span data-stu-id="340ca-111">For example, in an e-commerce system, to build a list of items within an order is probably quick and the list won't be very large.</span></span> <span data-ttu-id="340ca-112">Devolver un solo mensaje con un campo de `repeated` es un orden de magnitud más rápido que el uso de un `stream` e incurre en menos sobrecarga de la red.</span><span class="sxs-lookup"><span data-stu-id="340ca-112">Returning a single message with a `repeated` field is an order of magnitude faster than using a `stream` and incurs less network overhead.</span></span>

<span data-ttu-id="340ca-113">Si el cliente necesita todos los datos antes de empezar a procesarlo y el conjunto de datos es lo suficientemente pequeño como para construir en la memoria, considere la posibilidad de usar un campo `repeated` incluso si la creación real del conjunto de datos en memoria en el servidor es más lenta.</span><span class="sxs-lookup"><span data-stu-id="340ca-113">If the client needs all the data before starting to process it and the dataset is small enough to construct in memory, then consider using a `repeated` field even if the actual creation of the dataset in memory on the server is slower.</span></span>

## <a name="when-to-use-stream-methods"></a><span data-ttu-id="340ca-114">Cuándo usar métodos `stream`</span><span class="sxs-lookup"><span data-stu-id="340ca-114">When to use `stream` methods</span></span>

<span data-ttu-id="340ca-115">Los conjuntos de valores en los que los objetos de mensaje son potencialmente grandes se transfieren mejor mediante solicitudes o respuestas de streaming.</span><span class="sxs-lookup"><span data-stu-id="340ca-115">Datasets where the message objects are potentially very large are best transferred using streaming requests or responses.</span></span> <span data-ttu-id="340ca-116">Es más eficaz construir un objeto grande en la memoria, escribirlo en la red y, a continuación, liberar los recursos.</span><span class="sxs-lookup"><span data-stu-id="340ca-116">It's more efficient to construct a large object in memory, write it to the network and then free up the resources.</span></span> <span data-ttu-id="340ca-117">Este enfoque mejorará la escalabilidad del servicio.</span><span class="sxs-lookup"><span data-stu-id="340ca-117">This approach will improve the scalability of your service.</span></span>

<span data-ttu-id="340ca-118">Del mismo modo, los conjuntos de valores sin restricciones se deben enviar a través de secuencias para evitar quedarse sin memoria mientras se crean.</span><span class="sxs-lookup"><span data-stu-id="340ca-118">Similarly, datasets of unconstrained size should be sent over streams to avoid running out of memory while constructing them.</span></span>

<span data-ttu-id="340ca-119">En el caso de los conjuntos de usuarios en los que el consumidor puede procesar por separado cada elemento individual, debe considerar la posibilidad de usar un flujo si esto significa que se puede indicar el progreso al usuario final.</span><span class="sxs-lookup"><span data-stu-id="340ca-119">For datasets where each individual item can be processed separately by the consumer, you should consider using a stream if it means that progress can be indicated to the end user.</span></span> <span data-ttu-id="340ca-120">Esto podría mejorar la capacidad de respuesta aparente de una aplicación, aunque debe equilibrarse con el rendimiento general de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="340ca-120">This could improve the apparent responsiveness of an application, although this should be balanced against the overall performance of the application.</span></span>

<span data-ttu-id="340ca-121">Otro escenario en el que los flujos pueden ser útiles es el lugar en el que se procesa un mensaje en varios servicios.</span><span class="sxs-lookup"><span data-stu-id="340ca-121">Another scenario where streams can be useful is where a message is being processed across multiple services.</span></span> <span data-ttu-id="340ca-122">Si cada servicio de una cadena devuelve una secuencia, el servicio de Terminal Server (es decir, el último de la cadena) puede empezar a devolver mensajes que se pueden procesar y devolver a lo largo de la cadena al solicitante original, que puede devolver una secuencia o agregar la da como resultado un único mensaje de respuesta.</span><span class="sxs-lookup"><span data-stu-id="340ca-122">If each service in a chain returns a stream, then the terminal service (that is, the last one in the chain) can start returning messages that can be processed and passed back along the chain to the original requestor, which can either return a stream or aggregate the results into a single response message.</span></span> <span data-ttu-id="340ca-123">Este enfoque se presta bien a patrones como asignación y reducción.</span><span class="sxs-lookup"><span data-stu-id="340ca-123">This approach lends itself well to patterns like Map/Reduce.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="340ca-124">[Anterior](migrate-duplex-services.md)
>[Siguiente](client-libraries.md)</span><span class="sxs-lookup"><span data-stu-id="340ca-124">[Previous](migrate-duplex-services.md)
[Next](client-libraries.md)</span></span>
