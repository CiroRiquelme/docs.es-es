---
title: Importar una biblioteca de tipos como un ensamblado
ms.date: 03/30/2017
helpviewer_keywords:
- importing type library
- type metadata
- custom wrappers
- metadata
- exposing COM components to .NET Framework
- Type Library Importer
- interoperation with unmanaged code, importing type library
- interoperation with unmanaged code, exposing COM components
- type libraries
- TypeLibConverter class, importing type library as assembly
- COM interop, importing type library
- COM interop, exposing COM components
ms.assetid: d1898229-cd40-426e-a275-f3eb65fbc79f
ms.openlocfilehash: e1a21175bcabc72b86a328d4f73ecec37140c304
ms.sourcegitcommit: 559fcfbe4871636494870a8b716bf7325df34ac5
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 10/30/2019
ms.locfileid: "73107596"
---
# <a name="importing-a-type-library-as-an-assembly"></a><span data-ttu-id="b73f4-102">Importar una biblioteca de tipos como un ensamblado</span><span class="sxs-lookup"><span data-stu-id="b73f4-102">Importing a Type Library as an Assembly</span></span>

<span data-ttu-id="b73f4-103">Las definiciones de tipos COM residen normalmente en una biblioteca de tipos.</span><span class="sxs-lookup"><span data-stu-id="b73f4-103">COM type definitions usually reside in a type library.</span></span> <span data-ttu-id="b73f4-104">Por el contrario, los compiladores conformes a CLS generan metadatos de tipos en un ensamblado.</span><span class="sxs-lookup"><span data-stu-id="b73f4-104">In contrast, CLS-compliant compilers produce type metadata in an assembly.</span></span> <span data-ttu-id="b73f4-105">Las dos fuentes de información de tipos son muy diferentes.</span><span class="sxs-lookup"><span data-stu-id="b73f4-105">The two sources of type information are quite different.</span></span> <span data-ttu-id="b73f4-106">En este tema se describen técnicas para generar metadatos a partir de una biblioteca de tipos.</span><span class="sxs-lookup"><span data-stu-id="b73f4-106">This topic describes techniques for generating metadata from a type library.</span></span> <span data-ttu-id="b73f4-107">El ensamblado resultante se denomina ensamblado de interoperabilidad y la información de tipos que contiene permite a las aplicaciones de .NET Framework usar tipos COM.</span><span class="sxs-lookup"><span data-stu-id="b73f4-107">The resulting assembly is called an interop assembly, and the type information it contains enables .NET Framework applications to use COM types.</span></span>

<span data-ttu-id="b73f4-108">Hay dos maneras de hacer que esta información de tipos esté disponible para la aplicación:</span><span class="sxs-lookup"><span data-stu-id="b73f4-108">There are two ways to make this type information available to your application:</span></span>

- <span data-ttu-id="b73f4-109">Mediante ensamblados de interoperabilidad solo de tiempo de diseño: A partir de .NET Framework 4, se puede indicar al compilador que inserte información de tipos del ensamblado de interoperabilidad en el archivo ejecutable.</span><span class="sxs-lookup"><span data-stu-id="b73f4-109">Using design-time-only interop assemblies: Beginning with the .NET Framework 4, you can instruct the compiler to embed type information from the interop assembly into your executable.</span></span> <span data-ttu-id="b73f4-110">El compilador solo inserta la información de tipos que la aplicación usa.</span><span class="sxs-lookup"><span data-stu-id="b73f4-110">The compiler embeds only the type information that your application uses.</span></span> <span data-ttu-id="b73f4-111">No es necesario implementar el ensamblado de interoperabilidad con la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b73f4-111">You do not have to deploy the interop assembly with your application.</span></span> <span data-ttu-id="b73f4-112">Esta es la técnica recomendada.</span><span class="sxs-lookup"><span data-stu-id="b73f4-112">This is the recommended technique.</span></span>

- <span data-ttu-id="b73f4-113">Mediante la implementación de ensamblados de interoperabilidad: se puede crear una referencia estándar al ensamblado de interoperabilidad.</span><span class="sxs-lookup"><span data-stu-id="b73f4-113">Deploying interop assemblies: You can create a standard reference to the interop assembly.</span></span> <span data-ttu-id="b73f4-114">En este caso, el ensamblado de interoperabilidad debe implementarse con la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b73f4-114">In this case, the interop assembly must be deployed with your application.</span></span> <span data-ttu-id="b73f4-115">Si emplea esta técnica y no usa ningún componente COM privado, haga siempre referencia al ensamblado de interoperabilidad primario (PIA) publicado por el autor del componente COM que va a incorporar en el código administrado.</span><span class="sxs-lookup"><span data-stu-id="b73f4-115">If you employ this technique, and you are not using a private COM component, always reference the primary interop assembly (PIA) published by the author of the COM component you intend to incorporate in your managed code.</span></span> <span data-ttu-id="b73f4-116">Para más información sobre generar y usar ensamblados de interoperabilidad primarios, vea [Ensamblados de interoperabilidad primarios](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="b73f4-116">For more information about producing and using primary interop assemblies, see [Primary Interop Assemblies](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100)).</span></span>

<span data-ttu-id="b73f4-117">Al usar ensamblados de interoperabilidad solo de tiempo de diseño, se puede insertar información de tipos del ensamblado de interoperabilidad primario publicado por el autor del componente COM.</span><span class="sxs-lookup"><span data-stu-id="b73f4-117">When you use design-time-only interop assemblies, you can embed type information from the primary interop assembly published by the author of the COM component.</span></span> <span data-ttu-id="b73f4-118">En cambio, no es necesario implementar el ensamblado de interoperabilidad primario con la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b73f4-118">However, you do not have to deploy the primary interop assembly with your application.</span></span>

<span data-ttu-id="b73f4-119">El uso de ensamblados de interoperabilidad solo de tiempo de diseño reduce el tamaño de la aplicación, dado que la mayoría de las aplicaciones no usa todas las características de un componente COM.</span><span class="sxs-lookup"><span data-stu-id="b73f4-119">Using design-time-only interop assemblies reduces the size of your application, because most applications do not use all the features of a COM component.</span></span> <span data-ttu-id="b73f4-120">El compilador es muy eficaz cuando inserta información de tipos; si la aplicación solo usa algunos de los métodos de una interfaz COM, el compilador no inserta los métodos que no se usan.</span><span class="sxs-lookup"><span data-stu-id="b73f4-120">The compiler is very efficient when it embeds type information; if your application uses only some of the methods on a COM interface, the compiler does not embed the unused methods.</span></span> <span data-ttu-id="b73f4-121">Cuando una aplicación que contiene información de tipos insertada interactúa con otra aplicación, o interactúa con una aplicación que usa un ensamblado de interoperabilidad primario, Common Language Runtime usa reglas de equivalencia de tipos para determinar si dos tipos con el mismo nombre representan el mismo tipo de COM.</span><span class="sxs-lookup"><span data-stu-id="b73f4-121">When an application that has embedded type information interacts with another such application, or interacts with an application that uses a primary interop assembly, the common language runtime uses type equivalence rules to determine whether two types with the same name represent the same COM type.</span></span> <span data-ttu-id="b73f4-122">No es necesario conocer estas reglas para usar los objetos COM.</span><span class="sxs-lookup"><span data-stu-id="b73f4-122">You do not have to know these rules to use COM objects.</span></span> <span data-ttu-id="b73f4-123">Si está interesado en las reglas, vea [Equivalencia de tipos y tipos de interoperabilidad incrustados](type-equivalence-and-embedded-interop-types.md).</span><span class="sxs-lookup"><span data-stu-id="b73f4-123">However, if you are interested in the rules, see [Type Equivalence and Embedded Interop Types](type-equivalence-and-embedded-interop-types.md).</span></span>

## <a name="generating-metadata"></a><span data-ttu-id="b73f4-124">Generación de metadatos</span><span class="sxs-lookup"><span data-stu-id="b73f4-124">Generating Metadata</span></span>

<span data-ttu-id="b73f4-125">Las bibliotecas de tipos COM pueden ser archivos independientes que tienen una extensión .tlb, como Loanlib.tlb.</span><span class="sxs-lookup"><span data-stu-id="b73f4-125">COM type libraries can be stand-alone files that have a .tlb extension, such as Loanlib.tlb.</span></span> <span data-ttu-id="b73f4-126">Algunas bibliotecas de tipos se insertan en la sección de recursos de un archivo .dll o .exe.</span><span class="sxs-lookup"><span data-stu-id="b73f4-126">Some type libraries are embedded in the resource section of a .dll or .exe file.</span></span> <span data-ttu-id="b73f4-127">Otros orígenes de información de biblioteca de tipos son los archivos .olb y .ocx.</span><span class="sxs-lookup"><span data-stu-id="b73f4-127">Other sources of type library information are .olb and .ocx files.</span></span>

<span data-ttu-id="b73f4-128">Después de encontrar la biblioteca de tipos que contiene la implementación del tipo COM de destino, tiene las siguientes opciones para generar un ensamblado de interoperabilidad que contenga metadatos de tipos:</span><span class="sxs-lookup"><span data-stu-id="b73f4-128">After you locate the type library that contains the implementation of your target COM type, you have the following options for generating an interop assembly containing type metadata:</span></span>

- <span data-ttu-id="b73f4-129">Programa para la mejora</span><span class="sxs-lookup"><span data-stu-id="b73f4-129">Visual Studio</span></span>

  <span data-ttu-id="b73f4-130">Visual Studio convierte automáticamente los tipos COM de una biblioteca de tipos a metadatos en un ensamblado.</span><span class="sxs-lookup"><span data-stu-id="b73f4-130">Visual Studio automatically converts COM types in a type library to metadata in an assembly.</span></span> <span data-ttu-id="b73f4-131">Para obtener instrucciones, vea [Cómo: Adición de referencias a bibliotecas de tipos](how-to-add-references-to-type-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="b73f4-131">For instructions, see [How to: Add References to Type Libraries](how-to-add-references-to-type-libraries.md).</span></span>

- [<span data-ttu-id="b73f4-132">TlbImp.exe (Importador de la biblioteca de tipos)</span><span class="sxs-lookup"><span data-stu-id="b73f4-132">Type Library Importer (Tlbimp.exe)</span></span>](../tools/tlbimp-exe-type-library-importer.md)

  <span data-ttu-id="b73f4-133">El importador de la biblioteca de tipos proporciona opciones de línea de comandos para ajustar los metadatos en el archivo de interoperabilidad resultante, importa tipos desde una biblioteca de tipos existente y genera un ensamblado de interoperabilidad y un espacio de nombres.</span><span class="sxs-lookup"><span data-stu-id="b73f4-133">The Type Library Importer provides command-line options to adjust metadata in the resulting interop file, imports types from an existing type library, and generates an interop assembly and a namespace.</span></span> <span data-ttu-id="b73f4-134">Para obtener instrucciones, vea [Cómo: Generar ensamblados de interoperabilidad a partir de bibliotecas de tipos](how-to-generate-interop-assemblies-from-type-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="b73f4-134">For instructions, see [How to: Generate Interop Assemblies from Type Libraries](how-to-generate-interop-assemblies-from-type-libraries.md).</span></span>

- <span data-ttu-id="b73f4-135">Clase <xref:System.Runtime.InteropServices.TypeLibConverter?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="b73f4-135"><xref:System.Runtime.InteropServices.TypeLibConverter?displayProperty=nameWithType> class</span></span>

  <span data-ttu-id="b73f4-136">Esta clase proporciona métodos para convertir coclases e interfaces de una biblioteca de tipos en metadatos de un ensamblado.</span><span class="sxs-lookup"><span data-stu-id="b73f4-136">This class provides methods to convert coclasses and interfaces in a type library to metadata within an assembly.</span></span> <span data-ttu-id="b73f4-137">Genera el mismo resultado de metadatos que Tlbimp.exe.</span><span class="sxs-lookup"><span data-stu-id="b73f4-137">It produces the same metadata output as Tlbimp.exe.</span></span> <span data-ttu-id="b73f4-138">Pero a diferencia de Tlbimp.exe, la clase <xref:System.Runtime.InteropServices.TypeLibConverter> puede convertir una biblioteca de tipos en memoria en metadatos.</span><span class="sxs-lookup"><span data-stu-id="b73f4-138">However, unlike Tlbimp.exe, the <xref:System.Runtime.InteropServices.TypeLibConverter> class can convert an in-memory type library to metadata.</span></span>

- <span data-ttu-id="b73f4-139">Contenedores personalizados</span><span class="sxs-lookup"><span data-stu-id="b73f4-139">Custom wrappers</span></span>

  <span data-ttu-id="b73f4-140">Cuando una biblioteca de tipos no está disponible o es incorrecta, una opción es crear una definición duplicada de la clase o interfaz en código fuente administrado.</span><span class="sxs-lookup"><span data-stu-id="b73f4-140">When a type library is unavailable or incorrect, one option is to create a duplicate definition of the class or interface in managed source code.</span></span> <span data-ttu-id="b73f4-141">Después, se compila el código fuente con un compilador que tenga como destino el tiempo de ejecución para generar metadatos en un ensamblado.</span><span class="sxs-lookup"><span data-stu-id="b73f4-141">You then compile the source code with a compiler that targets the runtime to produce metadata in an assembly.</span></span>

  <span data-ttu-id="b73f4-142">Para definir tipos COM manualmente, se debe tener acceso a los siguientes elementos:</span><span class="sxs-lookup"><span data-stu-id="b73f4-142">To define COM types manually, you must have access to the following items:</span></span>

  - <span data-ttu-id="b73f4-143">Descripciones precisas de las coclases e interfaces que se van a definir.</span><span class="sxs-lookup"><span data-stu-id="b73f4-143">Precise descriptions of the coclasses and interfaces being defined.</span></span>

  - <span data-ttu-id="b73f4-144">Un compilador, como el compilador de C#, que pueda generar las definiciones de clase de .NET Framework correspondientes.</span><span class="sxs-lookup"><span data-stu-id="b73f4-144">A compiler, such as the C# compiler, that can generate the appropriate .NET Framework class definitions.</span></span>

  - <span data-ttu-id="b73f4-145">Conocimiento de las reglas de conversión de bibliotecas de tipos a ensamblados.</span><span class="sxs-lookup"><span data-stu-id="b73f4-145">Knowledge of the type library-to-assembly conversion rules.</span></span>

  <span data-ttu-id="b73f4-146">Escribir un contenedor personalizado es una técnica avanzada.</span><span class="sxs-lookup"><span data-stu-id="b73f4-146">Writing a custom wrapper is an advanced technique.</span></span> <span data-ttu-id="b73f4-147">Para obtener información adicional sobre cómo generar un contenedor personalizado, vea [Personalizar contenedores estándar](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="b73f4-147">For additional information about how to generate a custom wrapper, see [Customizing Standard Wrappers](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100)).</span></span>

 <span data-ttu-id="b73f4-148">Para más información sobre el proceso de importación de interoperabilidad COM, vea [Resumen de la conversión de bibliotecas de tipos en ensamblados](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="b73f4-148">For more information about the COM interop import process, see [Type Library to Assembly Conversion Summary](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100)).</span></span>

## <a name="see-also"></a><span data-ttu-id="b73f4-149">Vea también</span><span class="sxs-lookup"><span data-stu-id="b73f4-149">See also</span></span>

- <xref:System.Runtime.InteropServices.TypeLibConverter>
- [<span data-ttu-id="b73f4-150">Exponer componentes COM en .NET Framework</span><span class="sxs-lookup"><span data-stu-id="b73f4-150">Exposing COM Components to the .NET Framework</span></span>](exposing-com-components.md)
- <span data-ttu-id="b73f4-151">[Resumen de la conversión de bibliotecas de tipos en ensamblados](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="b73f4-151">[Type Library to Assembly Conversion Summary](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))</span></span>
- [<span data-ttu-id="b73f4-152">TlbImp.exe (Importador de la biblioteca de tipos)</span><span class="sxs-lookup"><span data-stu-id="b73f4-152">Tlbimp.exe (Type Library Importer)</span></span>](../tools/tlbimp-exe-type-library-importer.md)
- <span data-ttu-id="b73f4-153">[Personalización de contenedores estándar](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="b73f4-153">[Customizing Standard Wrappers](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100))</span></span>
- <span data-ttu-id="b73f4-154">[Uso de tipos COM en código administrado](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="b73f4-154">[Using COM Types in Managed Code](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span></span>
- [<span data-ttu-id="b73f4-155">Compilar un proyecto de interoperabilidad</span><span class="sxs-lookup"><span data-stu-id="b73f4-155">Compiling an Interop Project</span></span>](compiling-an-interop-project.md)
- [<span data-ttu-id="b73f4-156">Implementar una aplicación interoperativa</span><span class="sxs-lookup"><span data-stu-id="b73f4-156">Deploying an Interop Application</span></span>](deploying-an-interop-application.md)
- [<span data-ttu-id="b73f4-157">Cómo: Agregar referencias a bibliotecas de tipos</span><span class="sxs-lookup"><span data-stu-id="b73f4-157">How to: Add References to Type Libraries</span></span>](how-to-add-references-to-type-libraries.md)
- [<span data-ttu-id="b73f4-158">Cómo: Generar ensamblados de interoperabilidad a partir de bibliotecas de tipos</span><span class="sxs-lookup"><span data-stu-id="b73f4-158">How to: Generate Interop Assemblies from Type Libraries</span></span>](how-to-generate-interop-assemblies-from-type-libraries.md)
