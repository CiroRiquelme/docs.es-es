---
title: IMetaDataDispenserEx::SetOption (Método)
ms.date: 03/30/2017
api_name:
- IMetaDataDispenserEx.SetOption
api_location:
- mscoree.dll
api_type:
- COM
f1_keywords:
- IMetaDataDispenserEx::SetOption
helpviewer_keywords:
- IMetaDataDispenserEx::SetOption method [.NET Framework metadata]
- SetOption method [.NET Framework metadata]
ms.assetid: 9f1c7ccd-7fb2-41d8-aa00-24b823376527
topic_type:
- apiref
ms.openlocfilehash: f8e85a670d04e5825653864484b7ccd9ce747949
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/12/2020
ms.locfileid: "79175907"
---
# <a name="imetadatadispenserexsetoption-method"></a><span data-ttu-id="282fd-102">IMetaDataDispenserEx::SetOption (Método)</span><span class="sxs-lookup"><span data-stu-id="282fd-102">IMetaDataDispenserEx::SetOption Method</span></span>
<span data-ttu-id="282fd-103">Establece la opción especificada en un valor determinado para el ámbito de metadatos actual.</span><span class="sxs-lookup"><span data-stu-id="282fd-103">Sets the specified option to a given value for the current metadata scope.</span></span> <span data-ttu-id="282fd-104">La opción controla cómo se controlan las llamadas al ámbito de metadatos actual.</span><span class="sxs-lookup"><span data-stu-id="282fd-104">The option controls how calls to the current metadata scope are handled.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="282fd-105">Sintaxis</span><span class="sxs-lookup"><span data-stu-id="282fd-105">Syntax</span></span>  
  
```cpp  
HRESULT SetOption (  
    [in] REFGUID optionId,
    [in] const VARIANT *pValue  
);  
```  
  
## <a name="parameters"></a><span data-ttu-id="282fd-106">Parámetros</span><span class="sxs-lookup"><span data-stu-id="282fd-106">Parameters</span></span>  
 `optionId`  
 <span data-ttu-id="282fd-107">[en] Puntero a un GUID que especifica la opción que se va a establecer.</span><span class="sxs-lookup"><span data-stu-id="282fd-107">[in] A pointer to a GUID that specifies the option to be set.</span></span>  
  
 `pValue`  
 <span data-ttu-id="282fd-108">[en] El valor que se va a utilizar para establecer la opción.</span><span class="sxs-lookup"><span data-stu-id="282fd-108">[in] The value to use to set the option.</span></span> <span data-ttu-id="282fd-109">El tipo de este valor debe ser una variante del tipo de la opción especificada.</span><span class="sxs-lookup"><span data-stu-id="282fd-109">The type of this value must be a variant of the specified option's type.</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="282fd-110">Observaciones</span><span class="sxs-lookup"><span data-stu-id="282fd-110">Remarks</span></span>  
 <span data-ttu-id="282fd-111">En la tabla siguiente se enumeran `optionId` los GUID disponibles a los `pValue` que puede apuntar el parámetro y los valores válidos correspondientes para el parámetro.</span><span class="sxs-lookup"><span data-stu-id="282fd-111">The following table lists the available GUIDs that the `optionId` parameter can point to and the corresponding valid values for the `pValue` parameter.</span></span>  
  
|<span data-ttu-id="282fd-112">GUID</span><span class="sxs-lookup"><span data-stu-id="282fd-112">GUID</span></span>|<span data-ttu-id="282fd-113">Descripción</span><span class="sxs-lookup"><span data-stu-id="282fd-113">Description</span></span>|<span data-ttu-id="282fd-114">`pValue`Parámetro</span><span class="sxs-lookup"><span data-stu-id="282fd-114">`pValue` Parameter</span></span>|  
|----------|-----------------|------------------------|  
|<span data-ttu-id="282fd-115">MetaDataCheckDuplicatesFor</span><span class="sxs-lookup"><span data-stu-id="282fd-115">MetaDataCheckDuplicatesFor</span></span>|<span data-ttu-id="282fd-116">Controla qué elementos se comprueban en busca de duplicados.</span><span class="sxs-lookup"><span data-stu-id="282fd-116">Controls which items are checked for duplicates.</span></span> <span data-ttu-id="282fd-117">Cada vez que se llama a un [IMetaDataEmit](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-interface.md) método que crea un nuevo elemento, puede pedir al método para comprobar si el elemento ya existe en el ámbito actual.</span><span class="sxs-lookup"><span data-stu-id="282fd-117">Each time you call an [IMetaDataEmit](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-interface.md) method that creates a new item, you can ask the method to check whether the item already exists in the current scope.</span></span> <span data-ttu-id="282fd-118">Por ejemplo, puede comprobar la `mdMethodDef` existencia de elementos; en este caso, cuando se llama a [IMetaDataEmit::DefineMethod](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-definemethod-method.md), comprobará que el método no existe ya en el ámbito actual.</span><span class="sxs-lookup"><span data-stu-id="282fd-118">For example, you can check for the existence of `mdMethodDef` items; in this case, when you call [IMetaDataEmit::DefineMethod](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-definemethod-method.md), it will check that the method does not already exist in the current scope.</span></span> <span data-ttu-id="282fd-119">Esta comprobación utiliza la clave que identifica de forma única un método determinado: tipo primario, nombre y firma.</span><span class="sxs-lookup"><span data-stu-id="282fd-119">This check uses the key that uniquely identifies a given method: parent type, name, and signature.</span></span>|<span data-ttu-id="282fd-120">Debe ser una variante de tipo UI4 y debe contener una combinación de los valores de la [corCheckDuplicatesFor](../../../../docs/framework/unmanaged-api/metadata/corcheckduplicatesfor-enumeration.md) enumeración.</span><span class="sxs-lookup"><span data-stu-id="282fd-120">Must be a variant of type UI4, and must contain a combination of the values of the [CorCheckDuplicatesFor](../../../../docs/framework/unmanaged-api/metadata/corcheckduplicatesfor-enumeration.md) enumeration.</span></span>|  
|<span data-ttu-id="282fd-121">MetaDataRefToDefCheck</span><span class="sxs-lookup"><span data-stu-id="282fd-121">MetaDataRefToDefCheck</span></span>|<span data-ttu-id="282fd-122">Los controles que hacen referencia a elementos se convierten en definiciones.</span><span class="sxs-lookup"><span data-stu-id="282fd-122">Controls which referenced items are converted to definitions.</span></span> <span data-ttu-id="282fd-123">De forma predeterminada, el motor de metadatos optimizará el código convirtiendo un elemento al que se hace referencia a su definición si el elemento al que se hace referencia se define realmente en el ámbito actual.</span><span class="sxs-lookup"><span data-stu-id="282fd-123">By default, the metadata engine will optimize the code by converting a referenced item to its definition if the referenced item is actually defined in the current scope.</span></span>|<span data-ttu-id="282fd-124">Debe ser una variante de tipo UI4 y debe contener una combinación de los valores de la enumeración [CorRefToDefCheck.](../../../../docs/framework/unmanaged-api/metadata/correftodefcheck-enumeration.md)</span><span class="sxs-lookup"><span data-stu-id="282fd-124">Must be a variant of type UI4, and must contain a combination of the values of the [CorRefToDefCheck](../../../../docs/framework/unmanaged-api/metadata/correftodefcheck-enumeration.md) enumeration.</span></span>|  
|<span data-ttu-id="282fd-125">MetaDataNotificationForTokenMovement</span><span class="sxs-lookup"><span data-stu-id="282fd-125">MetaDataNotificationForTokenMovement</span></span>|<span data-ttu-id="282fd-126">Los controles que los reasignaciones de tokens que se producen durante una combinación de metadatos generan devoluciones de llamada.</span><span class="sxs-lookup"><span data-stu-id="282fd-126">Controls which token remaps occurring during a metadata merge generate callbacks.</span></span> <span data-ttu-id="282fd-127">Utilice el método [IMetaDataEmit::SetHandler](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-sethandler-method.md) para establecer la interfaz [IMapToken.](../../../../docs/framework/unmanaged-api/metadata/imaptoken-interface.md)</span><span class="sxs-lookup"><span data-stu-id="282fd-127">Use the [IMetaDataEmit::SetHandler](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-sethandler-method.md) method to establish your [IMapToken](../../../../docs/framework/unmanaged-api/metadata/imaptoken-interface.md) interface.</span></span>|<span data-ttu-id="282fd-128">Debe ser una variante de tipo UI4 y debe contener una combinación de los valores de la [corNotificationForTokenMovement](../../../../docs/framework/unmanaged-api/metadata/cornotificationfortokenmovement-enumeration.md) enumeración.</span><span class="sxs-lookup"><span data-stu-id="282fd-128">Must be a variant of type UI4, and must contain a combination of the values of the [CorNotificationForTokenMovement](../../../../docs/framework/unmanaged-api/metadata/cornotificationfortokenmovement-enumeration.md) enumeration.</span></span>|  
|<span data-ttu-id="282fd-129">MetaDataSetENC</span><span class="sxs-lookup"><span data-stu-id="282fd-129">MetaDataSetENC</span></span>|<span data-ttu-id="282fd-130">Controla el comportamiento de editar y continuar (ENC).</span><span class="sxs-lookup"><span data-stu-id="282fd-130">Controls the behavior of edit-and-continue (ENC).</span></span> <span data-ttu-id="282fd-131">Solo se puede establecer un modo de comportamiento a la vez.</span><span class="sxs-lookup"><span data-stu-id="282fd-131">Only one mode of behavior can be set at a time.</span></span>|<span data-ttu-id="282fd-132">Debe ser una variante de tipo UI4 y debe contener un valor de la enumeración [CorSetENC.](../../../../docs/framework/unmanaged-api/metadata/corsetenc-enumeration.md)</span><span class="sxs-lookup"><span data-stu-id="282fd-132">Must be a variant of type UI4, and must contain a value of the [CorSetENC](../../../../docs/framework/unmanaged-api/metadata/corsetenc-enumeration.md) enumeration.</span></span> <span data-ttu-id="282fd-133">El valor no es una máscara de bits.</span><span class="sxs-lookup"><span data-stu-id="282fd-133">The value is not a bitmask.</span></span>|  
|<span data-ttu-id="282fd-134">MetaDataErrorifemitOutofOrder</span><span class="sxs-lookup"><span data-stu-id="282fd-134">MetaDataErrorIfEmitOutOfOrder</span></span>|<span data-ttu-id="282fd-135">Controles que los errores emitidos fuera de orden generan devoluciones de llamada.</span><span class="sxs-lookup"><span data-stu-id="282fd-135">Controls which emitted-out-of-order errors generate callbacks.</span></span> <span data-ttu-id="282fd-136">La emisión de metadatos fuera de orden no es fatal; sin embargo, si emite metadatos en un orden que es favorecido por el motor de metadatos, los metadatos son más compactos y, por lo tanto, se pueden buscar de forma más eficaz.</span><span class="sxs-lookup"><span data-stu-id="282fd-136">Emitting metadata out of order is not fatal; however, if you emit metadata in an order that is favored by the metadata engine, the metadata is more compact and therefore can be more efficiently searched.</span></span> <span data-ttu-id="282fd-137">Utilice `IMetaDataEmit::SetHandler` el método para establecer la interfaz [IMetaDataError.](../../../../docs/framework/unmanaged-api/metadata/imetadataerror-interface.md)</span><span class="sxs-lookup"><span data-stu-id="282fd-137">Use the `IMetaDataEmit::SetHandler` method to establish your [IMetaDataError](../../../../docs/framework/unmanaged-api/metadata/imetadataerror-interface.md) interface.</span></span>|<span data-ttu-id="282fd-138">Debe ser una variante de tipo UI4 y debe contener una combinación de los valores de la [corErrorIfEmitOutOfOrder](../../../../docs/framework/unmanaged-api/metadata/corerrorifemitoutoforder-enumeration.md) enumeración.</span><span class="sxs-lookup"><span data-stu-id="282fd-138">Must be a variant of type UI4, and must contain a combination of the values of the [CorErrorIfEmitOutOfOrder](../../../../docs/framework/unmanaged-api/metadata/corerrorifemitoutoforder-enumeration.md) enumeration.</span></span>|  
|<span data-ttu-id="282fd-139">MetaDataImportOption</span><span class="sxs-lookup"><span data-stu-id="282fd-139">MetaDataImportOption</span></span>|<span data-ttu-id="282fd-140">Controla qué tipos de elementos que se eliminaron durante un ENC se recuperan mediante un enumerador.</span><span class="sxs-lookup"><span data-stu-id="282fd-140">Controls which kinds of items that were deleted during an ENC are retrieved by an enumerator.</span></span>|<span data-ttu-id="282fd-141">Debe ser una variante de tipo UI4 y debe contener una combinación de los valores de la [enumeración CorImportOptions Enumeration.](../../../../docs/framework/unmanaged-api/metadata/corimportoptions-enumeration.md)</span><span class="sxs-lookup"><span data-stu-id="282fd-141">Must be a variant of type UI4, and must contain a combination of the values of the [CorImportOptions Enumeration](../../../../docs/framework/unmanaged-api/metadata/corimportoptions-enumeration.md) enumeration.</span></span>|  
|<span data-ttu-id="282fd-142">MetaDataThreadSafetyOptions</span><span class="sxs-lookup"><span data-stu-id="282fd-142">MetaDataThreadSafetyOptions</span></span>|<span data-ttu-id="282fd-143">Controla si el motor de metadatos obtiene bloqueos de lector/escritor, lo que garantiza la seguridad de los subprocesos.</span><span class="sxs-lookup"><span data-stu-id="282fd-143">Controls whether the metadata engine obtains reader/writer locks, thereby ensuring thread safety.</span></span> <span data-ttu-id="282fd-144">De forma predeterminada, el motor supone que el autor de la llamada tiene un solo subproceso, por lo que no se obtieneningún ningún bloqueo.</span><span class="sxs-lookup"><span data-stu-id="282fd-144">By default, the engine assumes that access is single-threaded by the caller, so no locks are obtained.</span></span> <span data-ttu-id="282fd-145">Los clientes son responsables de mantener la sincronización de subprocesos adecuada al usar la API de metadatos.</span><span class="sxs-lookup"><span data-stu-id="282fd-145">Clients are responsible for maintaining proper thread synchronization when using the metadata API.</span></span>|<span data-ttu-id="282fd-146">Debe ser una variante de tipo UI4 y debe contener un valor de la [CorThreadSafetyOptions](../../../../docs/framework/unmanaged-api/metadata/corthreadsafetyoptions-enumeration.md) enumeración.</span><span class="sxs-lookup"><span data-stu-id="282fd-146">Must be a variant of type UI4, and must contain a value of the [CorThreadSafetyOptions](../../../../docs/framework/unmanaged-api/metadata/corthreadsafetyoptions-enumeration.md) enumeration.</span></span> <span data-ttu-id="282fd-147">El valor no es una máscara de bits.</span><span class="sxs-lookup"><span data-stu-id="282fd-147">The value is not a bitmask.</span></span>|  
|<span data-ttu-id="282fd-148">MetaDataGenerateTCEAdapters</span><span class="sxs-lookup"><span data-stu-id="282fd-148">MetaDataGenerateTCEAdapters</span></span>|<span data-ttu-id="282fd-149">Controla si el importador de biblioteca de tipos debe generar los adaptadores de eventos acoplados estrechamente (TCE) para contenedores de punto de conexión COM.</span><span class="sxs-lookup"><span data-stu-id="282fd-149">Controls whether the type library importer should generate the tightly coupled event (TCE) adapters for COM connection point containers.</span></span>|<span data-ttu-id="282fd-150">Debe ser una variante del tipo BOOL.</span><span class="sxs-lookup"><span data-stu-id="282fd-150">Must be a variant of type BOOL.</span></span> <span data-ttu-id="282fd-151">Si `pValue` se `true`establece en , el importador de biblioteca de tipos genera los adaptadores TCE.</span><span class="sxs-lookup"><span data-stu-id="282fd-151">If `pValue` is set to `true`, the type library importer generates the TCE adapters.</span></span>|  
|<span data-ttu-id="282fd-152">MetaDataTypeLibImportNamespace</span><span class="sxs-lookup"><span data-stu-id="282fd-152">MetaDataTypeLibImportNamespace</span></span>|<span data-ttu-id="282fd-153">Especifica un espacio de nombres no predeterminado para la biblioteca de tipos que se está importando.</span><span class="sxs-lookup"><span data-stu-id="282fd-153">Specifies a non-default namespace for the type library that is being imported.</span></span>|<span data-ttu-id="282fd-154">Debe ser un valor nulo o una variante de tipo BSTR.</span><span class="sxs-lookup"><span data-stu-id="282fd-154">Must be either a null value or a variant of type BSTR.</span></span> <span data-ttu-id="282fd-155">Si `pValue` es un valor nulo, el espacio de nombres actual se establece en null; de lo contrario, el espacio de nombres actual se establece en la cadena que se mantiene en el tipo BSTR de la variante.</span><span class="sxs-lookup"><span data-stu-id="282fd-155">If `pValue` is a null value, the current namespace is set to null; otherwise, the current namespace is set to the string that is held in the variant's BSTR type.</span></span>|  
|<span data-ttu-id="282fd-156">MetaDataLinkerOptions</span><span class="sxs-lookup"><span data-stu-id="282fd-156">MetaDataLinkerOptions</span></span>|<span data-ttu-id="282fd-157">Controla si el vinculador debe generar un ensamblado o un archivo de módulo de .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="282fd-157">Controls whether the linker should generate an assembly or a .NET Framework module file.</span></span>|<span data-ttu-id="282fd-158">Debe ser una variante de tipo UI4 y debe contener una combinación de los valores de la [corLinkerOptions](../../../../docs/framework/unmanaged-api/metadata/corlinkeroptions-enumeration.md) enumeración.</span><span class="sxs-lookup"><span data-stu-id="282fd-158">Must be a variant of type UI4, and must contain a combination of the values of the [CorLinkerOptions](../../../../docs/framework/unmanaged-api/metadata/corlinkeroptions-enumeration.md) enumeration.</span></span>|  
|<span data-ttu-id="282fd-159">MetaDataRuntimeVersion</span><span class="sxs-lookup"><span data-stu-id="282fd-159">MetaDataRuntimeVersion</span></span>|<span data-ttu-id="282fd-160">Especifica la versión de Common Language Runtime en la que se creó esta imagen.</span><span class="sxs-lookup"><span data-stu-id="282fd-160">Specifies the version of the common language runtime against which this image was built.</span></span> <span data-ttu-id="282fd-161">La versión se almacena como una cadena, como "v1.0.3705".</span><span class="sxs-lookup"><span data-stu-id="282fd-161">The version is stored as a string, such as "v1.0.3705".</span></span>|<span data-ttu-id="282fd-162">Debe ser un valor nulo, un valor VT_EMPTY o una variante de tipo BSTR.</span><span class="sxs-lookup"><span data-stu-id="282fd-162">Must be a null value, a VT_EMPTY value, or a variant of type BSTR.</span></span> <span data-ttu-id="282fd-163">Si `pValue` es null, la versión en tiempo de ejecución se establece en null.</span><span class="sxs-lookup"><span data-stu-id="282fd-163">If `pValue` is null, the runtime version is set to null.</span></span> <span data-ttu-id="282fd-164">Si `pValue` se VT_EMPTY, la versión se establece en un valor predeterminado, que se extrae de la versión de Mscorwks.dll dentro de la cual se ejecuta el código de metadatos.</span><span class="sxs-lookup"><span data-stu-id="282fd-164">If `pValue` is VT_EMPTY, the version is set to a default value, which is drawn from the version of Mscorwks.dll within which the metadata code is running.</span></span> <span data-ttu-id="282fd-165">De lo contrario, la versión en tiempo de ejecución se establece en la cadena que se mantiene en el tipo BSTR de la variante.</span><span class="sxs-lookup"><span data-stu-id="282fd-165">Otherwise, the runtime version is set to the string that is held in the variant's BSTR type.</span></span>|  
|<span data-ttu-id="282fd-166">MetaDataMergerOptions</span><span class="sxs-lookup"><span data-stu-id="282fd-166">MetaDataMergerOptions</span></span>|<span data-ttu-id="282fd-167">Especifica las opciones para combinar metadatos.</span><span class="sxs-lookup"><span data-stu-id="282fd-167">Specifies options for merging metadata.</span></span>|<span data-ttu-id="282fd-168">Debe ser una variante de tipo UI4 y debe `MergeFlags` contener una combinación de los valores de la enumeración, que se describe en el archivo CorHdr.h.</span><span class="sxs-lookup"><span data-stu-id="282fd-168">Must be a variant of type UI4, and must contain a combination of the values of the `MergeFlags` enumeration, which is described in the CorHdr.h file.</span></span>|  
|<span data-ttu-id="282fd-169">MetaDataPreserveLocalRefs</span><span class="sxs-lookup"><span data-stu-id="282fd-169">MetaDataPreserveLocalRefs</span></span>|<span data-ttu-id="282fd-170">Deshabilita la optimización de referencias locales en definiciones.</span><span class="sxs-lookup"><span data-stu-id="282fd-170">Disables optimizing local references into definitions.</span></span>|<span data-ttu-id="282fd-171">Debe contener una combinación de los valores de la [corLocalRefPreservation](../../../../docs/framework/unmanaged-api/metadata/corlocalrefpreservation-enumeration.md) enumeración.</span><span class="sxs-lookup"><span data-stu-id="282fd-171">Must contain a combination of the values of the [CorLocalRefPreservation](../../../../docs/framework/unmanaged-api/metadata/corlocalrefpreservation-enumeration.md) enumeration.</span></span>|  
  
## <a name="requirements"></a><span data-ttu-id="282fd-172">Requisitos</span><span class="sxs-lookup"><span data-stu-id="282fd-172">Requirements</span></span>  
 <span data-ttu-id="282fd-173">**Plataforma:** Consulte [Requisitos del sistema](../../../../docs/framework/get-started/system-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="282fd-173">**Platform:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).</span></span>  
  
 <span data-ttu-id="282fd-174">**Encabezado:** Cor.h</span><span class="sxs-lookup"><span data-stu-id="282fd-174">**Header:** Cor.h</span></span>  
  
 <span data-ttu-id="282fd-175">**Biblioteca:** Se utiliza como recurso en MsCorEE.dll</span><span class="sxs-lookup"><span data-stu-id="282fd-175">**Library:** Used as a resource in MsCorEE.dll</span></span>  
  
 <span data-ttu-id="282fd-176">**Versiones de .NET Framework:** [!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]</span><span class="sxs-lookup"><span data-stu-id="282fd-176">**.NET Framework Versions:** [!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="282fd-177">Consulte también</span><span class="sxs-lookup"><span data-stu-id="282fd-177">See also</span></span>

- [<span data-ttu-id="282fd-178">IMetaDataDispenserEx (Interfaz)</span><span class="sxs-lookup"><span data-stu-id="282fd-178">IMetaDataDispenserEx Interface</span></span>](../../../../docs/framework/unmanaged-api/metadata/imetadatadispenserex-interface.md)
- [<span data-ttu-id="282fd-179">IMetaDataDispenser (interfaz)</span><span class="sxs-lookup"><span data-stu-id="282fd-179">IMetaDataDispenser Interface</span></span>](../../../../docs/framework/unmanaged-api/metadata/imetadatadispenser-interface.md)
