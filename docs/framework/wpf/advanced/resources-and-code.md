---
title: Recursos y código
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- keys [WPF], using objects as
- resources [WPF], accessing from procedural code
- procedural code [WPF], creating resources with
- procedural code [WPF], accessing resources from
- resources [WPF], creating with procedural code
ms.assetid: c1cfcddb-e39c-41c8-a7f3-60984914dfae
ms.openlocfilehash: 11903a9bae25b0646d944fb11038e07434996015
ms.sourcegitcommit: f8c36054eab877de4d40a705aacafa2552ce70e9
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 12/31/2019
ms.locfileid: "75559760"
---
# <a name="resources-and-code"></a><span data-ttu-id="0f9dc-102">Recursos y código</span><span class="sxs-lookup"><span data-stu-id="0f9dc-102">Resources and Code</span></span>
<span data-ttu-id="0f9dc-103">Esta información general se centra en cómo obtener acceso a los recursos de [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] o crearlos mediante código en lugar de sintaxis [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0f9dc-103">This overview concentrates on how [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] resources can be accessed or created using  code rather than [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] syntax.</span></span> <span data-ttu-id="0f9dc-104">Para obtener más información sobre el uso de recursos generales y recursos desde una perspectiva de la sintaxis [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], consulte [Recursos XAML](xaml-resources.md).</span><span class="sxs-lookup"><span data-stu-id="0f9dc-104">For more information on general resource usage and resources from a [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] syntax perspective, see [XAML Resources](xaml-resources.md).</span></span>  

<a name="accessing"></a>   
## <a name="accessing-resources-from-code"></a><span data-ttu-id="0f9dc-105">Obtener acceso a recursos desde código</span><span class="sxs-lookup"><span data-stu-id="0f9dc-105">Accessing Resources from Code</span></span>  
 <span data-ttu-id="0f9dc-106">Las claves que identifican los recursos si se definen mediante [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] también se usan para recuperar recursos específicos si solicita el recurso en el código.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-106">The keys that identify resources if they are defined through [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] are also used to retrieve specific resources if you request the resource in code.</span></span> <span data-ttu-id="0f9dc-107">La manera más sencilla de recuperar un recurso desde el código es llamar al método <xref:System.Windows.FrameworkElement.FindResource%2A> o <xref:System.Windows.FrameworkElement.TryFindResource%2A> desde objetos de nivel de marco de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-107">The simplest way to retrieve a resource from code is to call either the <xref:System.Windows.FrameworkElement.FindResource%2A> or the <xref:System.Windows.FrameworkElement.TryFindResource%2A> method from framework-level objects in your application.</span></span> <span data-ttu-id="0f9dc-108">La diferencia de comportamiento entre estos métodos es lo que ocurre si no se encuentra la clave solicitada.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-108">The behavioral difference between these methods is what happens if the requested key is not found.</span></span> <span data-ttu-id="0f9dc-109"><xref:System.Windows.FrameworkElement.FindResource%2A> produce una excepción; <xref:System.Windows.FrameworkElement.TryFindResource%2A> no producirá una excepción, pero devolverá `null`.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-109"><xref:System.Windows.FrameworkElement.FindResource%2A> raises an exception; <xref:System.Windows.FrameworkElement.TryFindResource%2A> will not raise an exception but returns `null`.</span></span> <span data-ttu-id="0f9dc-110">Cada método obtiene la clave de recurso como parámetro de entrada y devuelve un objeto escrito de manera imprecisa.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-110">Each method takes the resource key as an input parameter, and returns a loosely typed object.</span></span> <span data-ttu-id="0f9dc-111">Normalmente, una clave de recurso es una cadena, pero hay usos ocasionales en los que no. Consulte la sección [Usar objetos como claves](#objectaskey) para obtener más información.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-111">Typically, a resource key is a string, but there are occasional nonstring usages; see the [Using Objects as Keys](#objectaskey) section for details.</span></span> <span data-ttu-id="0f9dc-112">Normalmente, convertiría el objeto devuelto al tipo que necesita la propiedad que está estableciendo al solicitar el recurso.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-112">Typically you would cast the returned object to the type required by the property that you are setting when requesting the resource.</span></span> <span data-ttu-id="0f9dc-113">La lógica de búsqueda para la resolución de recursos de código es la misma que la del caso [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] de referencia de recursos dinámicos.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-113">The lookup logic for code resource resolution is the same as the dynamic resource reference [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] case.</span></span> <span data-ttu-id="0f9dc-114">La búsqueda de recursos comienza desde el elemento que realiza la llamada y continúa hasta los elementos principales sucesivos del árbol lógico.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-114">The search for resources starts from the calling element, then continues to successive parent elements in the logical tree.</span></span> <span data-ttu-id="0f9dc-115">La búsqueda continúa hasta los recursos de la aplicación, los temas y los recursos del sistema, si es necesario.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-115">The lookup continues onwards into application resources, themes, and system resources if necessary.</span></span> <span data-ttu-id="0f9dc-116">Una solicitud de código para un recurso representará correctamente los cambios en tiempo de ejecución en diccionarios de recursos que puedan haberse realizado después de que se cargara el diccionario desde [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] y también para cambios de recursos del sistema en tiempo real.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-116">A code request for a resource will properly account for runtime changes in resource dictionaries that might have been made subsequent to that resource dictionary being loaded from [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], and also for realtime system resource changes.</span></span>  
  
 <span data-ttu-id="0f9dc-117">A continuación se encuentra un breve ejemplo de código que encuentra un recurso por clave y usa el valor devuelto para establecer una propiedad, implementada como un controlador de eventos <xref:System.Windows.Controls.Primitives.ButtonBase.Click>.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-117">The following is a brief code example that finds a resource by key and uses the returned value to set a property, implemented as a <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler.</span></span>  
  
 [!code-csharp[PropertiesOvwSupport#ResourceProceduralGet](~/samples/snippets/csharp/VS_Snippets_Wpf/PropertiesOvwSupport/CSharp/page3.xaml.cs#resourceproceduralget)]
 [!code-vb[PropertiesOvwSupport#ResourceProceduralGet](~/samples/snippets/visualbasic/VS_Snippets_Wpf/PropertiesOvwSupport/visualbasic/page3.xaml.vb#resourceproceduralget)]  
  
 <span data-ttu-id="0f9dc-118">Un método alternativo para asignar una referencia de recurso es <xref:System.Windows.FrameworkElement.SetResourceReference%2A>.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-118">An alternative method for assigning a resource reference is <xref:System.Windows.FrameworkElement.SetResourceReference%2A>.</span></span> <span data-ttu-id="0f9dc-119">Este método usa dos parámetros: la clave del recurso y el identificador de una propiedad de dependencia determinada que existe en la instancia del elemento al que se debe asignar el valor del recurso.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-119">This method takes two parameters: the key of the resource, and the identifier for a particular dependency property that is present on the element instance to which the resource value should be assigned.</span></span> <span data-ttu-id="0f9dc-120">Funcionalmente, este método es el mismo y tiene la ventaja de que no necesita ninguna conversión de valores devueltos.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-120">Functionally, this method is the same and has the advantage of not requiring any casting of return values.</span></span>  
  
 <span data-ttu-id="0f9dc-121">Otra manera de obtener acceso a los recursos mediante programación es acceder al contenido de la propiedad <xref:System.Windows.FrameworkElement.Resources%2A> como un diccionario.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-121">Still another way to access resources programmatically is to access the contents of the <xref:System.Windows.FrameworkElement.Resources%2A> property as a dictionary.</span></span> <span data-ttu-id="0f9dc-122">Obtener acceso al diccionario que contiene esta propiedad también es el modo de agregar nuevos recursos a las colecciones existentes, comprobar si el nombre de una clave ya existe en la colección y otras operaciones de diccionario o colección.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-122">Accessing the dictionary contained by this property is also how you can add new resources to existing collections, check to see if a given key name is already taken in the collection, and other dictionary/collection operations.</span></span> <span data-ttu-id="0f9dc-123">Si está escribiendo una aplicación [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] completamente en el código, también puede crear toda la colección en el código, asignarle claves y, a continuación, asignar la colección terminada a la propiedad <xref:System.Windows.FrameworkElement.Resources%2A> de un elemento establecido.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-123">If you are writing a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application entirely in code, you can also create the entire collection in code, assign keys to it, and then assign the finished collection to the <xref:System.Windows.FrameworkElement.Resources%2A> property of an established element.</span></span> <span data-ttu-id="0f9dc-124">Esto se describe en la sección siguiente.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-124">This will be described in the next section.</span></span>  
  
 <span data-ttu-id="0f9dc-125">Puede indexar dentro de cualquier colección de <xref:System.Windows.FrameworkElement.Resources%2A> determinada, utilizando una clave específica como índice, pero debe tener en cuenta que el acceso al recurso de esta manera no sigue las reglas de tiempo de ejecución normales de la resolución de recursos.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-125">You can index within any given <xref:System.Windows.FrameworkElement.Resources%2A> collection, using a specific key as the index, but you should be aware that accessing the resource in this way does not follow the normal runtime rules of resource resolution.</span></span> <span data-ttu-id="0f9dc-126">Solo obtiene acceso a esa colección concreta.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-126">You are only accessing that particular collection.</span></span> <span data-ttu-id="0f9dc-127">La búsqueda de recursos no recorrerá el ámbito hasta la raíz o aplicación si no se encuentra ningún objeto válido en la clave solicitada.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-127">Resource lookup will not be traversing the scope to the root or the application if no valid object was found at the requested key.</span></span> <span data-ttu-id="0f9dc-128">Sin embargo, este enfoque puede tener ventajas de rendimiento en algunos casos, precisamente porque el ámbito de la búsqueda de la clave está más restringido.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-128">However, this approach may have performance advantages in some cases precisely because the scope of the search for the key is more constrained.</span></span> <span data-ttu-id="0f9dc-129">Vea la clase <xref:System.Windows.ResourceDictionary> para obtener más información sobre cómo trabajar directamente con el Diccionario de recursos.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-129">See the <xref:System.Windows.ResourceDictionary> class for more details on how to work with the resource dictionary directly.</span></span>  
  
<a name="creating"></a>   
## <a name="creating-resources-with-code"></a><span data-ttu-id="0f9dc-130">Crear recursos mediante código</span><span class="sxs-lookup"><span data-stu-id="0f9dc-130">Creating Resources with Code</span></span>  
 <span data-ttu-id="0f9dc-131">Si quiere crear toda una aplicación [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] con código, también es posible que quiera crear los recursos de la aplicación con código.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-131">If you want to create an entire [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application in code, you might also want to create any resources in that application in code.</span></span> <span data-ttu-id="0f9dc-132">Para ello, cree una nueva instancia de <xref:System.Windows.ResourceDictionary> y, a continuación, agregue todos los recursos al diccionario mediante llamadas sucesivas a <xref:System.Windows.ResourceDictionary.Add%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-132">To achieve this, create a new <xref:System.Windows.ResourceDictionary> instance, and then add all the resources to the dictionary using successive calls to <xref:System.Windows.ResourceDictionary.Add%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="0f9dc-133">A continuación, use el <xref:System.Windows.ResourceDictionary> creado para establecer la propiedad <xref:System.Windows.FrameworkElement.Resources%2A> en un elemento que se encuentra en un ámbito de página o en el <xref:System.Windows.Application.Resources%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-133">Then, use the <xref:System.Windows.ResourceDictionary> thus created to set the <xref:System.Windows.FrameworkElement.Resources%2A> property on an element that is present in a page scope, or the <xref:System.Windows.Application.Resources%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="0f9dc-134">También puede mantener el <xref:System.Windows.ResourceDictionary> como un objeto independiente sin agregarlo a un elemento.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-134">You could also maintain the <xref:System.Windows.ResourceDictionary> as a standalone object without adding it to an element.</span></span> <span data-ttu-id="0f9dc-135">Sin embargo, si lo hace, deberá obtener acceso a los recursos que contenga mediante clave de producto, como si fuera un diccionario genérico.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-135">However, if you do this, you must access the resources within it by item key, as if it were a generic dictionary.</span></span> <span data-ttu-id="0f9dc-136">Un <xref:System.Windows.ResourceDictionary> que no está asociado a un elemento `Resources` propiedad no existirá como parte del árbol de elementos y no tiene ámbito en una secuencia de búsqueda que se pueda usar en <xref:System.Windows.FrameworkElement.FindResource%2A> y métodos relacionados.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-136">A <xref:System.Windows.ResourceDictionary> that is not attached to an element `Resources` property would not  exist as part of the element tree and has no scope in a lookup sequence that can be used by <xref:System.Windows.FrameworkElement.FindResource%2A> and related methods.</span></span>  
  
<a name="objectaskey"></a>   
## <a name="using-objects-as-keys"></a><span data-ttu-id="0f9dc-137">Usar objetos como claves</span><span class="sxs-lookup"><span data-stu-id="0f9dc-137">Using Objects as Keys</span></span>  
 <span data-ttu-id="0f9dc-138">La mayoría de los usos de recursos establecen la clave de recurso en una cadena.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-138">Most resource usages will set the key of the resource to be a string.</span></span> <span data-ttu-id="0f9dc-139">Sin embargo, varias características de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] no usan deliberadamente un tipo de cadena para especificar las claves. En su lugar, este parámetro es un objeto.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-139">However, various [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] features deliberately do not use a string type to specify keys, instead this parameter is an object.</span></span> <span data-ttu-id="0f9dc-140">La compatibilidad de temas y estilos de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] aprovecha la funcionalidad de que un objeto asigne la clave a un recurso.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-140">The capability of having the resource be keyed by an object is used by the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] style and theming support.</span></span> <span data-ttu-id="0f9dc-141">Los estilos de los temas que se convierten en el estilo predeterminado de un control sin estilo, cada uno con la clave <xref:System.Type> del control al que deben aplicarse.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-141">The styles in themes which become the default style for an otherwise non-styled control are each keyed by the <xref:System.Type> of the control that they should apply to.</span></span> <span data-ttu-id="0f9dc-142">Asignar claves por tipo proporciona un mecanismo de búsqueda confiable que funciona en instancias predeterminadas de cada tipo de control. La reflexión puede detectar el tipo y usarlo para clases derivadas de estilo aunque el tipo derivado no tenga ningún estilo predeterminado.</span><span class="sxs-lookup"><span data-stu-id="0f9dc-142">Being keyed by type provides a reliable lookup mechanism that works on default instances of each control type, and type can be detected by reflection and used for styling derived classes even though the derived type otherwise has no default style.</span></span> <span data-ttu-id="0f9dc-143">Puede especificar una clave de <xref:System.Type> para un recurso definido en [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] mediante la [extensión de marcado x:Type](../../../desktop-wpf/xaml-services/xtype-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="0f9dc-143">You can specify a <xref:System.Type> key for a resource defined in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] by using the [x:Type Markup Extension](../../../desktop-wpf/xaml-services/xtype-markup-extension.md).</span></span> <span data-ttu-id="0f9dc-144">Existen extensiones similares para otros usos de clave que no son cadenas que admiten características de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], como [ComponentResourceKey (extensión de marcado)](componentresourcekey-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="0f9dc-144">Similar extensions exist for other nonstring key usages that support [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] features, such as [ComponentResourceKey Markup Extension](componentresourcekey-markup-extension.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0f9dc-145">Vea también</span><span class="sxs-lookup"><span data-stu-id="0f9dc-145">See also</span></span>

- [<span data-ttu-id="0f9dc-146">Recursos XAML</span><span class="sxs-lookup"><span data-stu-id="0f9dc-146">XAML Resources</span></span>](xaml-resources.md)
- [<span data-ttu-id="0f9dc-147">Aplicar estilos y plantillas</span><span class="sxs-lookup"><span data-stu-id="0f9dc-147">Styling and Templating</span></span>](../../../desktop-wpf/fundamentals/styles-templates-overview.md)
