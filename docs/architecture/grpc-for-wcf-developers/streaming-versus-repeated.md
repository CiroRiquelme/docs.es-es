---
title: Servicios de streaming frente a campos repetidos - gRPC para desarrolladores de WCF
description: Compare los campos repetidos con los servicios de streaming como formas de pasar colecciones de datos mediante gRPC.
ms.date: 09/02/2019
ms.openlocfilehash: 542ebc393f9c9c1ad717d02d01fab33d85c18917
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/12/2020
ms.locfileid: "79147755"
---
# <a name="grpc-streaming-services-vs-repeated-fields"></a><span data-ttu-id="dd2bb-103">Comparación entre servicios de streaming de gRPC y campos repetidos</span><span class="sxs-lookup"><span data-stu-id="dd2bb-103">gRPC streaming services vs. repeated fields</span></span>

<span data-ttu-id="dd2bb-104">Los servicios gRPC proporcionan dos formas de devolver conjuntos de datos o listas de objetos.</span><span class="sxs-lookup"><span data-stu-id="dd2bb-104">gRPC services provide two ways of returning datasets, or lists of objects.</span></span> <span data-ttu-id="dd2bb-105">La especificación de mensaje `repeated` Zonas de búferes de protocolo utiliza la palabra clave para declarar listas o matrices de mensajes dentro de otro mensaje.</span><span class="sxs-lookup"><span data-stu-id="dd2bb-105">The Protocol Buffers message specification uses the `repeated` keyword for declaring lists or arrays of messages within another message.</span></span> <span data-ttu-id="dd2bb-106">La especificación de `stream` servicio gRPC utiliza la palabra clave para declarar una conexión persistente de larga ejecución.</span><span class="sxs-lookup"><span data-stu-id="dd2bb-106">The gRPC service specification uses the `stream` keyword to declare a long-running persistent connection.</span></span> <span data-ttu-id="dd2bb-107">A través de esa conexión, se envían varios mensajes y se pueden procesar individualmente.</span><span class="sxs-lookup"><span data-stu-id="dd2bb-107">Over that connection, multiple messages are sent, and can be processed, individually.</span></span>

<span data-ttu-id="dd2bb-108">También puede utilizar `stream` la característica para datos temporales de ejecución prolongada, como notificaciones o mensajes de registro.</span><span class="sxs-lookup"><span data-stu-id="dd2bb-108">You can also use the `stream` feature for long-running temporal data such as notifications or log messages.</span></span> <span data-ttu-id="dd2bb-109">Pero este capítulo considerará su uso para devolver un único conjunto de datos.</span><span class="sxs-lookup"><span data-stu-id="dd2bb-109">But this chapter will consider its use for returning a single dataset.</span></span>

<span data-ttu-id="dd2bb-110">El que debe usar depende de factores tales como:</span><span class="sxs-lookup"><span data-stu-id="dd2bb-110">Which you should use depends on factors such as:</span></span>

- <span data-ttu-id="dd2bb-111">El tamaño total del conjunto de datos.</span><span class="sxs-lookup"><span data-stu-id="dd2bb-111">The overall size of the dataset.</span></span>
- <span data-ttu-id="dd2bb-112">El tiempo que se tardó en crear el conjunto de datos en el extremo del cliente o del servidor.</span><span class="sxs-lookup"><span data-stu-id="dd2bb-112">The time it took to create the dataset at either the client or server end.</span></span>
- <span data-ttu-id="dd2bb-113">Si el consumidor del conjunto de datos puede empezar a actuar en él tan pronto como el primer elemento está disponible o necesita el conjunto de datos completo para hacer algo útil.</span><span class="sxs-lookup"><span data-stu-id="dd2bb-113">Whether the consumer of the dataset can start acting on it as soon as the first item is available, or needs the complete dataset to do anything useful.</span></span>

## <a name="when-to-use-repeated-fields"></a><span data-ttu-id="dd2bb-114">Cuándo usar `repeated` campos</span><span class="sxs-lookup"><span data-stu-id="dd2bb-114">When to use `repeated` fields</span></span>

<span data-ttu-id="dd2bb-115">Para cualquier conjunto de datos que esté restringido en tamaño y que se pueda generar en su totalidad `repeated` en poco tiempo (por ejemplo, en menos de un segundo), debe usar un campo en un mensaje Protobuf normal.</span><span class="sxs-lookup"><span data-stu-id="dd2bb-115">For any dataset that's constrained in size and that can be generated in its entirety in a short time—say, under one second—you should use a `repeated` field in a regular Protobuf message.</span></span> <span data-ttu-id="dd2bb-116">Por ejemplo, en un sistema de comercio electrónico, crear una lista de elementos dentro de un pedido es probablemente rápido y la lista no será muy grande.</span><span class="sxs-lookup"><span data-stu-id="dd2bb-116">For example, in an e-commerce system, to build a list of items within an order is probably quick and the list won't be very large.</span></span> <span data-ttu-id="dd2bb-117">Devolver un único mensaje `repeated` con un campo es `stream` un orden de magnitud más rápido que usar e incurre en menos sobrecarga de red.</span><span class="sxs-lookup"><span data-stu-id="dd2bb-117">Returning a single message with a `repeated` field is an order of magnitude faster than using `stream` and incurs less network overhead.</span></span>

<span data-ttu-id="dd2bb-118">Si el cliente necesita todos los datos antes de empezar a procesarlos y `repeated` el conjunto de datos es lo suficientemente pequeño como para construirlo en memoria, considere la posibilidad de usar un campo.</span><span class="sxs-lookup"><span data-stu-id="dd2bb-118">If the client needs all the data before starting to process it and the dataset is small enough to construct in memory, then consider using a `repeated` field.</span></span> <span data-ttu-id="dd2bb-119">Considérelo incluso si la creación del conjunto de datos en memoria en el servidor es más lenta.</span><span class="sxs-lookup"><span data-stu-id="dd2bb-119">Consider it even if the creation of the dataset in memory on the server is slower.</span></span>

## <a name="when-to-use-stream-methods"></a><span data-ttu-id="dd2bb-120">Cuándo usar `stream` métodos</span><span class="sxs-lookup"><span data-stu-id="dd2bb-120">When to use `stream` methods</span></span>

<span data-ttu-id="dd2bb-121">Cuando los objetos de mensaje de los conjuntos de datos son potencialmente muy grandes, es mejor transferirlos mediante solicitudes o respuestas de streaming.</span><span class="sxs-lookup"><span data-stu-id="dd2bb-121">When the message objects in your datasets are potentially very large, it's best for you transfer them by using streaming requests or responses.</span></span> <span data-ttu-id="dd2bb-122">Es más eficaz construir un objeto grande en la memoria, escribirlo en la red y, a continuación, liberar los recursos.</span><span class="sxs-lookup"><span data-stu-id="dd2bb-122">It's more efficient to construct a large object in memory, write it to the network, and then free up the resources.</span></span> <span data-ttu-id="dd2bb-123">Este enfoque mejorará la escalabilidad de su servicio.</span><span class="sxs-lookup"><span data-stu-id="dd2bb-123">This approach will improve the scalability of your service.</span></span>

<span data-ttu-id="dd2bb-124">De forma similar, debe enviar conjuntos de datos de tamaño sin restricciones sobre secuencias para evitar quedarse sin memoria mientras se construyen.</span><span class="sxs-lookup"><span data-stu-id="dd2bb-124">Similarly, you should send datasets of unconstrained size over streams to avoid running out of memory while constructing them.</span></span>

<span data-ttu-id="dd2bb-125">Para los conjuntos de datos donde el consumidor puede procesar por separado cada elemento, debe considerar el uso de una secuencia si significa que el progreso se puede indicar al usuario.</span><span class="sxs-lookup"><span data-stu-id="dd2bb-125">For datasets where the consumer can separately process each item, you should consider using a stream if it means that progress can be indicated to the user.</span></span> <span data-ttu-id="dd2bb-126">El uso de una secuencia puede mejorar la capacidad de respuesta de una aplicación, pero debe equilibrarla con el rendimiento general de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="dd2bb-126">Using a stream can improve the responsiveness of an application, but you should balance it against the overall performance of the application.</span></span>

<span data-ttu-id="dd2bb-127">Otro escenario donde las secuencias pueden ser útiles es donde se procesa un mensaje en varios servicios.</span><span class="sxs-lookup"><span data-stu-id="dd2bb-127">Another scenario where streams can be useful is where a message is being processed across multiple services.</span></span> <span data-ttu-id="dd2bb-128">Si cada servicio de una cadena devuelve una secuencia, el servicio de terminal (es decir, el último de la cadena) puede empezar a devolver mensajes.</span><span class="sxs-lookup"><span data-stu-id="dd2bb-128">If each service in a chain returns a stream, then the terminal service (that is, the last one in the chain) can start returning messages.</span></span> <span data-ttu-id="dd2bb-129">Estos mensajes se pueden procesar y devolver a lo largo de la cadena al solicitante original.</span><span class="sxs-lookup"><span data-stu-id="dd2bb-129">These messages can be processed and passed back along the chain to the original requestor.</span></span> <span data-ttu-id="dd2bb-130">El solicitante puede devolver una secuencia o agregar los resultados en un único mensaje de respuesta.</span><span class="sxs-lookup"><span data-stu-id="dd2bb-130">The requestor can either return a stream or aggregate the results into a single response message.</span></span> <span data-ttu-id="dd2bb-131">Este enfoque se presta bien a patrones como MapReduce.</span><span class="sxs-lookup"><span data-stu-id="dd2bb-131">This approach lends itself well to patterns like MapReduce.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="dd2bb-132">[Anterior](migrate-duplex-services.md)
>[Siguiente](client-libraries.md)</span><span class="sxs-lookup"><span data-stu-id="dd2bb-132">[Previous](migrate-duplex-services.md)
[Next](client-libraries.md)</span></span>
