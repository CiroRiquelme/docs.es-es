---
title: Arquitectura de las herramientas de la línea de comandos de .NET Core
description: Obtenga información sobre las capas de herramientas de .NET Core y sobre lo que ha cambiado en versiones recientes.
ms.date: 03/06/2017
ms.openlocfilehash: e1a9fe59225c17d54f6e7213d2b3c3fa70ee58e0
ms.sourcegitcommit: 73aa9653547a1cd70ee6586221f79cc29b588ebd
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 04/23/2020
ms.locfileid: "82102884"
---
# <a name="high-level-overview-of-changes-in-the-net-core-tools"></a><span data-ttu-id="c397a-103">Introducción de alto nivel de los cambios en las herramientas de .NET Core</span><span class="sxs-lookup"><span data-stu-id="c397a-103">High-level overview of changes in the .NET Core tools</span></span>

<span data-ttu-id="c397a-104">En este documento se describen los cambios asociados con el traslado de *project.json* a MSBuild y al sistema del proyecto *csproj* con información sobre los cambios realizados en las capas de las herramientas de .NET Core y en la implementación de los comandos de la CLI.</span><span class="sxs-lookup"><span data-stu-id="c397a-104">This document describes the changes associated with moving from *project.json* to MSBuild and the *csproj* project system with information on the changes to the layering of the .NET Core tooling and the implementation of the CLI commands.</span></span> <span data-ttu-id="c397a-105">Estos cambios se han producido con la versión de .NET Core SDK 1.0 y Visual Studio 2017 de 7 de marzo de 2017 (vea el [anuncio](https://devblogs.microsoft.com/dotnet/announcing-net-core-tools-1-0/)), pero se han implementado inicialmente con la versión de .NET Core SDK Preview 3.</span><span class="sxs-lookup"><span data-stu-id="c397a-105">These changes occurred with the release of .NET Core SDK 1.0 and Visual Studio 2017 on March 7, 2017 (see the [announcement](https://devblogs.microsoft.com/dotnet/announcing-net-core-tools-1-0/)) but were initially implemented with the release of the .NET Core SDK Preview 3.</span></span>

## <a name="moving-away-from-projectjson"></a><span data-ttu-id="c397a-106">Abandono de project.json</span><span class="sxs-lookup"><span data-stu-id="c397a-106">Moving away from project.json</span></span>

<span data-ttu-id="c397a-107">El cambio más importante en las herramientas para .NET Core es ciertamente el [abandono de project.json en favor de csproj](https://devblogs.microsoft.com/dotnet/changes-to-project-json/) como sistema de proyectos.</span><span class="sxs-lookup"><span data-stu-id="c397a-107">The biggest change in the tooling for .NET Core is certainly the [move away from project.json to csproj](https://devblogs.microsoft.com/dotnet/changes-to-project-json/) as the project system.</span></span> <span data-ttu-id="c397a-108">Las últimas versiones de las herramientas de línea de comandos no admiten archivos *project.json*.</span><span class="sxs-lookup"><span data-stu-id="c397a-108">The latest versions of the command-line tools don't support *project.json* files.</span></span> <span data-ttu-id="c397a-109">Esto significa que no puede utilizarse para compilar, ejecutar o publicar bibliotecas y aplicaciones basadas en project.json.</span><span class="sxs-lookup"><span data-stu-id="c397a-109">That means that it cannot be used to build, run, or publish project.json based applications and libraries.</span></span> <span data-ttu-id="c397a-110">Para utilizar esta versión de las herramientas, migre los proyectos existentes o inicie otros nuevos.</span><span class="sxs-lookup"><span data-stu-id="c397a-110">To use this version of the tools, migrate your existing projects or start new ones.</span></span>

<span data-ttu-id="c397a-111">Como parte de este proceso, el motor de compilación personalizado que se desarrolló para compilar proyectos de project.json se ha reemplazado por un motor de compilación maduro y totalmente compatible llamado [MSBuild](https://github.com/Microsoft/msbuild).</span><span class="sxs-lookup"><span data-stu-id="c397a-111">As part of this move, the custom build engine that was developed to build project.json projects was replaced with a mature and fully capable build engine called [MSBuild](https://github.com/Microsoft/msbuild).</span></span> <span data-ttu-id="c397a-112">MSBuild es un motor conocido en la comunidad de .NET.</span><span class="sxs-lookup"><span data-stu-id="c397a-112">MSBuild is a well-known engine in the .NET community.</span></span> <span data-ttu-id="c397a-113">Ha sido una tecnología clave desde la primera versión de la plataforma.</span><span class="sxs-lookup"><span data-stu-id="c397a-113">It has been a key technology since the platform's first release.</span></span> <span data-ttu-id="c397a-114">Puesto que debe compilar aplicaciones .NET Core, MSBuild se ha trasladado a .NET Core y puede utilizarse en cualquier plataforma donde se ejecute .NET Core.</span><span class="sxs-lookup"><span data-stu-id="c397a-114">Because it needs to build .NET Core applications, MSBuild has been ported to .NET Core and can be used on any platform that .NET Core runs on.</span></span> <span data-ttu-id="c397a-115">Una de las promesas principales de .NET Core es una pila de desarrollo multiplataforma, y nos hemos asegurado de que esta transición no rompa esa promesa.</span><span class="sxs-lookup"><span data-stu-id="c397a-115">One of the main promises of .NET Core is that of a cross-platform development stack, and we have made sure that this move does not break that promise.</span></span>

> [!TIP]
> <span data-ttu-id="c397a-116">Si no está familiarizado con MSBuild y quiere aprender más al respecto, puede empezar por leer el artículo [Conceptos de MSBuild](/visualstudio/msbuild/msbuild-concepts).</span><span class="sxs-lookup"><span data-stu-id="c397a-116">If you are new to MSBuild and would like to learn more about it, you can start by reading the [MSBuild concepts](/visualstudio/msbuild/msbuild-concepts) article.</span></span>

## <a name="the-tooling-layers"></a><span data-ttu-id="c397a-117">Las capas de herramientas</span><span class="sxs-lookup"><span data-stu-id="c397a-117">The tooling layers</span></span>

<span data-ttu-id="c397a-118">Con el cambio en el motor de compilación y el abandono del sistema del proyecto existente, es lógico que surjan algunas preguntas.</span><span class="sxs-lookup"><span data-stu-id="c397a-118">With the change in build engine and the move away from the existing project system, some questions naturally follow.</span></span> <span data-ttu-id="c397a-119">¿Alguno de estos cambios modifica la "disposición en capas" del ecosistema de herramientas de .NET Core?</span><span class="sxs-lookup"><span data-stu-id="c397a-119">Do any of these changes change the overall "layering" of the .NET Core tooling ecosystem?</span></span> <span data-ttu-id="c397a-120">¿Hay nuevos bits y componentes?</span><span class="sxs-lookup"><span data-stu-id="c397a-120">Are there new bits and components?</span></span>

<span data-ttu-id="c397a-121">Comencemos con un repaso rápido de la disposición en capas de Preview 2, como se muestra en la siguiente imagen:</span><span class="sxs-lookup"><span data-stu-id="c397a-121">Let's start with a quick refresher on Preview 2 layering as shown in the following picture:</span></span>

![Arquitectura de alto nivel de herramientas de Preview 2](media/cli-msbuild-architecture/p2-arch.png)

<span data-ttu-id="c397a-123">La disposición en capas de las herramientas en la Versión preliminar 2 es sencilla.</span><span class="sxs-lookup"><span data-stu-id="c397a-123">The layering of the tools in Preview 2 is straightforward.</span></span> <span data-ttu-id="c397a-124">En el fondo, la base es la CLI de .NET Core.</span><span class="sxs-lookup"><span data-stu-id="c397a-124">At the bottom, the foundation is the .NET Core CLI.</span></span> <span data-ttu-id="c397a-125">El resto de herramientas de mayor nivel, como Visual Studio o Visual Studio Code, dependen de la CLI, y se basan en esta, para compilar proyectos, restaurar dependencias, etc.</span><span class="sxs-lookup"><span data-stu-id="c397a-125">All other, higher-level tools, such as Visual Studio or Visual Studio Code, depend and rely on the CLI to build projects, restore dependencies, and so on.</span></span> <span data-ttu-id="c397a-126">Por ejemplo, si se quisiera realizar una operación de restauración con Visual Studio, se llamaría al comando `dotnet restore` de la CLI.</span><span class="sxs-lookup"><span data-stu-id="c397a-126">For example, if Visual Studio wanted to perform a restore operation, it would call into the `dotnet restore` command in the CLI.</span></span>

<span data-ttu-id="c397a-127">Con el paso al nuevo sistema de proyecto, el diagrama anterior cambia:</span><span class="sxs-lookup"><span data-stu-id="c397a-127">With the move to the new project system, the previous diagram changes:</span></span>

![Arquitectura de alto nivel del SDK 1.0.0 de .NET Core](media/cli-msbuild-architecture/p3-arch.png)

<span data-ttu-id="c397a-129">La principal diferencia es que la CLI ya no es la base; este papel es ocupado ahora por el "componente de SDK compartido".</span><span class="sxs-lookup"><span data-stu-id="c397a-129">The main difference is that the CLI is not the foundational layer anymore; this role is now filled by the "shared SDK component".</span></span> <span data-ttu-id="c397a-130">Este componente de SDK compartido es un conjunto de destinos y tareas asociadas que son responsables de compilar el código y publicarlo, de empaquetar paquetes NuGet, etc.</span><span class="sxs-lookup"><span data-stu-id="c397a-130">This shared SDK component is a set of targets and associated tasks that are responsible for compiling code, publishing it, packing NuGet packages, and so on.</span></span> <span data-ttu-id="c397a-131">El SDK de .NET Core es código abierto y está disponible en GitHub en el [repositorio de SDK](https://github.com/dotnet/sdk).</span><span class="sxs-lookup"><span data-stu-id="c397a-131">The .NET Core SDK is open-source and is available on GitHub on the [SDK repo](https://github.com/dotnet/sdk).</span></span>

> [!NOTE]
> <span data-ttu-id="c397a-132">Un "destino" es un término de MSBuild que indica una operación con nombre que puede invocar MSBuild.</span><span class="sxs-lookup"><span data-stu-id="c397a-132">A "target" is an MSBuild term that indicates a named operation that MSBuild can invoke.</span></span> <span data-ttu-id="c397a-133">Normalmente está unido a una o varias tareas que ejecutan alguna lógica que se supone que debe hacer el destino.</span><span class="sxs-lookup"><span data-stu-id="c397a-133">It is usually coupled with one or more tasks that execute some logic that the target is supposed to do.</span></span> <span data-ttu-id="c397a-134">MSBuild admite muchos destinos predefinidos, como `Copy` o `Execute`; también permite a los usuarios escribir sus propias tareas mediante código administrado y definir destinos para ejecutar esas tareas.</span><span class="sxs-lookup"><span data-stu-id="c397a-134">MSBuild supports many ready-made targets such as `Copy` or `Execute`; it also allows users to write their own tasks using managed code and define targets to execute those tasks.</span></span> <span data-ttu-id="c397a-135">Para obtener más información, consulte [Tareas de MSBuild](/visualstudio/msbuild/msbuild-tasks).</span><span class="sxs-lookup"><span data-stu-id="c397a-135">For more information, see [MSBuild tasks](/visualstudio/msbuild/msbuild-tasks).</span></span>

<span data-ttu-id="c397a-136">Todos los conjuntos de herramientas consumen ahora el componente de SDK compartido y sus destinos, incluida la CLI.</span><span class="sxs-lookup"><span data-stu-id="c397a-136">All the toolsets now consume the shared SDK component and its targets, CLI included.</span></span> <span data-ttu-id="c397a-137">Por ejemplo, Visual Studio 2019 no llama al comando `dotnet restore` para restaurar las dependencias de los proyectos de .NET Core.</span><span class="sxs-lookup"><span data-stu-id="c397a-137">For example, Visual Studio 2019 doesn't call into the `dotnet restore` command to restore dependencies for .NET Core projects.</span></span> <span data-ttu-id="c397a-138">En su lugar, usa el destino "Restauración" directamente.</span><span class="sxs-lookup"><span data-stu-id="c397a-138">Instead, it uses the "Restore" target directly.</span></span> <span data-ttu-id="c397a-139">Como son destinos de MSBuild, también puede usar MSBuild sin procesar para ejecutarlos mediante el comando [dotnet msbuild](dotnet-msbuild.md).</span><span class="sxs-lookup"><span data-stu-id="c397a-139">Since these are MSBuild targets, you can also use raw MSBuild to execute them using the [dotnet msbuild](dotnet-msbuild.md) command.</span></span>

### <a name="cli-commands"></a><span data-ttu-id="c397a-140">Comandos de la CLI</span><span class="sxs-lookup"><span data-stu-id="c397a-140">CLI commands</span></span>

<span data-ttu-id="c397a-141">El componente de SDK compartido implica que la mayoría de los comandos de la CLI existentes se han vuelto a implementar como tareas y destinos de MSBuild.</span><span class="sxs-lookup"><span data-stu-id="c397a-141">The shared SDK component means that the majority of existing CLI commands have been reimplemented as MSBuild tasks and targets.</span></span> <span data-ttu-id="c397a-142">¿Qué significa esto para los comandos de la CLI y el uso del conjunto de herramientas?</span><span class="sxs-lookup"><span data-stu-id="c397a-142">What does this mean for the CLI commands and your usage of the toolset?</span></span>

<span data-ttu-id="c397a-143">Desde una perspectiva del uso, no cambia la forma de usar la CLI.</span><span class="sxs-lookup"><span data-stu-id="c397a-143">From a usage perspective, it doesn't change the way you use the CLI.</span></span> <span data-ttu-id="c397a-144">La CLI sigue teniendo los comandos principales que existían en la versión preliminar 2 de .NET Core 1.0:</span><span class="sxs-lookup"><span data-stu-id="c397a-144">The CLI still has the core commands that existed in the .NET Core 1.0 Preview 2 release:</span></span>

- `new`
- `restore`
- `run`
- `build`
- `publish`
- `test`
- `pack`

<span data-ttu-id="c397a-145">Estos comandos todavía hacen lo que se espera que hagan (crear un nuevo proyecto, compilarlo, publicarlo, empaquetarlo, etc.).</span><span class="sxs-lookup"><span data-stu-id="c397a-145">These commands still do what you expect them to do (new up a project, build it, publish it, pack it, and so on).</span></span> <span data-ttu-id="c397a-146">Se puede consultar la pantalla de ayuda del comando (mediante `dotnet <command> --help`) o la documentación de este sitio para familiarizarse con su comportamiento.</span><span class="sxs-lookup"><span data-stu-id="c397a-146">You can consult either the command's help screen (using `dotnet <command> --help`) or documentation on this site to get familiar with their behavior.</span></span>

<span data-ttu-id="c397a-147">Desde una perspectiva de la ejecución, los comandos de la CLI toman sus parámetros y construyen una llamada a MSBuild "sin procesar" que establece las propiedades necesarias y ejecuta el destino deseado.</span><span class="sxs-lookup"><span data-stu-id="c397a-147">From an execution perspective, the CLI commands take their parameters and construct a call to "raw" MSBuild that sets the needed properties and runs the desired target.</span></span> <span data-ttu-id="c397a-148">Para ilustrar mejor esto, considere el siguiente comando:</span><span class="sxs-lookup"><span data-stu-id="c397a-148">To better illustrate this, consider the following command:</span></span>

   ```dotnetcli
   dotnet publish -o pub -c Release
   ```

<span data-ttu-id="c397a-149">Este comando publica una aplicación en una carpeta `pub` mediante la configuración de "Versión".</span><span class="sxs-lookup"><span data-stu-id="c397a-149">This command publishes an application into a `pub` folder using the "Release" configuration.</span></span> <span data-ttu-id="c397a-150">Internamente, este comando se traduce en la siguiente invocación de MSBuild:</span><span class="sxs-lookup"><span data-stu-id="c397a-150">Internally, this command gets translated into the following MSBuild invocation:</span></span>

   ```dotnetcli
   dotnet msbuild -t:Publish -p:OutputPath=pub -p:Configuration=Release
   ```

<span data-ttu-id="c397a-151">Las excepciones destacadas a esta regla son los comandos `new` y `run`.</span><span class="sxs-lookup"><span data-stu-id="c397a-151">Notable exceptions to this rule are the `new` and `run` commands.</span></span> <span data-ttu-id="c397a-152">No se han implementado como destinos de MSBuild.</span><span class="sxs-lookup"><span data-stu-id="c397a-152">They have not been implemented as MSBuild targets.</span></span>

### <a name="implicit-restore"></a><span data-ttu-id="c397a-153">Restauración implícita</span><span class="sxs-lookup"><span data-stu-id="c397a-153">Implicit restore</span></span>

[!INCLUDE[DotNet Restore Note](~/includes/dotnet-restore-note.md)]
