---
title: Escenarios no admitidos
ms.date: 03/30/2017
ms.assetid: 72027d0f-146d-40c5-9d72-e94392c8bb40
ms.openlocfilehash: 67a4e64208e00f9124b3cdc53d743c060274dac2
ms.sourcegitcommit: a4f9b754059f0210e29ae0578363a27b9ba84b64
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 12/05/2019
ms.locfileid: "74837979"
---
# <a name="unsupported-scenarios"></a><span data-ttu-id="8a6da-102">Escenarios no admitidos</span><span class="sxs-lookup"><span data-stu-id="8a6da-102">Unsupported Scenarios</span></span>
<span data-ttu-id="8a6da-103">Por diversas razones, Windows Communication Foundation (WCF) no admite algunos escenarios de seguridad específicos.</span><span class="sxs-lookup"><span data-stu-id="8a6da-103">For various reasons, Windows Communication Foundation (WCF) does not support some specific security scenarios.</span></span> <span data-ttu-id="8a6da-104">Por ejemplo, [!INCLUDE[wxp](../../../../includes/wxp-md.md)] Home Edition no implementa los protocolos de autenticación SSPI o Kerberos y, por tanto, WCF no admite la ejecución de un servicio con la autenticación de Windows en esa plataforma.</span><span class="sxs-lookup"><span data-stu-id="8a6da-104">For example, [!INCLUDE[wxp](../../../../includes/wxp-md.md)] Home Edition does not implement the SSPI or Kerberos authentication protocols, and therefore WCF does not support running a service with Windows authentication on that platform.</span></span> <span data-ttu-id="8a6da-105">Se admiten otros mecanismos de autenticación, como el nombre de usuario y la contraseña, y la autenticación integrada HTTP/HTTPS al ejecutar WCF en Windows XP Home Edition.</span><span class="sxs-lookup"><span data-stu-id="8a6da-105">Other authentication mechanisms, such as username/password and HTTP/HTTPS integrated authentication are supported when running WCF under Windows XP Home Edition.</span></span>  
  
## <a name="impersonation-scenarios"></a><span data-ttu-id="8a6da-106">Escenarios de suplantación</span><span class="sxs-lookup"><span data-stu-id="8a6da-106">Impersonation Scenarios</span></span>  
  
### <a name="impersonated-identity-might-not-flow-when-clients-make-asynchronous-calls"></a><span data-ttu-id="8a6da-107">Es posible que la identidad suplantada no fluya cuando los clientes realizan llamadas asincrónicas</span><span class="sxs-lookup"><span data-stu-id="8a6da-107">Impersonated Identity Might Not Flow When Clients Make Asynchronous Calls</span></span>  
 <span data-ttu-id="8a6da-108">Cuando un cliente realiza llamadas asincrónicas a un servicio WCF usando la autenticación de Windows bajo suplantación, se podría producir la autenticación con la identidad del proceso del cliente en lugar de la identidad suplantada.</span><span class="sxs-lookup"><span data-stu-id="8a6da-108">When a WCF client makes asynchronous calls to a WCF service using Windows authentication under impersonation, authentication might occur with the identity of the client process instead of the impersonated identity.</span></span>  
  
### <a name="windows-xp-and-secure-context-token-cookie-enabled"></a><span data-ttu-id="8a6da-109">Windows XP y cookie de token de contexto seguro habilitados</span><span class="sxs-lookup"><span data-stu-id="8a6da-109">Windows XP and Secure Context Token Cookie Enabled</span></span>  
 <span data-ttu-id="8a6da-110">WCF no admite la suplantación y se produce una <xref:System.InvalidOperationException> cuando existen las condiciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="8a6da-110">WCF does not support impersonation and an <xref:System.InvalidOperationException> is thrown when the following conditions exist:</span></span>  
  
- <span data-ttu-id="8a6da-111">El sistema operativo es [!INCLUDE[wxp](../../../../includes/wxp-md.md)].</span><span class="sxs-lookup"><span data-stu-id="8a6da-111">The operating system is [!INCLUDE[wxp](../../../../includes/wxp-md.md)].</span></span>  
  
- <span data-ttu-id="8a6da-112">El modo de autenticación resulta en una identidad de Windows.</span><span class="sxs-lookup"><span data-stu-id="8a6da-112">The authentication mode results in a Windows identity.</span></span>  
  
- <span data-ttu-id="8a6da-113">La propiedad <xref:System.ServiceModel.OperationBehaviorAttribute.Impersonation%2A> de <xref:System.ServiceModel.OperationBehaviorAttribute> se establece en <xref:System.ServiceModel.ImpersonationOption.Required>.</span><span class="sxs-lookup"><span data-stu-id="8a6da-113">The <xref:System.ServiceModel.OperationBehaviorAttribute.Impersonation%2A> property of the <xref:System.ServiceModel.OperationBehaviorAttribute> is set to <xref:System.ServiceModel.ImpersonationOption.Required>.</span></span>  
  
- <span data-ttu-id="8a6da-114">Se crea un token de contexto de seguridad (SCT) basado en estado (de forma predeterminada, la creación está deshabilitada).</span><span class="sxs-lookup"><span data-stu-id="8a6da-114">A state-based security context token (SCT) is created (by default, creation is disabled).</span></span>  
  
 <span data-ttu-id="8a6da-115">El SCT basado en estado solo se puede crear mediante un enlace personalizado.</span><span class="sxs-lookup"><span data-stu-id="8a6da-115">The state-based SCT can only be created using a custom binding.</span></span> <span data-ttu-id="8a6da-116">Para obtener más información, vea [Cómo: Cree un token de contexto de seguridad para una sesión segura](../../../../docs/framework/wcf/feature-details/how-to-create-a-security-context-token-for-a-secure-session.md)). En el código, el token se habilita mediante la creación de un elemento de enlace de seguridad (ya sea <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement> o <xref:System.ServiceModel.Channels.AsymmetricSecurityBindingElement>) mediante el <xref:System.ServiceModel.Channels.SecurityBindingElement.CreateSspiNegotiationBindingElement%28System.Boolean%29?displayProperty=nameWithType> o el método <xref:System.ServiceModel.Channels.SecurityBindingElement.CreateSecureConversationBindingElement%28System.ServiceModel.Channels.SecurityBindingElement%2CSystem.Boolean%29?displayProperty=nameWithType> y estableciendo el parámetro `requireCancellation` en `false`.</span><span class="sxs-lookup"><span data-stu-id="8a6da-116">For more information, see [How to: Create a Security Context Token for a Secure Session](../../../../docs/framework/wcf/feature-details/how-to-create-a-security-context-token-for-a-secure-session.md).) In code, the token is enabled by creating a security binding element (either <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement> or <xref:System.ServiceModel.Channels.AsymmetricSecurityBindingElement>) using the <xref:System.ServiceModel.Channels.SecurityBindingElement.CreateSspiNegotiationBindingElement%28System.Boolean%29?displayProperty=nameWithType> or the <xref:System.ServiceModel.Channels.SecurityBindingElement.CreateSecureConversationBindingElement%28System.ServiceModel.Channels.SecurityBindingElement%2CSystem.Boolean%29?displayProperty=nameWithType> method and setting the `requireCancellation` parameter to `false`.</span></span> <span data-ttu-id="8a6da-117">El parámetro hace referencia al almacenamiento en caché del SCT.</span><span class="sxs-lookup"><span data-stu-id="8a6da-117">The parameter refers to the caching of the SCT.</span></span> <span data-ttu-id="8a6da-118">Al establecer el valor en `false`, se habilita la característica del SCT basado en estado.</span><span class="sxs-lookup"><span data-stu-id="8a6da-118">Setting the value to `false` enables the state-based SCT feature.</span></span>  
  
 <span data-ttu-id="8a6da-119">Como alternativa, en la configuración, el token se habilita mediante la creación de una <`customBinding`>, la adición de un <`security`> elemento y el establecimiento del atributo `authenticationMode` en SecureConversation y el atributo `requireSecurityContextCancellation` en `true`.</span><span class="sxs-lookup"><span data-stu-id="8a6da-119">Alternatively, in configuration, the token is enabled by creating a <`customBinding`>, then adding a <`security`> element, and setting the `authenticationMode` attribute to SecureConversation and the `requireSecurityContextCancellation` attribute to `true`.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="8a6da-120">Los requisitos anteriores son específicos.</span><span class="sxs-lookup"><span data-stu-id="8a6da-120">The preceding requirements are specific.</span></span> <span data-ttu-id="8a6da-121">Por ejemplo, <xref:System.ServiceModel.Channels.SecurityBindingElement.CreateKerberosBindingElement%2A> crea un elemento de enlace que resulta en una identidad de Windows, pero no establece un SCT.</span><span class="sxs-lookup"><span data-stu-id="8a6da-121">For example, the <xref:System.ServiceModel.Channels.SecurityBindingElement.CreateKerberosBindingElement%2A> creates a binding element that results in a Windows identity, but does not establish an SCT.</span></span> <span data-ttu-id="8a6da-122">Por consiguiente, puede utilizarlo con la opción `Required` en [!INCLUDE[wxp](../../../../includes/wxp-md.md)].</span><span class="sxs-lookup"><span data-stu-id="8a6da-122">Therefore, you can use it with the `Required` option on [!INCLUDE[wxp](../../../../includes/wxp-md.md)].</span></span>  
  
### <a name="possible-aspnet-conflict"></a><span data-ttu-id="8a6da-123">Posible conflicto de ASP.NET</span><span class="sxs-lookup"><span data-stu-id="8a6da-123">Possible ASP.NET Conflict</span></span>  
 <span data-ttu-id="8a6da-124">WCF y ASP.NET pueden habilitar o deshabilitar la suplantación.</span><span class="sxs-lookup"><span data-stu-id="8a6da-124">WCF and ASP.NET can both enable or disable impersonation.</span></span> <span data-ttu-id="8a6da-125">Cuando ASP.NET hospeda una aplicación WCF, puede existir un conflicto entre la configuración de WCF y de la configuración de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="8a6da-125">When ASP.NET hosts an WCF application, a conflict may exist between the WCF and ASP.NET configuration settings.</span></span> <span data-ttu-id="8a6da-126">En caso de conflicto, la configuración de WCF tiene prioridad, a menos que la propiedad <xref:System.ServiceModel.OperationBehaviorAttribute.Impersonation%2A> esté establecida en <xref:System.ServiceModel.ImpersonationOption.NotAllowed>, en cuyo caso la configuración de suplantación ASP.NET tiene prioridad.</span><span class="sxs-lookup"><span data-stu-id="8a6da-126">In case of conflict, the WCF setting takes precedence, unless the <xref:System.ServiceModel.OperationBehaviorAttribute.Impersonation%2A> property is set to <xref:System.ServiceModel.ImpersonationOption.NotAllowed>, in which case the ASP.NET impersonation setting takes precedence.</span></span>  
  
### <a name="assembly-loads-may-fail-under-impersonation"></a><span data-ttu-id="8a6da-127">Se puede producir un error en las cargas de ensamblado si se utiliza la suplantación</span><span class="sxs-lookup"><span data-stu-id="8a6da-127">Assembly Loads May Fail Under Impersonation</span></span>  
 <span data-ttu-id="8a6da-128">Si el contexto suplantado no tiene los derechos de acceso para cargar un ensamblado y si es la primera vez Common Language Runtime (CLR) intenta cargar el ensamblado para ese AppDomain, el <xref:System.AppDomain> almacena en memoria caché el error.</span><span class="sxs-lookup"><span data-stu-id="8a6da-128">If the impersonated context does not have access rights to load an assembly and if it is the first time the common language runtime (CLR) is attempting to load the assembly for that AppDomain, the <xref:System.AppDomain> caches the failure.</span></span> <span data-ttu-id="8a6da-129">Los siguientes intentos de cargar ese ensamblado (o ensamblados) producirán un error, incluso después de revertir la suplantación e incluso si el contexto revertido tiene derechos de acceso para cargar el ensamblado.</span><span class="sxs-lookup"><span data-stu-id="8a6da-129">Subsequent attempts to load that assembly (or assemblies) fail, even after reverting the impersonation, and even if the reverted context has access rights to load the assembly.</span></span> <span data-ttu-id="8a6da-130">Esto se debe a que CLR no vuelve a intentar la carga una vez que el contexto del usuario ha cambiado.</span><span class="sxs-lookup"><span data-stu-id="8a6da-130">This is because the CLR does not re-attempt the load after the user context is changed.</span></span> <span data-ttu-id="8a6da-131">Debe reiniciar el dominio de la aplicación para recuperarse del error.</span><span class="sxs-lookup"><span data-stu-id="8a6da-131">You must restart the application domain to recover from the failure.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="8a6da-132">El valor predeterminado de la propiedad <xref:System.ServiceModel.Security.WindowsClientCredential.AllowedImpersonationLevel%2A> de la clase <xref:System.ServiceModel.Security.WindowsClientCredential> es <xref:System.Security.Principal.TokenImpersonationLevel.Identification>.</span><span class="sxs-lookup"><span data-stu-id="8a6da-132">The default value for the <xref:System.ServiceModel.Security.WindowsClientCredential.AllowedImpersonationLevel%2A> property of the <xref:System.ServiceModel.Security.WindowsClientCredential> class is <xref:System.Security.Principal.TokenImpersonationLevel.Identification>.</span></span> <span data-ttu-id="8a6da-133">En la mayoría de los casos, un contexto de suplantación del nivel de identificación no tiene derechos para cargar ensamblados adicionales.</span><span class="sxs-lookup"><span data-stu-id="8a6da-133">In most cases, an identification-level impersonation context has no rights to load any additional assemblies.</span></span> <span data-ttu-id="8a6da-134">Éste es el valor predeterminado, por lo que esto se trata de una condición muy común a tener en cuenta.</span><span class="sxs-lookup"><span data-stu-id="8a6da-134">This is the default value, so this is a very common condition to be aware of.</span></span> <span data-ttu-id="8a6da-135">La suplantación del nivel de identificación también tiene lugar cuando el proceso de suplantación no tiene el privilegio `SeImpersonate`.</span><span class="sxs-lookup"><span data-stu-id="8a6da-135">Identification-level impersonation also occurs when the impersonating process does not have the `SeImpersonate` privilege.</span></span> <span data-ttu-id="8a6da-136">Para obtener más información, consulte [delegación y suplantación](../../../../docs/framework/wcf/feature-details/delegation-and-impersonation-with-wcf.md).</span><span class="sxs-lookup"><span data-stu-id="8a6da-136">For more information, see [Delegation and Impersonation](../../../../docs/framework/wcf/feature-details/delegation-and-impersonation-with-wcf.md).</span></span>  
  
### <a name="delegation-requires-credential-negotiation"></a><span data-ttu-id="8a6da-137">La delegación requiere la negociación de las credenciales</span><span class="sxs-lookup"><span data-stu-id="8a6da-137">Delegation Requires Credential Negotiation</span></span>  
 <span data-ttu-id="8a6da-138">Para utilizar el protocolo de autenticación Kerberos con la delegación, debe implementar el protocolo Kerberos con negociación de credenciales (a veces denominado Kerberos de autenticación mutua o de varios pasos).</span><span class="sxs-lookup"><span data-stu-id="8a6da-138">To use the Kerberos authentication protocol with delegation, you must implement the Kerberos protocol with credential negotiation (sometimes called multi-leg or multi-step Kerberos).</span></span> <span data-ttu-id="8a6da-139">Si implementa la autenticación de Kerberos sin la negociación de la credencial (denominada en ocasiones Kerberos de "un disparo" o "fase única"), se producirá una excepción.</span><span class="sxs-lookup"><span data-stu-id="8a6da-139">If you implement Kerberos authentication without credential negotiation (sometimes called one-shot or single-leg Kerberos), an exception is thrown.</span></span> <span data-ttu-id="8a6da-140">Para obtener más información sobre cómo implementar la negociación de credenciales, consulte [depuración de errores de autenticación de Windows](../../../../docs/framework/wcf/feature-details/debugging-windows-authentication-errors.md).</span><span class="sxs-lookup"><span data-stu-id="8a6da-140">For more information about how to implement credential negotiation, see [Debugging Windows Authentication Errors](../../../../docs/framework/wcf/feature-details/debugging-windows-authentication-errors.md).</span></span>  
  
## <a name="cryptography"></a><span data-ttu-id="8a6da-141">Criptografía</span><span class="sxs-lookup"><span data-stu-id="8a6da-141">Cryptography</span></span>  
  
### <a name="sha-256-supported-only-for-symmetric-key-usages"></a><span data-ttu-id="8a6da-142">SHA-256 compatible solo para usos de claves simétricas</span><span class="sxs-lookup"><span data-stu-id="8a6da-142">SHA-256 Supported Only for Symmetric Key Usages</span></span>  
 <span data-ttu-id="8a6da-143">WCF admite una variedad de algoritmos de creación de resúmenes de firma y cifrado que se pueden especificar con el conjunto de algoritmos en los enlaces proporcionados por el sistema.</span><span class="sxs-lookup"><span data-stu-id="8a6da-143">WCF supports a variety of encryption and signature digest creation algorithms that you can specify using the algorithm suite in the system-provided bindings.</span></span> <span data-ttu-id="8a6da-144">Para mejorar la seguridad, WCF admite algoritmos de algoritmo hash seguro (SHA) 2, específicamente SHA-256, para crear hashes de Resumen de firmas.</span><span class="sxs-lookup"><span data-stu-id="8a6da-144">For improved security, WCF supports Secure Hash Algorithm (SHA) 2 algorithms, specifically SHA-256, for creating signature digest hashes.</span></span> <span data-ttu-id="8a6da-145">Esta versión admite SHA-256 solo para usos de clave simétrica, como las claves de Kerberos, y donde no se usa un certificado X.509 para firmar el mensaje.</span><span class="sxs-lookup"><span data-stu-id="8a6da-145">This release supports SHA-256 only for symmetric key usages, such as Kerberos keys, and where an X.509 certificate is not used to sign the message.</span></span> <span data-ttu-id="8a6da-146">WCF no admite firmas RSA (usadas en certificados X. 509) mediante el hash SHA-256 debido a la falta de compatibilidad actual con RSA-SHA256 en WinFX.</span><span class="sxs-lookup"><span data-stu-id="8a6da-146">WCF does not support RSA signatures (used in X.509 certificates) using SHA-256 hash due to the current lack of support for RSA-SHA256 in the WinFX.</span></span>  
  
### <a name="fips-compliant-sha-256-hashes-not-supported"></a><span data-ttu-id="8a6da-147">No se admiten hash SHA-256 conformes a FIPS</span><span class="sxs-lookup"><span data-stu-id="8a6da-147">FIPS-Compliant SHA-256 Hashes not Supported</span></span>  
 <span data-ttu-id="8a6da-148">WCF no admite hashes compatibles con FIPS SHA-256, por lo que WCF no admite los conjuntos de algoritmos que usan SHA-256 en los sistemas donde se requiere el uso de algoritmos compatibles con FIPS.</span><span class="sxs-lookup"><span data-stu-id="8a6da-148">WCF does not support SHA-256 FIPS-compliant hashes, so algorithm suites that use SHA-256 are not supported by WCF on systems where use of FIPS compliant algorithms is required.</span></span>  
  
### <a name="fips-compliant-algorithms-may-fail-if-registry-is-edited"></a><span data-ttu-id="8a6da-149">Los algoritmos conformes a FIPS pueden producir errores si se edita el registro</span><span class="sxs-lookup"><span data-stu-id="8a6da-149">FIPS-Compliant Algorithms May Fail if Registry Is Edited</span></span>  
 <span data-ttu-id="8a6da-150">Puede habilitar y deshabilitar los algoritmos conformes a los estándares de procesamiento de información federal (FIPS) utilizando el complemento Microsoft Management Console (MMC) de configuración de seguridad local.</span><span class="sxs-lookup"><span data-stu-id="8a6da-150">You can enable and disable Federal Information Processing Standards (FIPS)-compliant algorithms by using the Local Security Settings Microsoft Management Console (MMC) snap-in.</span></span> <span data-ttu-id="8a6da-151">También puede tener acceso al valor en el registro.</span><span class="sxs-lookup"><span data-stu-id="8a6da-151">You can also access the setting in the registry.</span></span> <span data-ttu-id="8a6da-152">Sin embargo, tenga en cuenta que WCF no admite el uso del registro para restablecer la configuración.</span><span class="sxs-lookup"><span data-stu-id="8a6da-152">Note, however, that WCF does not support using the registry to reset the setting.</span></span> <span data-ttu-id="8a6da-153">Si el valor está establecido en algo distinto de 1 ó 0, pueden producirse resultados incoherentes entre el CLR y el sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="8a6da-153">If the value is set to anything other than 1 or 0, inconsistent results can occur between the CLR and the operating system.</span></span>  
  
### <a name="fips-compliant-aes-encryption-limitation"></a><span data-ttu-id="8a6da-154">Limitación de cifrado AES conforme a FIPS</span><span class="sxs-lookup"><span data-stu-id="8a6da-154">FIPS-Compliant AES Encryption Limitation</span></span>  
 <span data-ttu-id="8a6da-155">El cifrado AES conforme a FIPS no funciona en devoluciones de llamada dúplex bajo suplantación del nivel de identificación.</span><span class="sxs-lookup"><span data-stu-id="8a6da-155">FIPS compliant AES encryption does not work in duplex callbacks under identification level impersonation.</span></span>  
  
### <a name="cngksp-certificates"></a><span data-ttu-id="8a6da-156">Certificados CNG/KSP</span><span class="sxs-lookup"><span data-stu-id="8a6da-156">CNG/KSP Certificates</span></span>  
 <span data-ttu-id="8a6da-157">API de criptografía de *: La siguiente generación (CNG)* es el reemplazo a largo plazo de CryptoAPI.</span><span class="sxs-lookup"><span data-stu-id="8a6da-157">*Cryptography API: Next Generation (CNG)* is the long-term replacement for the CryptoAPI.</span></span> <span data-ttu-id="8a6da-158">Esta API está disponible en código no administrado en Windows Vista, [!INCLUDE[lserver](../../../../includes/lserver-md.md)] y versiones posteriores de Windows.</span><span class="sxs-lookup"><span data-stu-id="8a6da-158">This API is available in unmanaged code on Windows Vista,  [!INCLUDE[lserver](../../../../includes/lserver-md.md)] and later Windows versions.</span></span>  
  
 <span data-ttu-id="8a6da-159">.NET Framework 4.6.1 y versiones anteriores no admiten estos certificados porque usan CryptoAPI heredado para administrar los certificados CNG/KSP.</span><span class="sxs-lookup"><span data-stu-id="8a6da-159">.NET Framework 4.6.1 and earlier versions do not support these certificates because they use the legacy CryptoAPI to handle CNG/KSP certificates.</span></span> <span data-ttu-id="8a6da-160">El uso de estos certificados con .NET Framework 4.6.1 y versiones anteriores producirá una excepción.</span><span class="sxs-lookup"><span data-stu-id="8a6da-160">The use of these certificates with   .NET Framework 4.6.1 and earlier versions will cause an exception.</span></span>  
  
 <span data-ttu-id="8a6da-161">Hay dos posibles maneras de saber si un certificado utiliza KSP:</span><span class="sxs-lookup"><span data-stu-id="8a6da-161">There are two possible ways to tell if a certificate uses KSP:</span></span>  
  
- <span data-ttu-id="8a6da-162">Ejecute `p/invoke` para `CertGetCertificateContextProperty` e inspeccione `dwProvType` en la `CertGetCertificateContextProperty` devuelta.</span><span class="sxs-lookup"><span data-stu-id="8a6da-162">Do a `p/invoke` of `CertGetCertificateContextProperty`, and inspect `dwProvType` on the returned `CertGetCertificateContextProperty`.</span></span>  
  
- <span data-ttu-id="8a6da-163">Use el comando `certutil` desde la línea de comandos para consultar los certificados.</span><span class="sxs-lookup"><span data-stu-id="8a6da-163">Use the  `certutil` command from the command line for querying certificates.</span></span> <span data-ttu-id="8a6da-164">Para obtener más información, consulte [tareas de certutil para solucionar problemas de certificados](https://go.microsoft.com/fwlink/?LinkId=120056).</span><span class="sxs-lookup"><span data-stu-id="8a6da-164">For more information, see [Certutil tasks for troubleshooting certificates](https://go.microsoft.com/fwlink/?LinkId=120056).</span></span>  
  
## <a name="message-security-fails-if-using-aspnet-impersonation-and-aspnet-compatibility-is-required"></a><span data-ttu-id="8a6da-165">Se produce un error en la seguridad del mensaje si se requiere el uso de suplantación de ASP.NET y compatibilidad de ASP.NET</span><span class="sxs-lookup"><span data-stu-id="8a6da-165">Message Security Fails if Using ASP.NET Impersonation and ASP.NET Compatibility Is Required</span></span>  
 <span data-ttu-id="8a6da-166">WCF no admite la siguiente combinación de valores de configuración porque puede impedir que se produzca la autenticación del cliente:</span><span class="sxs-lookup"><span data-stu-id="8a6da-166">WCF does not support the following combination of settings because they can prevent client authentication from occurring:</span></span>  
  
- <span data-ttu-id="8a6da-167">La suplantación de ASP.NET está habilitada.</span><span class="sxs-lookup"><span data-stu-id="8a6da-167">ASP.NET Impersonation is enabled.</span></span> <span data-ttu-id="8a6da-168">Esto se hace en el archivo Web. config estableciendo el atributo `impersonate` del elemento <`identity`> en `true`.</span><span class="sxs-lookup"><span data-stu-id="8a6da-168">This is done in the Web.config file by setting the `impersonate` attribute of the <`identity`> element to `true`.</span></span>  
  
- <span data-ttu-id="8a6da-169">El modo de compatibilidad de ASP.NET se habilita estableciendo el atributo `aspNetCompatibilityEnabled` del [>\<serviceHostingEnvironment](../../../../docs/framework/configure-apps/file-schema/wcf/servicehostingenvironment.md) en `true`.</span><span class="sxs-lookup"><span data-stu-id="8a6da-169">ASP.NET compatibility mode is enabled by setting the `aspNetCompatibilityEnabled` attribute of the [\<serviceHostingEnvironment>](../../../../docs/framework/configure-apps/file-schema/wcf/servicehostingenvironment.md) to `true`.</span></span>  
  
- <span data-ttu-id="8a6da-170">Se utiliza la seguridad de modo de mensaje.</span><span class="sxs-lookup"><span data-stu-id="8a6da-170">Message mode security is used.</span></span>  
  
 <span data-ttu-id="8a6da-171">La solución alternativa consiste en desactivar el modo de compatibilidad de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="8a6da-171">The work-around is to turn off the ASP.NET compatibility mode.</span></span> <span data-ttu-id="8a6da-172">O bien, si se requiere el modo de compatibilidad ASP.NET, deshabilite la característica de suplantación ASP.NET y use en su lugar la suplantación proporcionada por WCF.</span><span class="sxs-lookup"><span data-stu-id="8a6da-172">Or, if the ASP.NET compatibility mode is required, disable the ASP.NET impersonation feature and use WCF-provided impersonation instead.</span></span> <span data-ttu-id="8a6da-173">Para obtener más información, consulte [delegación y suplantación](../../../../docs/framework/wcf/feature-details/delegation-and-impersonation-with-wcf.md).</span><span class="sxs-lookup"><span data-stu-id="8a6da-173">For more information, see [Delegation and Impersonation](../../../../docs/framework/wcf/feature-details/delegation-and-impersonation-with-wcf.md).</span></span>  
  
## <a name="ipv6-literal-address-failure"></a><span data-ttu-id="8a6da-174">Error de dirección literal IPv6</span><span class="sxs-lookup"><span data-stu-id="8a6da-174">IPv6 Literal Address Failure</span></span>  
 <span data-ttu-id="8a6da-175">Se produce un error en las solicitudes de seguridad cuando el cliente y el servicio están en el mismo equipo y se utilizan direcciones IPv6 literales para el servicio.</span><span class="sxs-lookup"><span data-stu-id="8a6da-175">Security requests fail when the client and service are on the same machine, and IPv6 literal addresses are used for the service.</span></span>  
  
 <span data-ttu-id="8a6da-176">Las direcciones IPv6 literales funcionan si el servicio y el cliente están en equipos diferentes.</span><span class="sxs-lookup"><span data-stu-id="8a6da-176">Literal IPv6 addresses work if the service and client are on different machines.</span></span>  
  
## <a name="wsdl-retrieval-failures-with-federated-trust"></a><span data-ttu-id="8a6da-177">Errores de recuperación de WSDL con confianza federada</span><span class="sxs-lookup"><span data-stu-id="8a6da-177">WSDL Retrieval Failures with Federated Trust</span></span>  
 <span data-ttu-id="8a6da-178">WCF requiere exactamente un documento WSDL para cada nodo de la cadena de confianza federada.</span><span class="sxs-lookup"><span data-stu-id="8a6da-178">WCF requires exactly one WSDL document for each node in the federated trust chain.</span></span> <span data-ttu-id="8a6da-179">Tenga el cuidado de no establecer un bucle al especificar los extremos.</span><span class="sxs-lookup"><span data-stu-id="8a6da-179">Be careful not to set up a loop when specifying endpoints.</span></span> <span data-ttu-id="8a6da-180">Una manera en la que se pueden producir bucles es cuando se utiliza una descarga WSDL de cadenas de confianza federadas con dos o más vínculos en el mismo documento WSDL.</span><span class="sxs-lookup"><span data-stu-id="8a6da-180">One way in which loops can arise is using a WSDL download of federated trust chains with two or more links in the same WSDL document.</span></span> <span data-ttu-id="8a6da-181">Un escenario común donde se puede dar este problema es un servicio federado en el que el servidor de token de seguridad y el servicio se encuentran en el mismo ServiceHost.</span><span class="sxs-lookup"><span data-stu-id="8a6da-181">A common scenario that can produce this problem is a federated service where the Security Token Server and the service are contained inside the same ServiceHost.</span></span>  
  
 <span data-ttu-id="8a6da-182">Un ejemplo de esta situación sería un servicio con las tres direcciones de punto de conexión siguientes:</span><span class="sxs-lookup"><span data-stu-id="8a6da-182">An example of this situation is a service with the following three endpoint addresses:</span></span>  
  
- <span data-ttu-id="8a6da-183">`http://localhost/CalculatorService/service` (el servicio)</span><span class="sxs-lookup"><span data-stu-id="8a6da-183">`http://localhost/CalculatorService/service` (the service)</span></span>  
  
- <span data-ttu-id="8a6da-184">`http://localhost/CalculatorService/issue_ticket` (STS)</span><span class="sxs-lookup"><span data-stu-id="8a6da-184">`http://localhost/CalculatorService/issue_ticket` (the STS)</span></span>  
  
- <span data-ttu-id="8a6da-185">`http://localhost/CalculatorService/mex` (el punto de conexión de metadatos)</span><span class="sxs-lookup"><span data-stu-id="8a6da-185">`http://localhost/CalculatorService/mex` (the metadata endpoint)</span></span>  
  
 <span data-ttu-id="8a6da-186">Esto produce una excepción.</span><span class="sxs-lookup"><span data-stu-id="8a6da-186">This throws an exception.</span></span>  
  
 <span data-ttu-id="8a6da-187">Puede hacer que este escenario funcione colocando el extremo `issue_ticket` en otra parte.</span><span class="sxs-lookup"><span data-stu-id="8a6da-187">You can make this scenario work by putting the `issue_ticket` endpoint elsewhere.</span></span>  
  
## <a name="wsdl-import-attributes-can-be-lost"></a><span data-ttu-id="8a6da-188">Se pueden perder los atributos de importación de WSDL</span><span class="sxs-lookup"><span data-stu-id="8a6da-188">WSDL Import Attributes can be Lost</span></span>  
 <span data-ttu-id="8a6da-189">WCF pierde la pista de los atributos de un elemento `<wst:Claims>` de una plantilla`RST` al hacer una importación de WSDL.</span><span class="sxs-lookup"><span data-stu-id="8a6da-189">WCF loses track of the attributes on a `<wst:Claims>` element in an `RST` template when doing a WSDL import.</span></span> <span data-ttu-id="8a6da-190">Esto ocurre durante una importación de WSDL si `<Claims>` se especifica directamente en`WSFederationHttpBinding.Security.Message.TokenRequestParameters` o`IssuedSecurityTokenRequestParameters.AdditionalRequestParameters` en lugar de usar directamente las colecciones de tipos de notificación.</span><span class="sxs-lookup"><span data-stu-id="8a6da-190">This happens during a WSDL import if you specify `<Claims>` directly in `WSFederationHttpBinding.Security.Message.TokenRequestParameters` or `IssuedSecurityTokenRequestParameters.AdditionalRequestParameters` instead of using the claim type collections directly.</span></span>  <span data-ttu-id="8a6da-191">Puesto que la importación pierde los atributos, el enlace no efectúa correctamente el viaje de ida y vuelta (round trip) a través de WSDL y por lo tanto es incorrecto en el cliente.</span><span class="sxs-lookup"><span data-stu-id="8a6da-191">Since the import loses the attributes, the binding does not round trip properly through WSDL and hence is incorrect on the client side.</span></span>  
  
 <span data-ttu-id="8a6da-192">La solución es modificar el enlace directamente en el cliente después de realizar la importación.</span><span class="sxs-lookup"><span data-stu-id="8a6da-192">The fix is to modify the binding directly on the client after doing the import.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8a6da-193">Vea también</span><span class="sxs-lookup"><span data-stu-id="8a6da-193">See also</span></span>

- [<span data-ttu-id="8a6da-194">Consideraciones de seguridad</span><span class="sxs-lookup"><span data-stu-id="8a6da-194">Security Considerations</span></span>](../../../../docs/framework/wcf/feature-details/security-considerations-in-wcf.md)
- [<span data-ttu-id="8a6da-195">Divulgación de información</span><span class="sxs-lookup"><span data-stu-id="8a6da-195">Information Disclosure</span></span>](../../../../docs/framework/wcf/feature-details/information-disclosure.md)
- [<span data-ttu-id="8a6da-196">Elevación de privilegios</span><span class="sxs-lookup"><span data-stu-id="8a6da-196">Elevation of Privilege</span></span>](../../../../docs/framework/wcf/feature-details/elevation-of-privilege.md)
- [<span data-ttu-id="8a6da-197">Denegación de servicio</span><span class="sxs-lookup"><span data-stu-id="8a6da-197">Denial of Service</span></span>](../../../../docs/framework/wcf/feature-details/denial-of-service.md)
- [<span data-ttu-id="8a6da-198">Manipulación</span><span class="sxs-lookup"><span data-stu-id="8a6da-198">Tampering</span></span>](../../../../docs/framework/wcf/feature-details/tampering.md)
- [<span data-ttu-id="8a6da-199">Ataques por repetición</span><span class="sxs-lookup"><span data-stu-id="8a6da-199">Replay Attacks</span></span>](../../../../docs/framework/wcf/feature-details/replay-attacks.md)
