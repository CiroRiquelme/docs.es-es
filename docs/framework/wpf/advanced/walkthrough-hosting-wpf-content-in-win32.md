---
title: Hospedar contenido de WPF en Win32
titleSuffix: ''
ms.date: 03/30/2017
dev_langs:
- cpp
helpviewer_keywords:
- hosting WPF content in Win32 window [WPF]
ms.assetid: 38ce284a-4303-46dd-b699-c9365b22a7dc
ms.openlocfilehash: ff95b330ff67e916a4d27ef841e757998d847c8b
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/24/2020
ms.locfileid: "76735312"
---
# <a name="walkthrough-hosting-wpf-content-in-win32"></a><span data-ttu-id="fd3c2-102">Tutorial: Hospedar contenido de WPF en Win32</span><span class="sxs-lookup"><span data-stu-id="fd3c2-102">Walkthrough: Hosting WPF Content in Win32</span></span>
[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] <span data-ttu-id="fd3c2-103">proporciona un entorno rico para crear aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-103">provides a rich environment for creating applications.</span></span> <span data-ttu-id="fd3c2-104">Sin embargo, si tiene una inversión sustancial en código Win32, podría ser más eficaz agregar [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] funcionalidad a la aplicación en lugar de volver a escribir el código original.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-104">However, when you have a substantial investment in Win32 code, it might be more effective to add [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] functionality to your application rather than rewriting your original code.</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="fd3c2-105">proporciona un mecanismo sencillo para hospedar contenido de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] en una ventana de Win32.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-105">provides a straightforward mechanism for hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a Win32 window.</span></span>  
  
 <span data-ttu-id="fd3c2-106">En este tutorial se describe cómo escribir una aplicación de ejemplo, [hospedar contenido de WPF en un ejemplo de ventana de Win32](https://go.microsoft.com/fwlink/?LinkID=160004), que hospeda [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenido en una ventana de Win32.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-106">This tutorial describes how to write a sample application, [Hosting WPF Content in a Win32 Window Sample](https://go.microsoft.com/fwlink/?LinkID=160004), that hosts [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a Win32 window.</span></span> <span data-ttu-id="fd3c2-107">Puede extender este ejemplo para hospedar cualquier ventana de Win32.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-107">You can extend this sample to host any Win32 window.</span></span> <span data-ttu-id="fd3c2-108">Dado que implica combinar código administrado y no administrado, la aplicación se escribe en C++/CLI.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-108">Because it involves mixing managed and unmanaged code, the application is written in C++/CLI.</span></span>  

<a name="requirements"></a>   
## <a name="requirements"></a><span data-ttu-id="fd3c2-109">Requisitos</span><span class="sxs-lookup"><span data-stu-id="fd3c2-109">Requirements</span></span>  
 <span data-ttu-id="fd3c2-110">En este tutorial se da por supuesto que está familiarizado con la programación de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] y Win32.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-110">This tutorial assumes a basic familiarity with both [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and Win32 programming.</span></span> <span data-ttu-id="fd3c2-111">Para obtener una introducción básica a la programación de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], vea [Introducción](../getting-started/index.md).</span><span class="sxs-lookup"><span data-stu-id="fd3c2-111">For a basic introduction to [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming, see [Getting Started](../getting-started/index.md).</span></span> <span data-ttu-id="fd3c2-112">Para obtener una introducción a la programación de Win32, debe hacer referencia a cualquiera de los numerosos libros del asunto, en determinadas *ventanas de programación* , de Charles Petzold.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-112">For an introduction to Win32 programming, you should reference any of the numerous books on the subject, in particular *Programming Windows* by Charles Petzold.</span></span>  
  
 <span data-ttu-id="fd3c2-113">Dado que el ejemplo que acompaña a este tutorial se implementa C++en/CLI, en este tutorial se da por supuesto que C++ está familiarizado con el uso de para programar la API de Windows y comprender la programación de código administrado.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-113">Because the sample that accompanies this tutorial is implemented in C++/CLI, this tutorial assumes familiarity with the use of C++ to program the Windows API plus an understanding of managed code programming.</span></span> <span data-ttu-id="fd3c2-114">La familiaridad C++con/CLI es útil, pero no esencial.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-114">Familiarity with C++/CLI is helpful but not essential.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="fd3c2-115">En el tutorial se incluye una serie de ejemplos de código del ejemplo asociado.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-115">This tutorial includes a number of code examples from the associated sample.</span></span> <span data-ttu-id="fd3c2-116">Sin embargo, para una mejor lectura, no se incluye el código de ejemplo completo.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-116">However, for readability, it does not include the complete sample code.</span></span> <span data-ttu-id="fd3c2-117">Para obtener el código de ejemplo completo, vea [ejemplo de hospedaje de contenido de WPF en una ventana de Win32](https://go.microsoft.com/fwlink/?LinkID=160004).</span><span class="sxs-lookup"><span data-stu-id="fd3c2-117">For the complete sample code, see [Hosting WPF Content in a Win32 Window Sample](https://go.microsoft.com/fwlink/?LinkID=160004).</span></span>  
  
<a name="basic_procedure"></a>   
## <a name="the-basic-procedure"></a><span data-ttu-id="fd3c2-118">Procedimiento básico</span><span class="sxs-lookup"><span data-stu-id="fd3c2-118">The Basic Procedure</span></span>  
 <span data-ttu-id="fd3c2-119">En esta sección se describe el procedimiento básico que se usa para hospedar [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenido en una ventana de Win32.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-119">This section outlines the basic procedure you use to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a Win32 window.</span></span> <span data-ttu-id="fd3c2-120">Las secciones restantes explican los detalles de cada paso.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-120">The remaining sections explain the details of each step.</span></span>  
  
 <span data-ttu-id="fd3c2-121">La clave para hospedar [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenido en una ventana de Win32 es la clase <xref:System.Windows.Interop.HwndSource>.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-121">The key to hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content on a Win32 window is the <xref:System.Windows.Interop.HwndSource> class.</span></span> <span data-ttu-id="fd3c2-122">Esta clase ajusta el [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenido en una ventana de Win32, lo que permite que se incorpore en el [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] como una ventana secundaria.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-122">This class wraps the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a Win32 window, allowing it to be incorporated into your [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] as a child window.</span></span> <span data-ttu-id="fd3c2-123">El siguiente enfoque combina el Win32 y el [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] en una sola aplicación.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-123">The following approach combines the Win32 and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in a single application.</span></span>  
  
1. <span data-ttu-id="fd3c2-124">Implemente el contenido de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] como una clase administrada.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-124">Implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a managed class.</span></span>  
  
2. <span data-ttu-id="fd3c2-125">Implementar una aplicación de Windows C++con/CLI.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-125">Implement a Windows application with C++/CLI.</span></span> <span data-ttu-id="fd3c2-126">Si está empezando con una aplicación existente y C++ código no administrado, normalmente puede habilitarlo para llamar a código administrado cambiando la configuración del proyecto para incluir la marca de compilador `/clr`.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-126">If you are starting with an existing application and unmanaged C++ code, you can usually enable it to call managed code by changing your project settings to include the `/clr` compiler flag.</span></span>  
  
3. <span data-ttu-id="fd3c2-127">Establezca el modelo de subprocesos en contenedor uniproceso (STA).</span><span class="sxs-lookup"><span data-stu-id="fd3c2-127">Set the threading model to single-threaded apartment (STA).</span></span>  
  
4. <span data-ttu-id="fd3c2-128">Controle la notificación de [WM_CREATE](/windows/desktop/winmsg/wm-create)en el procedimiento de ventana y haga lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="fd3c2-128">Handle the [WM_CREATE](/windows/desktop/winmsg/wm-create)notification in your window procedure and do the following:</span></span>  
  
    1. <span data-ttu-id="fd3c2-129">Cree un nuevo objeto <xref:System.Windows.Interop.HwndSource> con la ventana primaria como su `parent` parámetro.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-129">Create a new <xref:System.Windows.Interop.HwndSource> object with the parent window as its `parent` parameter.</span></span>  
  
    2. <span data-ttu-id="fd3c2-130">Cree una instancia de su clase de contenido [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fd3c2-130">Create an instance of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class.</span></span>  
  
    3. <span data-ttu-id="fd3c2-131">Asigne una referencia al objeto de contenido [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] a la propiedad <xref:System.Windows.Interop.HwndSource.RootVisual%2A> de la <xref:System.Windows.Interop.HwndSource>.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-131">Assign a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>.</span></span>  
  
    4. <span data-ttu-id="fd3c2-132">Obtenga el HWND para el contenido.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-132">Get the HWND for the content.</span></span> <span data-ttu-id="fd3c2-133">La propiedad <xref:System.Windows.Interop.HwndSource.Handle%2A> del objeto <xref:System.Windows.Interop.HwndSource> contiene el identificador de ventana (HWND).</span><span class="sxs-lookup"><span data-stu-id="fd3c2-133">The <xref:System.Windows.Interop.HwndSource.Handle%2A> property of the <xref:System.Windows.Interop.HwndSource> object contains the window handle (HWND).</span></span> <span data-ttu-id="fd3c2-134">Para obtener un HWND que se pueda usar en la parte de la aplicación no administrada, convierta `Handle.ToPointer()` en un HWND.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-134">To get an HWND that you can use in the unmanaged part of your application, cast `Handle.ToPointer()` to an HWND.</span></span>  
  
5. <span data-ttu-id="fd3c2-135">Implemente una clase administrada que contenga un campo estático para contener una referencia al contenido [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fd3c2-135">Implement a managed class that contains a static field to hold a reference to your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="fd3c2-136">Esta clase le permite obtener una referencia al contenido de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] desde el código de Win32.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-136">This class allows you to get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from your Win32 code.</span></span>  
  
6. <span data-ttu-id="fd3c2-137">Asigne el contenido [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] al campo estático.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-137">Assign the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the static field.</span></span>  
  
7. <span data-ttu-id="fd3c2-138">Reciba notificaciones del contenido de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] adjuntando un controlador a uno o varios de los eventos de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fd3c2-138">Receive notifications from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by attaching a handler to one or more of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] events.</span></span>  
  
8. <span data-ttu-id="fd3c2-139">Comuníquese con el contenido [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] mediante la referencia que almacenó en el campo estático para establecer propiedades, etc.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-139">Communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by using the reference that you stored in the static field to set properties, and so on.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="fd3c2-140">También puede usar [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] para implementar el contenido de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fd3c2-140">You can also use [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] to implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="fd3c2-141">Sin embargo, tendrá que compilarlo por separado como una biblioteca de vínculos dinámicos (DLL) y hacer referencia a ese archivo DLL desde la aplicación Win32.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-141">However, you will have to compile it separately as a dynamic-link library (DLL) and reference that DLL from your Win32 application.</span></span> <span data-ttu-id="fd3c2-142">El resto del procedimiento es similar al descrito anteriormente.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-142">The remainder of the procedure is similar to that outlined above.</span></span>

<a name="implementing_the_application"></a>
## <a name="implementing-the-host-application"></a><span data-ttu-id="fd3c2-143">Implementación de la aplicación host</span><span class="sxs-lookup"><span data-stu-id="fd3c2-143">Implementing the Host Application</span></span>
 <span data-ttu-id="fd3c2-144">En esta sección se describe cómo hospedar [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenido en una aplicación básica de Win32.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-144">This section describes how to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a basic Win32 application.</span></span> <span data-ttu-id="fd3c2-145">El propio contenido se implementa en C++/CLI como una clase administrada.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-145">The content itself is implemented in C++/CLI as a managed class.</span></span> <span data-ttu-id="fd3c2-146">En su mayor parte, se trata de programación en [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] sencilla.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-146">For the most part, it is straightforward [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming.</span></span> <span data-ttu-id="fd3c2-147">Los aspectos clave de la implementación del contenido se tratan en [implementación del contenido de WPF](#implementing_the_wpf_page).</span><span class="sxs-lookup"><span data-stu-id="fd3c2-147">The key aspects of the content implementation are discussed in [Implementing the WPF Content](#implementing_the_wpf_page).</span></span>

- [<span data-ttu-id="fd3c2-148">Aplicación básica</span><span class="sxs-lookup"><span data-stu-id="fd3c2-148">The Basic Application</span></span>](#the_basic_application)

- [<span data-ttu-id="fd3c2-149">Hospedaje de contenido WPF</span><span class="sxs-lookup"><span data-stu-id="fd3c2-149">Hosting the WPF Content</span></span>](#hosting_the_wpf_page)

- [<span data-ttu-id="fd3c2-150">Referencia al contenido WPF</span><span class="sxs-lookup"><span data-stu-id="fd3c2-150">Holding a Reference to the WPF Content</span></span>](#holding_a_reference)

- [<span data-ttu-id="fd3c2-151">Comunicación con el contenido WPF</span><span class="sxs-lookup"><span data-stu-id="fd3c2-151">Communicating with the WPF Content</span></span>](#communicating_with_the_page)

<a name="the_basic_application"></a>
### <a name="the-basic-application"></a><span data-ttu-id="fd3c2-152">Aplicación básica</span><span class="sxs-lookup"><span data-stu-id="fd3c2-152">The Basic Application</span></span>
 <span data-ttu-id="fd3c2-153">El punto de partida para la aplicación host fue crear una plantilla de Visual Studio 2005.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-153">The starting point for the host application was to create a Visual Studio 2005 template.</span></span>

1. <span data-ttu-id="fd3c2-154">Abra Visual Studio 2005 y seleccione **nuevo proyecto** en el menú **archivo** .</span><span class="sxs-lookup"><span data-stu-id="fd3c2-154">Open Visual Studio 2005, and select **New Project** from the **File** menu.</span></span>

2. <span data-ttu-id="fd3c2-155">Seleccione **Win32** en la lista de tipos C++ de proyecto visual.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-155">Select **Win32** from the list of Visual C++ project types.</span></span> <span data-ttu-id="fd3c2-156">Si el idioma predeterminado no C++es, encontrará estos tipos de proyecto en **otros lenguajes**.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-156">If your default language is not C++, you will find these project types under **Other Languages**.</span></span>

3. <span data-ttu-id="fd3c2-157">Seleccione una plantilla de **proyecto de Win32** , asigne un nombre al proyecto y haga clic en **Aceptar** para iniciar el **Asistente para aplicaciones Win32**.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-157">Select a **Win32 Project** template, assign a name to the project and click **OK** to launch the **Win32 Application Wizard**.</span></span>

4. <span data-ttu-id="fd3c2-158">Acepte la configuración predeterminada del asistente y haga clic en **Finalizar** para iniciar el proyecto.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-158">Accept the wizard's default settings and click **Finish** to start the project.</span></span>

 <span data-ttu-id="fd3c2-159">La plantilla crea una aplicación básica de Win32, que incluye:</span><span class="sxs-lookup"><span data-stu-id="fd3c2-159">The template creates a basic Win32 application, including:</span></span>

- <span data-ttu-id="fd3c2-160">Un punto de entrada para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-160">An entry point for the application.</span></span>

- <span data-ttu-id="fd3c2-161">Una ventana con un procedimiento de ventana asociado (WndProc).</span><span class="sxs-lookup"><span data-stu-id="fd3c2-161">A window, with an associated window procedure (WndProc).</span></span>

- <span data-ttu-id="fd3c2-162">Un menú con los encabezados **archivo** y **ayuda** .</span><span class="sxs-lookup"><span data-stu-id="fd3c2-162">A menu with **File** and **Help** headings.</span></span> <span data-ttu-id="fd3c2-163">El menú **archivo** tiene un elemento **salir** que cierra la aplicación.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-163">The **File** menu has an **Exit** item that closes the application.</span></span> <span data-ttu-id="fd3c2-164">El menú **ayuda** tiene un elemento **acerca de** que inicia un cuadro de diálogo simple.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-164">The **Help** menu has an **About** item that launches a simple dialog box.</span></span>

 <span data-ttu-id="fd3c2-165">Antes de empezar a escribir código para hospedar el [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenido, debe realizar dos modificaciones en la plantilla básica.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-165">Before you start writing code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, you need to make two modifications to the basic template.</span></span>

 <span data-ttu-id="fd3c2-166">La primera consiste en compilar el proyecto como código administrado.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-166">The first is to compile the project as managed code.</span></span> <span data-ttu-id="fd3c2-167">De forma predeterminada, el proyecto se compila como código no administrado.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-167">By default, the project compiles as unmanaged code.</span></span> <span data-ttu-id="fd3c2-168">Sin embargo, dado que [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] se implementa en código administrado, el proyecto debe estar compilado consecuentemente.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-168">However, because [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is implemented in managed code, the project must be compiled accordingly.</span></span>

1. <span data-ttu-id="fd3c2-169">Haga clic con el botón secundario en el nombre del proyecto en **Explorador de soluciones** y seleccione **propiedades** en el menú contextual para abrir el cuadro de diálogo **páginas de propiedades** .</span><span class="sxs-lookup"><span data-stu-id="fd3c2-169">Right-click the project name in **Solution Explorer** and select **Properties** from the context menu to launch the **Property Pages** dialog box.</span></span>

2. <span data-ttu-id="fd3c2-170">Seleccione **propiedades de configuración** en la vista de árbol del panel izquierdo.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-170">Select **Configuration Properties** from the tree view in the left pane.</span></span>

3. <span data-ttu-id="fd3c2-171">Seleccione compatible con **Common Language Runtime** en la lista **valores predeterminados del proyecto** del panel derecho.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-171">Select **Common Language Runtime** support from the **Project Defaults** list in the right pane.</span></span>

4. <span data-ttu-id="fd3c2-172">Seleccione **compatible con Common Language Runtime (/CLR)** en el cuadro de lista desplegable.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-172">Select **Common Language Runtime Support (/clr)** from the drop-down list box.</span></span>

> [!NOTE]
> <span data-ttu-id="fd3c2-173">Esta marca de compilador permite usar código administrado en la aplicación, pero el código no administrado seguirá compilándose como antes.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-173">This compiler flag allows you to use managed code in your application, but your unmanaged code will still compile as before.</span></span>

 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="fd3c2-174">usa el modelo de subprocesos de contenedor uniproceso (STA).</span><span class="sxs-lookup"><span data-stu-id="fd3c2-174">uses the single-threaded apartment (STA) threading model.</span></span> <span data-ttu-id="fd3c2-175">Para que funcione correctamente con el código de contenido [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], debe establecer el modelo de subprocesos de la aplicación en STA aplicando un atributo al punto de entrada.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-175">In order to work properly with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content code, you must set the application's threading model to STA by applying an attribute to the entry point.</span></span>

 [!code-cpp[Win32HostingWPFPage#WinMain](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#winmain)]

<a name="hosting_the_wpf_page"></a>
### <a name="hosting-the-wpf-content"></a><span data-ttu-id="fd3c2-176">Hospedaje de contenido WPF</span><span class="sxs-lookup"><span data-stu-id="fd3c2-176">Hosting the WPF Content</span></span>
 <span data-ttu-id="fd3c2-177">El [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenido es una aplicación de entrada de dirección simple.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-177">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is a simple address entry application.</span></span> <span data-ttu-id="fd3c2-178">Consta de varios controles <xref:System.Windows.Controls.TextBox> para tomar el nombre de usuario, la dirección, etc.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-178">It consists of several <xref:System.Windows.Controls.TextBox> controls to take user name, address, and so on.</span></span> <span data-ttu-id="fd3c2-179">También hay dos controles <xref:System.Windows.Controls.Button>, **Aceptar** y **Cancelar**.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-179">There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**.</span></span> <span data-ttu-id="fd3c2-180">Cuando el usuario hace clic en **Aceptar**, el controlador de eventos del <xref:System.Windows.Controls.Primitives.ButtonBase.Click> del botón recopila los datos de los controles de <xref:System.Windows.Controls.TextBox>, los asigna a las propiedades correspondientes y genera un evento personalizado, `OnButtonClicked`.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-180">When the user clicks **OK**, the button's <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler collects the data from the <xref:System.Windows.Controls.TextBox> controls, assigns it to corresponding properties, and raises a custom event, `OnButtonClicked`.</span></span> <span data-ttu-id="fd3c2-181">Cuando el usuario hace clic en **Cancelar**, el controlador simplemente genera `OnButtonClicked`.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-181">When the user clicks **Cancel**, the handler simply raises `OnButtonClicked`.</span></span> <span data-ttu-id="fd3c2-182">El objeto de argumento de evento para `OnButtonClicked` contiene un campo booleano que indica en qué botón se hizo clic.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-182">The event argument object for `OnButtonClicked` contains a Boolean field that indicates which button was clicked.</span></span>

 <span data-ttu-id="fd3c2-183">El código para hospedar el contenido de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] se implementa en un controlador para la notificación de [WM_CREATE](/windows/desktop/winmsg/wm-create) en la ventana host.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-183">The code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in a handler for the [WM_CREATE](/windows/desktop/winmsg/wm-create) notification on the host window.</span></span>

 [!code-cpp[Win32HostingWPFPage#WMCreate](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wmcreate)]

 <span data-ttu-id="fd3c2-184">El método `GetHwnd` toma la información de tamaño y posición más el identificador de la ventana primaria y devuelve el identificador de ventana del contenido del [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] hospedado.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-184">The `GetHwnd` method takes size and position information plus the parent window handle and returns the window handle of the hosted [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span>

> [!NOTE]
> <span data-ttu-id="fd3c2-185">No se puede usar una directiva `#using` para el espacio de nombres `System::Windows::Interop`.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-185">You cannot use a `#using` directive for the `System::Windows::Interop` namespace.</span></span> <span data-ttu-id="fd3c2-186">Si lo hace, crearía un conflicto de nombres entre la estructura <xref:System.Windows.Interop.MSG> en ese espacio de nombres y la estructura MSG declarada en winuser.h.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-186">Doing so creates a name collision between the <xref:System.Windows.Interop.MSG> structure in that namespace and the MSG structure declared in winuser.h.</span></span> <span data-ttu-id="fd3c2-187">En su lugar, debe usar nombres completos para tener acceso al contenido de ese espacio de nombres.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-187">You must instead use fully-qualified names to access the contents of that namespace.</span></span>

 [!code-cpp[Win32HostingWPFPage#GetHwnd](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#gethwnd)]

 <span data-ttu-id="fd3c2-188">No se puede hospedar el contenido de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] directamente en la ventana de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-188">You cannot host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content directly in your application window.</span></span> <span data-ttu-id="fd3c2-189">En su lugar, cree un objeto <xref:System.Windows.Interop.HwndSource> para encapsular el contenido [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fd3c2-189">Instead, you first create an <xref:System.Windows.Interop.HwndSource> object to wrap the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="fd3c2-190">Este objeto es básicamente una ventana diseñada para hospedar un contenido de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fd3c2-190">This object is basically a window that is designed to host a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="fd3c2-191">Para hospedar el objeto de <xref:System.Windows.Interop.HwndSource> en la ventana primaria, debe crearlo como un elemento secundario de una ventana de Win32 que forme parte de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-191">You host the <xref:System.Windows.Interop.HwndSource> object in the parent window by creating it as a child of a Win32 window that is part of your application.</span></span> <span data-ttu-id="fd3c2-192">Los parámetros del constructor <xref:System.Windows.Interop.HwndSource> contienen prácticamente la misma información que se pasaría a CreateWindow al crear una ventana secundaria de Win32.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-192">The <xref:System.Windows.Interop.HwndSource> constructor parameters contain much the same information that you would pass to CreateWindow when you create a Win32 child window.</span></span>

 <span data-ttu-id="fd3c2-193">A continuación, cree una instancia del objeto de contenido [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fd3c2-193">You next create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object.</span></span> <span data-ttu-id="fd3c2-194">En este caso, el contenido de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] se implementa como una clase independiente, `WPFPage`, C++mediante/CLI.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-194">In this case, the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented as a separate class, `WPFPage`, using C++/CLI.</span></span> <span data-ttu-id="fd3c2-195">También puede implementar el contenido [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] con [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fd3c2-195">You could also implement the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content with [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span> <span data-ttu-id="fd3c2-196">Sin embargo, para ello deberá configurar un proyecto independiente y compilar el [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenido como un archivo DLL.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-196">However, to do so you need to set up a separate project and build the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a DLL.</span></span> <span data-ttu-id="fd3c2-197">Puede Agregar una referencia a ese archivo DLL al proyecto y usar esa referencia para crear una instancia del contenido del [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fd3c2-197">You can add a reference to that DLL to your project, and use that reference to create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span>

 <span data-ttu-id="fd3c2-198">Para mostrar el contenido de la [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] en la ventana secundaria, asigne una referencia al contenido de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] a la propiedad <xref:System.Windows.Interop.HwndSource.RootVisual%2A> del <xref:System.Windows.Interop.HwndSource>.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-198">You display the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in your child window by assigning a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>.</span></span>

 <span data-ttu-id="fd3c2-199">La siguiente línea de código adjunta un controlador de eventos, `WPFButtonClicked`, al evento [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] del contenido `OnButtonClicked`.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-199">The next line of code attaches an event handler, `WPFButtonClicked`, to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content `OnButtonClicked` event.</span></span> <span data-ttu-id="fd3c2-200">Se llama a este controlador cuando el usuario hace clic en el botón **Aceptar** o **Cancelar** .</span><span class="sxs-lookup"><span data-stu-id="fd3c2-200">This handler is called when the user clicks the **OK** or **Cancel** button.</span></span> <span data-ttu-id="fd3c2-201">Consulte [communicating_with_the_WPF contenido](#communicating_with_the_page) para obtener más información sobre este controlador de eventos.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-201">See [communicating_with_the_WPF content](#communicating_with_the_page) for further discussion of this event handler.</span></span>

 <span data-ttu-id="fd3c2-202">La línea final del código mostrado devuelve el identificador de ventana (HWND) que está asociado al objeto <xref:System.Windows.Interop.HwndSource>.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-202">The final line of code shown returns the window handle (HWND) that is associated with the <xref:System.Windows.Interop.HwndSource> object.</span></span> <span data-ttu-id="fd3c2-203">Puede usar este identificador desde el código de Win32 para enviar mensajes a la ventana hospedada, aunque el ejemplo no lo hace.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-203">You can use this handle from your Win32 code to send messages to the hosted window, although the sample does not do so.</span></span> <span data-ttu-id="fd3c2-204">El objeto <xref:System.Windows.Interop.HwndSource> genera un evento cada vez que recibe un mensaje.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-204">The <xref:System.Windows.Interop.HwndSource> object raises an event every time it receives a message.</span></span> <span data-ttu-id="fd3c2-205">Para procesar los mensajes, llame al método <xref:System.Windows.Interop.HwndSource.AddHook%2A> para adjuntar un controlador de mensajes y, a continuación, procese los mensajes en ese controlador.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-205">To process the messages, call the <xref:System.Windows.Interop.HwndSource.AddHook%2A> method to attach a message handler and then process the messages in that handler.</span></span>

<a name="holding_a_reference"></a>
### <a name="holding-a-reference-to-the-wpf-content"></a><span data-ttu-id="fd3c2-206">Referencia al contenido WPF</span><span class="sxs-lookup"><span data-stu-id="fd3c2-206">Holding a Reference to the WPF Content</span></span>
 <span data-ttu-id="fd3c2-207">En muchas aplicaciones, deseará comunicarse con el contenido [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] más adelante.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-207">For many applications, you will want to communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content later.</span></span> <span data-ttu-id="fd3c2-208">Por ejemplo, quizá desee modificar las propiedades del contenido [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], o quizás quiera que el objeto <xref:System.Windows.Interop.HwndSource> hospede contenido [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] diferente.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-208">For example, you might want to modify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, or perhaps have the <xref:System.Windows.Interop.HwndSource> object host different [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="fd3c2-209">Para ello, necesita una referencia al objeto <xref:System.Windows.Interop.HwndSource> o al contenido [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fd3c2-209">To do this, you need a reference to the <xref:System.Windows.Interop.HwndSource> object or the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="fd3c2-210">El objeto <xref:System.Windows.Interop.HwndSource> y su contenido [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] asociado permanecen en memoria hasta que se destruya el identificador de ventana.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-210">The <xref:System.Windows.Interop.HwndSource> object and its associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content remain in memory until you destroy the window handle.</span></span> <span data-ttu-id="fd3c2-211">Sin embargo, la variable que asigne al objeto <xref:System.Windows.Interop.HwndSource> saldrá del ámbito tan pronto se devuelva un resultado desde el procedimiento de ventana.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-211">However, the variable you assign to the <xref:System.Windows.Interop.HwndSource> object will go out of scope as soon as you return from the window procedure.</span></span> <span data-ttu-id="fd3c2-212">La forma más personalizada de tratar este problema con aplicaciones Win32 es usar una variable global o estática.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-212">The customary way to handle this issue with Win32 applications is to use a static or global variable.</span></span> <span data-ttu-id="fd3c2-213">Por desgracia, no es posible asignar un objeto administrado a esos tipos de variables.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-213">Unfortunately, you cannot assign a managed object to those types of variables.</span></span> <span data-ttu-id="fd3c2-214">Puede asignar el identificador de ventana asociado al objeto <xref:System.Windows.Interop.HwndSource> a una variable global o estática, pero eso no proporciona acceso al objeto mismo.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-214">You can assign the window handle associated with <xref:System.Windows.Interop.HwndSource> object to a global or static variable, but that doe not provide access to the object itself.</span></span>

 <span data-ttu-id="fd3c2-215">La solución más sencilla para este problema es implementar una clase administrada con un conjunto de campos estáticos que contengan referencias a los objetos administrados a los que es necesario tener acceso.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-215">The simplest solution to this issue is to implement a managed class that contains a set of static fields to hold references to any managed objects that you need access to.</span></span> <span data-ttu-id="fd3c2-216">En el ejemplo se usa la clase `WPFPageHost` para incluir una referencia al contenido [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], además de los valores iniciales de una serie de sus propiedades que el usuario puede cambiar posteriormente.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-216">The sample uses the `WPFPageHost` class to hold a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, plus the initial values of a number of its properties that might be changed later by the user.</span></span> <span data-ttu-id="fd3c2-217">Esto se define en el encabezado.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-217">This is defined in the header.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageHost](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.h#wpfpagehost)]

 <span data-ttu-id="fd3c2-218">La última parte de la función `GetHwnd` asigna valores a esos campos para su uso posterior mientras `myPage` está todavía en el ámbito.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-218">The latter part of the `GetHwnd` function assigns values to those fields for later use while `myPage` is still in scope.</span></span>

<a name="communicating_with_the_page"></a>
### <a name="communicating-with-the-wpf-content"></a><span data-ttu-id="fd3c2-219">Comunicación con el contenido WPF</span><span class="sxs-lookup"><span data-stu-id="fd3c2-219">Communicating with the WPF Content</span></span>
 <span data-ttu-id="fd3c2-220">Hay dos tipos de comunicación con el contenido [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fd3c2-220">There are two types of communication with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="fd3c2-221">La aplicación recibe información del contenido de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] cuando el usuario hace clic en los botones **Aceptar** o **Cancelar** .</span><span class="sxs-lookup"><span data-stu-id="fd3c2-221">The application receives information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content when the user clicks the **OK** or **Cancel** buttons.</span></span> <span data-ttu-id="fd3c2-222">La aplicación también tiene una [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] que permite al usuario cambiar diversas propiedades del contenido [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], como el tamaño de fuente predeterminado o el color de fondo.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-222">The application also has a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that allows the user to change various [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, such as the background color or default font size.</span></span>

 <span data-ttu-id="fd3c2-223">Como se mencionó anteriormente, cuando el usuario hace clic en cualquiera de los botones, el contenido [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] genera un evento `OnButtonClicked`.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-223">As mentioned above, when the user clicks either button the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content raises an `OnButtonClicked` event.</span></span> <span data-ttu-id="fd3c2-224">La aplicación adjunta un controlador a este evento para recibir estas notificaciones.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-224">The application attaches a handler to this event to receive these notifications.</span></span> <span data-ttu-id="fd3c2-225">Si se hizo clic en el botón **Aceptar** , el controlador obtiene la información de usuario del [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenido y la muestra en un conjunto de controles estáticos.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-225">If the **OK** button was clicked, the handler gets the user information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content and displays it in a set of static controls.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFButtonClicked](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wpfbuttonclicked)]

 <span data-ttu-id="fd3c2-226">El controlador recibe un objeto de argumento de evento personalizado del contenido [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], `MyPageEventArgs`.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-226">The handler receives a custom event argument object from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, `MyPageEventArgs`.</span></span> <span data-ttu-id="fd3c2-227">La propiedad `IsOK` del objeto se establece en `true` si se hizo clic en el botón **Aceptar** y `false` si se hizo clic en el botón **Cancelar** .</span><span class="sxs-lookup"><span data-stu-id="fd3c2-227">The object's `IsOK` property is set to `true` if the **OK** button was clicked, and `false` if the **Cancel** button was clicked.</span></span>

 <span data-ttu-id="fd3c2-228">Si se hizo clic en el botón **Aceptar** , el controlador obtiene una referencia al contenido de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] de la clase contenedora.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-228">If the **OK** button was clicked, the handler gets a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from the container class.</span></span> <span data-ttu-id="fd3c2-229">A continuación, recopila la información del usuario incluida en las propiedades de contenido [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] asociado y usa los controles estáticos para mostrar la información en la ventana primaria.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-229">It then collects the user information that is held by the associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties and uses the static controls to display the information on the parent window.</span></span> <span data-ttu-id="fd3c2-230">Dado que los datos de contenido [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] tienen el formato de una cadena administrada, se deben calcular las referencias para que los use un control Win32.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-230">Because the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content data is in the form of a managed string, it has to be marshaled for use by a Win32 control.</span></span> <span data-ttu-id="fd3c2-231">Si se hizo clic en el botón **Cancelar** , el controlador borra los datos de los controles estáticos.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-231">If the **Cancel** button was clicked, the handler clears the data from the static controls.</span></span>

 <span data-ttu-id="fd3c2-232">La [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] de la aplicación proporciona un conjunto de botones de radio que permiten al usuario modificar el color de fondo del contenido [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] y varias propiedades relacionadas con la fuente.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-232">The application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] provides a set of radio buttons that allow the user to modify the background color of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and several font-related properties.</span></span> <span data-ttu-id="fd3c2-233">El ejemplo siguiente es un extracto del procedimiento de ventana de la aplicación (WndProc) y su control de mensajes que establece varias propiedades en diferentes mensajes, incluido el color de fondo.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-233">The following example is an excerpt from the application's window procedure (WndProc) and its message handling that sets various properties on different messages, including the background color.</span></span> <span data-ttu-id="fd3c2-234">Los demás son similares y no se muestran.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-234">The others are similar, and are not shown.</span></span> <span data-ttu-id="fd3c2-235">Vea el ejemplo completo para obtener detalles y el contexto.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-235">See the complete sample for details and context.</span></span>

 [!code-cpp[Win32HostingWPFPage#WMCommandToBG](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wmcommandtobg)]

 <span data-ttu-id="fd3c2-236">Para establecer el color de fondo, obtenga una referencia al contenido [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] (`hostedPage`) de `WPFPageHost` y establezca la propiedad de color de fondo en el color apropiado.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-236">To set the background color, get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content (`hostedPage`) from `WPFPageHost` and set the background color property to the appropriate color.</span></span> <span data-ttu-id="fd3c2-237">En el ejemplo se usan tres opciones de color: el color original, verde claro y salmón claro.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-237">The sample uses three color options: the original color, light green, or light salmon.</span></span> <span data-ttu-id="fd3c2-238">El color de fondo original se almacena como un campo estático en la clase `WPFPageHost`.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-238">The original background color is stored as a static field in the `WPFPageHost` class.</span></span> <span data-ttu-id="fd3c2-239">Para establecer los otros dos, se crea un nuevo objeto <xref:System.Windows.Media.SolidColorBrush> y se pasa al constructor un valor de colores estático desde el objeto <xref:System.Windows.Media.Colors>.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-239">To set the other two, you create a new <xref:System.Windows.Media.SolidColorBrush> object and pass the constructor a static colors value from the <xref:System.Windows.Media.Colors> object.</span></span>

<a name="implementing_the_wpf_page"></a>
## <a name="implementing-the-wpf-page"></a><span data-ttu-id="fd3c2-240">Implementación de la página WPF</span><span class="sxs-lookup"><span data-stu-id="fd3c2-240">Implementing the WPF Page</span></span>
 <span data-ttu-id="fd3c2-241">Puede hospedar y usar el contenido de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] sin ningún conocimiento de la implementación real.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-241">You can host and use the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content without any knowledge of the actual implementation.</span></span> <span data-ttu-id="fd3c2-242">Si el contenido de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] se hubiera empaquetado en un archivo DLL independiente, podría haberse compilado en cualquier lenguaje de Common Language Runtime (CLR).</span><span class="sxs-lookup"><span data-stu-id="fd3c2-242">If the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content had been packaged in a separate DLL, it could have been built in any common language runtime (CLR) language.</span></span> <span data-ttu-id="fd3c2-243">A continuación se muestra un breve tutorial C++de la implementación de/CLI que se usa en el ejemplo.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-243">Following is a brief walkthrough of the C++/CLI implementation that is used in the sample.</span></span> <span data-ttu-id="fd3c2-244">Esta sección contiene las subsecciones siguientes.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-244">This section contains the following subsections.</span></span>

- [<span data-ttu-id="fd3c2-245">Diseño</span><span class="sxs-lookup"><span data-stu-id="fd3c2-245">Layout</span></span>](#page_layout)

- [<span data-ttu-id="fd3c2-246">Devolución de datos a la ventana host</span><span class="sxs-lookup"><span data-stu-id="fd3c2-246">Returning the Data to the Host Window</span></span>](#returning_data_to_window)

- [<span data-ttu-id="fd3c2-247">Establecimiento de propiedades WPF</span><span class="sxs-lookup"><span data-stu-id="fd3c2-247">Setting the WPF Properties</span></span>](#set_page_properties)

<a name="page_layout"></a>
### <a name="layout"></a><span data-ttu-id="fd3c2-248">Diseño</span><span class="sxs-lookup"><span data-stu-id="fd3c2-248">Layout</span></span>
 <span data-ttu-id="fd3c2-249">Los elementos [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] del contenido del [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] constan de cinco controles de <xref:System.Windows.Controls.TextBox>, con controles de <xref:System.Windows.Controls.Label> asociados: nombre, dirección, ciudad, estado y código postal.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-249">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content consist of five <xref:System.Windows.Controls.TextBox> controls, with associated <xref:System.Windows.Controls.Label> controls: Name, Address, City, State, and Zip.</span></span> <span data-ttu-id="fd3c2-250">También hay dos controles <xref:System.Windows.Controls.Button>, **Aceptar** y **Cancelar** .</span><span class="sxs-lookup"><span data-stu-id="fd3c2-250">There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**</span></span>

 <span data-ttu-id="fd3c2-251">El contenido [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] se implementa en la clase `WPFPage`.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-251">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in the `WPFPage` class.</span></span> <span data-ttu-id="fd3c2-252">El diseño se controla con un elemento de diseño <xref:System.Windows.Controls.Grid>.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-252">Layout is handled with a <xref:System.Windows.Controls.Grid> layout element.</span></span> <span data-ttu-id="fd3c2-253">La clase hereda de <xref:System.Windows.Controls.Grid>, lo que lo convierte en el elemento raíz del contenido [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fd3c2-253">The class inherits from <xref:System.Windows.Controls.Grid>, which effectively makes it the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content root element.</span></span>

 <span data-ttu-id="fd3c2-254">El constructor de contenido [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] toma el ancho y el alto necesarios y ajusta el tamaño del <xref:System.Windows.Controls.Grid> en consecuencia.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-254">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content constructor takes the required width and height, and sizes the <xref:System.Windows.Controls.Grid> accordingly.</span></span> <span data-ttu-id="fd3c2-255">A continuación, define el diseño básico mediante la creación de un conjunto de objetos <xref:System.Windows.Controls.ColumnDefinition> y <xref:System.Windows.Controls.RowDefinition> y su adición a las colecciones base <xref:System.Windows.Controls.Grid> objeto <xref:System.Windows.Controls.Grid.ColumnDefinitions%2A> y <xref:System.Windows.Controls.Grid.RowDefinitions%2A>, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-255">It then defines the basic layout by creating a set of <xref:System.Windows.Controls.ColumnDefinition> and <xref:System.Windows.Controls.RowDefinition> objects and adding them to the <xref:System.Windows.Controls.Grid> object base <xref:System.Windows.Controls.Grid.ColumnDefinitions%2A> and <xref:System.Windows.Controls.Grid.RowDefinitions%2A> collections, respectively.</span></span> <span data-ttu-id="fd3c2-256">Esto define una cuadrícula de cinco filas y siete columnas, con las dimensiones determinadas por el contenido de las celdas.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-256">This defines a grid of five rows and seven columns, with the dimensions determined by the contents of the cells.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCtorToGridDef](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectortogriddef)]

 <span data-ttu-id="fd3c2-257">A continuación, el constructor agrega los elementos [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] a <xref:System.Windows.Controls.Grid>.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-257">Next, the constructor adds the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements to the <xref:System.Windows.Controls.Grid>.</span></span> <span data-ttu-id="fd3c2-258">El primer elemento es el texto del título, que es un control <xref:System.Windows.Controls.Label> que se centra en la primera fila de la cuadrícula.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-258">The first element is the title text, which is a <xref:System.Windows.Controls.Label> control that is centered in the first row of the grid.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCtorTitle](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectortitle)]

 <span data-ttu-id="fd3c2-259">La siguiente fila contiene el control <xref:System.Windows.Controls.Label> de nombre y su control <xref:System.Windows.Controls.TextBox> asociado.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-259">The next row contains the Name <xref:System.Windows.Controls.Label> control and its associated <xref:System.Windows.Controls.TextBox> control.</span></span> <span data-ttu-id="fd3c2-260">Dado que se usa el mismo código para cada par de etiqueta/cuadro de texto, está colocado en un par de métodos privados y se usa para los cinco pares de etiqueta/cuadro de texto.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-260">Because the same code is used for each label/textbox pair, it is placed in a pair of private methods and used for all five label/textbox pairs.</span></span> <span data-ttu-id="fd3c2-261">Los métodos crean el control apropiado y llaman a los métodos estáticos <xref:System.Windows.Controls.Grid> y <xref:System.Windows.Controls.Grid.SetColumn%2A> de la clase <xref:System.Windows.Controls.Grid.SetRow%2A> para colocar los controles en la celda correspondiente.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-261">The methods create the appropriate control, and call the <xref:System.Windows.Controls.Grid> class static <xref:System.Windows.Controls.Grid.SetColumn%2A> and <xref:System.Windows.Controls.Grid.SetRow%2A> methods to place the controls in the appropriate cell.</span></span> <span data-ttu-id="fd3c2-262">Una vez creado el control, el ejemplo llama al método <xref:System.Windows.Controls.UIElementCollection.Add%2A> en la propiedad <xref:System.Windows.Controls.Panel.Children%2A> de <xref:System.Windows.Controls.Grid> para agregar el control a la cuadrícula.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-262">After the control is created, the sample calls the <xref:System.Windows.Controls.UIElementCollection.Add%2A> method on the <xref:System.Windows.Controls.Panel.Children%2A> property of the <xref:System.Windows.Controls.Grid> to add the control to the grid.</span></span> <span data-ttu-id="fd3c2-263">El código para agregar los pares restantes de etiqueta/cuadro de texto es similar.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-263">The code to add the remaining label/textbox pairs is similar.</span></span> <span data-ttu-id="fd3c2-264">Vea el código de ejemplo para obtener más detalles.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-264">See the sample code for details.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCtorName](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectorname)]

 <span data-ttu-id="fd3c2-265">La implementación de los dos métodos es la siguiente:</span><span class="sxs-lookup"><span data-stu-id="fd3c2-265">The implementation of the two methods is as follows:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCreateHelpers](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagecreatehelpers)]

 <span data-ttu-id="fd3c2-266">Por último, el ejemplo agrega los botones **Aceptar** y **Cancelar** y asocia un controlador de eventos a sus <xref:System.Windows.Controls.Primitives.ButtonBase.Click> eventos.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-266">Finally, the sample adds the **OK** and **Cancel** buttons and attaches an event handler to their <xref:System.Windows.Controls.Primitives.ButtonBase.Click> events.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCtorButtonsEvents](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectorbuttonsevents)]

<a name="returning_data_to_window"></a>
### <a name="returning-the-data-to-the-host-window"></a><span data-ttu-id="fd3c2-267">Devolución de datos a la ventana host</span><span class="sxs-lookup"><span data-stu-id="fd3c2-267">Returning the Data to the Host Window</span></span>
 <span data-ttu-id="fd3c2-268">Cuando se hace clic en cualquiera de los botones, se genera su evento <xref:System.Windows.Controls.Primitives.ButtonBase.Click>.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-268">When either button is clicked, its <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event is raised.</span></span> <span data-ttu-id="fd3c2-269">La ventana host simplemente podría asociar controladores a estos eventos y obtener los datos directamente desde los controles <xref:System.Windows.Controls.TextBox>.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-269">The host window could simply attach handlers to these events and get the data directly from the <xref:System.Windows.Controls.TextBox> controls.</span></span> <span data-ttu-id="fd3c2-270">En el ejemplo se usa un enfoque algo menos directo.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-270">The sample uses a somewhat less direct approach.</span></span> <span data-ttu-id="fd3c2-271">Controla el <xref:System.Windows.Controls.Primitives.ButtonBase.Click> dentro del contenido del [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] y, a continuación, genera un `OnButtonClicked`de eventos personalizado, para notificar el contenido del [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fd3c2-271">It handles the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> within the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and then raises a custom event `OnButtonClicked`, to notify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="fd3c2-272">Esto permite que el contenido de la [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] realice alguna validación de parámetros antes de notificar al host.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-272">This allows the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to do some parameter validation before notifying the host.</span></span> <span data-ttu-id="fd3c2-273">El controlador obtiene el texto de los controles <xref:System.Windows.Controls.TextBox> y lo asigna a propiedades públicas, desde las que el host puede recuperar la información.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-273">The handler gets the text from the <xref:System.Windows.Controls.TextBox> controls and assigns it to public properties, from which the host can retrieve the information.</span></span>

 <span data-ttu-id="fd3c2-274">La declaración de evento, en WPFPage.h:</span><span class="sxs-lookup"><span data-stu-id="fd3c2-274">The event declaration, in WPFPage.h:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageEventDecl](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.h#wpfpageeventdecl)]

 <span data-ttu-id="fd3c2-275">El controlador de eventos <xref:System.Windows.Controls.Primitives.ButtonBase.Click>, en WPFPage.cpp:</span><span class="sxs-lookup"><span data-stu-id="fd3c2-275">The <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler, in WPFPage.cpp:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageButtonClicked](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagebuttonclicked)]

<a name="set_page_properties"></a>
### <a name="setting-the-wpf-properties"></a><span data-ttu-id="fd3c2-276">Establecimiento de propiedades WPF</span><span class="sxs-lookup"><span data-stu-id="fd3c2-276">Setting the WPF Properties</span></span>
 <span data-ttu-id="fd3c2-277">El host de Win32 permite al usuario cambiar varias propiedades de contenido [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fd3c2-277">The Win32 host allows the user to change several [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties.</span></span> <span data-ttu-id="fd3c2-278">Desde el lado de Win32, es simplemente cuestión de cambiar las propiedades.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-278">From the Win32 side, it is simply a matter of changing the properties.</span></span> <span data-ttu-id="fd3c2-279">La implementación en la clase de contenido [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] es un poco más complicada, porque no hay ninguna propiedad global única que controle las fuentes de todos los controles.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-279">The implementation in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class is somewhat more complicated, because there is no single global property that controls the fonts for all controls.</span></span> <span data-ttu-id="fd3c2-280">En su lugar, se cambia la propiedad adecuada para cada control en los descriptores del conjunto de propiedades.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-280">Instead, the appropriate property for each control is changed in the properties' set accessors.</span></span> <span data-ttu-id="fd3c2-281">En el ejemplo siguiente se muestra el código de la propiedad `DefaultFontFamily`.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-281">The following example shows the code for the `DefaultFontFamily` property.</span></span> <span data-ttu-id="fd3c2-282">Al establecer la propiedad, se llama a un método privado que a su vez establece las propiedades <xref:System.Windows.Controls.Control.FontFamily%2A> de los diversos controles.</span><span class="sxs-lookup"><span data-stu-id="fd3c2-282">Setting the property calls a private method that in turn sets the <xref:System.Windows.Controls.Control.FontFamily%2A> properties for the various controls.</span></span>

 <span data-ttu-id="fd3c2-283">Desde WPFPage.h:</span><span class="sxs-lookup"><span data-stu-id="fd3c2-283">From WPFPage.h:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageFontFamilyProperty](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.h#wpfpagefontfamilyproperty)]

 <span data-ttu-id="fd3c2-284">Desde WPFPage.cpp:</span><span class="sxs-lookup"><span data-stu-id="fd3c2-284">From WPFPage.cpp:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageSetFontFamily](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagesetfontfamily)]

## <a name="see-also"></a><span data-ttu-id="fd3c2-285">Consulte también</span><span class="sxs-lookup"><span data-stu-id="fd3c2-285">See also</span></span>

- <xref:System.Windows.Interop.HwndSource>
- [<span data-ttu-id="fd3c2-286">Interoperabilidad de WPF y Win32</span><span class="sxs-lookup"><span data-stu-id="fd3c2-286">WPF and Win32 Interoperation</span></span>](wpf-and-win32-interoperation.md)
